<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan Office Client Support Blog</title>
  
  <subtitle>日本マイクロソフト Office Client サポート チームのブログです</subtitle>
  <link href="/blog/atom.xml" rel="self"/>
  
  <link href="https://officesupportjp.github.io/blog/"/>
  <updated>2021-08-05T07:54:21.367Z</updated>
  <id>https://officesupportjp.github.io/blog/</id>
  
  <author>
    <name>Office Support Japan</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Teams、SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象のトラブルシューティングについて</title>
    <link href="https://officesupportjp.github.io/blog/Teams%E3%80%81SPO%E3%80%81OneDrive%E3%80%81WebDav%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%8B%E3%82%89%20Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C%E9%96%8B%E3%81%8B%E3%81%AA%E3%81%84%E3%80%81%E4%BF%9D%E5%AD%98%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E7%8F%BE%E8%B1%A1%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/Teams%E3%80%81SPO%E3%80%81OneDrive%E3%80%81WebDav%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%8B%E3%82%89%20Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C%E9%96%8B%E3%81%8B%E3%81%AA%E3%81%84%E3%80%81%E4%BF%9D%E5%AD%98%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E7%8F%BE%E8%B1%A1%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2021-06-20T15:00:00.000Z</published>
    <updated>2021-08-05T07:54:21.367Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。  </p><p>今回の投稿では、Teams、SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象のトラブルシューティングについて説明します。</p><p>以下、問題の切り分けに有用な情報を以下にご案内いたします。</p><p>これらの手順を上から順にご実施ください。</p><p><strong>&lt;実施方法&gt;</strong></p><p>1) Office への再サインイン</p><p>-——————————-</p><p>1. Office からサインアウトし、Office を全て終了します。</p><p>2. OS のスタートメニュー - 歯車 - “アカウント” - “職場または学校にアクセスする” をクリックし、”職場または学校アカウント” として表示されている項目がある場合、”切断” をクリックします</p><p>※ Azure AD や AD に接続済みの項目を “切断” しますと、ドメインから外れてしまいますので、Azure AD や AD に接続済み の項目は切断しないようにご注意ください。</p><p>3. OS からログオフします。(可能であれば、再起動してください)</p><p>4. Office を起動してサインインし、事象が解消するかをお試しください。</p><p>　<br>2) Office アップロードセンターのキャッシュクリア</p><p>-————————————————–</p><p>1. Office を全て終了します。</p><p>2. [スタート]-[すべてのプログラム]-[Microsoft Officeツール]-[Office アップロードセンター] をクリックし、[設定] を押下後、[キャッシュ ファイルの削除] を実施してください。</p><p>3. [ファイルを閉じたときに Office ドキュメント キャッシュから削除する] オプションでチェックを入れ有効に設定します。</p><p>4. [OK] ボタンをクリックし、Microsoft Office アップロード センターの設定 ダイアログを閉じます。  </p><p>上記の手順でアップロードセンターが見つからない場合、以下の手順をご実施ください。</p><p>1. Excel 等を開きます。</p><p>2. [ファイル] タブ - “オプション” を開きます。</p><p>3. “保存” より、”キャッシュ” の設定 - [ファイルを閉じたときに Office ドキュメント キャッシュから削除する] オプションでチェックを入れ有効に設定し、[キャッシュ ファイルの削除] を実施します。</p><p>　<br>3) Office アップロードセンターの完全キャッシュクリア</p><p>-————————————————–</p><p>1. Ctrl + Shift + Esc キーを押してタスク マネージャーを起動します。</p><p>2. [プロセス] タブで [MSOSYNC.EXE] が存在する場合、クリックし、[プロセスの終了] をクリックしてから、タスク マネージャーを終了します。</p><p>3. %userprofile%\AppData\Local\Microsoft\Office\16.0\ に移動します。</p><p>※ Office 2013 の場合は 15.0 となります。</p><p>4. OfficeFileCache フォルダー配下のファイルを削除できるもののみ、削除して下さい。</p><p>5. スタートメニューを右クリックして [ファイル名を指定して実行] から regedit と入力し、レジストリ エディタを起動します。</p><p>6. 以下のキーを展開します。</p><p>HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Common\Internet\Server Cache</p><p>7. Server Cache キーを選択し、削除します。</p><p>8. OS を再起動します。  </p><p>　<br>4) Office のサインインキャッシュのクリア</p><p>-————————————————–</p><p>以下の記事の手順により、サインインキャッシュのクリアをご実施ください。</p><p>Title : Office のサインインのトラブルシュートについて</p><p>URL : <a href="https://social.msdn.microsoft.com/Forums/ja-JP/528e54cc-6e92-420d-b7ce-0e5a65fb6d3f/office?forum=officesupportteamja" target="_blank" rel="noopener">https://social.msdn.microsoft.com/Forums/ja-JP/528e54cc-6e92-420d-b7ce-0e5a65fb6d3f/office?forum=officesupportteamja</a></p><p><strong>- 関連情報</strong></p><p>Title : MSI 版の Office 2016 で SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象について</p><p>URL : <a href="https://social.msdn.microsoft.com/Forums/ja-JP/cb8cb890-b30a-467b-a4fa-d7f7159dd373/msi-2925612398-office-2016-12391?forum=officesupportteamja" target="_blank" rel="noopener">https://social.msdn.microsoft.com/Forums/ja-JP/cb8cb890-b30a-467b-a4fa-d7f7159dd373/msi-2925612398-office-2016-12391?forum=officesupportteamja</a></p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。  &lt;/p&gt;
&lt;p&gt;今回の投稿では、Teams、SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象のトラブルシューティングについて説明します。&lt;/p&gt;
&lt;p&gt;以下、問
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Office 製品のサインインで先進認証が有効化、無効化されているかを確認する方法について</title>
    <link href="https://officesupportjp.github.io/blog/Office%20%E8%A3%BD%E5%93%81%E3%81%AE%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%81%A7%E5%85%88%E9%80%B2%E8%AA%8D%E8%A8%BC%E3%81%8C%E6%9C%89%E5%8A%B9%E5%8C%96%E3%80%81%E7%84%A1%E5%8A%B9%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E3%81%8B%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/Office%20%E8%A3%BD%E5%93%81%E3%81%AE%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%81%A7%E5%85%88%E9%80%B2%E8%AA%8D%E8%A8%BC%E3%81%8C%E6%9C%89%E5%8A%B9%E5%8C%96%E3%80%81%E7%84%A1%E5%8A%B9%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E3%81%8B%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2021-06-16T15:00:00.000Z</published>
    <updated>2021-08-05T08:17:04.919Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。  </p><p>Office 製品のサインインで先進認証が有効化、無効化されているかを確認したいとお問い合わせいただくことがございます。</p><p>本投稿では、先進認証の有効化、無効化を確認する方法についてご案内いたします。</p><p><strong>【確認方法について】</strong></p><p>Office のサインイン画面を表示することで確認することが可能です。</p><p><strong>- 先進認証が有効の場合 (以下の何れかが表示されます)</strong></p><p><strong><img src="image1.png" alt="">)<img src="image2.png" alt=""></strong></p><p><strong>- 先進認証が無効の場合</strong></p><p><img src="image3.png" alt=""></p><p><strong>【先進認証を有効化、無効化する方法について】</strong></p><p><strong>- Office 2013 製品の場合</strong></p><p>Office 2013 製品では、既定で先進認証が無効です。</p><p>以下のレジストリキーを設定することで、先進認証を有効にしていただけます。</p><p>キー: HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\15.0\Common\Identity<br>名前: EnableADAL<br>種類: REG_DWORD<br>データ: 1</p><p>名前: Version<br>種類: REG_DWORD<br>データ: 1</p><p>※ Office 2013 では、Microsoft Update により更新プログラムを最新に適用していただかないと、上記のレジストリを設定しても先進認証が有効にならない場合がございます。</p><p>※ 本レジストリキーは HKEY_CURRENT_USER 配下のため、レジストリエディターで値を編集される場合、別の管理者ユーザーなどでレジストリエディターを起動しないでください。</p><p><strong>- Office 2016、2019、Microsoft 365 Apps (Office 365 ProPlus) 製品の場合</strong></p><p>Office 2016 以降となるこれらの製品では、既定で先進認証が有効です。</p><p>Microsoft 365 Apps 製品では将来的に廃止される可能性はございますが、以下のレジストリの設定により、先進認証を無効化していただけます。</p><p>キー: HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\16.0\Common\Identity<br>名前: EnableADAL<br>種類: REG_DWORD<br>データ: 0</p><p>※ 本レジストリキーは HKEY_CURRENT_USER 配下のため、レジストリエディターで値を編集される場合、別の管理者ユーザーなどでレジストリエディターを起動しないでください。</p><p><strong>【参考資料】</strong></p><p>EnableADAL の説明や各製品の詳細につきましては、以下の資料をご参考にいただきますようお願いいたします。</p><p>Title : 2013、Office 2016、および 2019 Office 2019 クライアント アプリOfficeのしくみ</p><p>URL : <a href="https://docs.microsoft.com/ja-jp/microsoft-365/enterprise/modern-auth-for-office-2013-and-2016?view=o365-worldwide" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/microsoft-365/enterprise/modern-auth-for-office-2013-and-2016?view=o365-worldwide</a></p><p>Title : Windows デバイスの Office 2013 の先進認証を有効にする<a href="https://docs.microsoft.com/ja-jp/microsoft-365/enterprise/modern-auth-for-office-2013-and-2016?view=o365-worldwide" target="_blank" rel="noopener"></a>URL : <a href="https://docs.microsoft.com/ja-jp/microsoft-365/admin/security-and-compliance/enable-modern-authentication?view=o365-worldwide" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/microsoft-365/admin/security-and-compliance/enable-modern-authentication?view=o365-worldwide</a></p><p><strong>- 関連記事</strong>  </p><p>Title : Office のサインインでネットワーク接続がない旨のメッセージが表示される事象について<br>URL : <a href="https://social.msdn.microsoft.com/Forums/ja-JP/40ba1467-0b54-48d5-9db0-4d3aedca2b0a/office?forum=officesupportteamja" target="_blank" rel="noopener">https://social.msdn.microsoft.com/Forums/ja-JP/40ba1467-0b54-48d5-9db0-4d3aedca2b0a/office?forum=officesupportteamja</a></p><p>今回の投稿は以上です。</p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。  &lt;/p&gt;
&lt;p&gt;Office 製品のサインインで先進認証が有効化、無効化されているかを確認したいとお問い合わせいただくことがございます。&lt;/p&gt;
&lt;p&gt;本投稿では、先進認証の有効化、無効化を確認する方法についてご案
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>MSI 版の Office 2016 で SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象について</title>
    <link href="https://officesupportjp.github.io/blog/MSI%20%E7%89%88%E3%81%AE%20Office%202016%20%E3%81%A7%20SPO%E3%80%81OneDrive%E3%80%81WebDav%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%8B%E3%82%89%20Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C%E9%96%8B%E3%81%8B%E3%81%AA%E3%81%84%E3%80%81%E4%BF%9D%E5%AD%98%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E7%8F%BE%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/MSI%20%E7%89%88%E3%81%AE%20Office%202016%20%E3%81%A7%20SPO%E3%80%81OneDrive%E3%80%81WebDav%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%8B%E3%82%89%20Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C%E9%96%8B%E3%81%8B%E3%81%AA%E3%81%84%E3%80%81%E4%BF%9D%E5%AD%98%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E7%8F%BE%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2021-04-22T15:00:00.000Z</published>
    <updated>2021-08-08T01:43:06.382Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。</p><p>今回の投稿では、MSI 版の Office 2016 で SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象について説明します。</p><p><a href="https://social.msdn.microsoft.com/Forums/ja-JP/57e5d81e-ef69-4c1f-9ef0-932d03d0e7ce/1246312452124831246323455348922441824335-c2r-12392-windows?forum=officesupportteamja" target="_blank" rel="noopener" title="クイック実行形式 (C2R) と Windows インストーラー形式 (MSI) を見分ける方法">MSI 版の Office 2016 とは？</a></p><p>以下の Blog 記事のとおり、「SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない」現象についてお問い合わせいただく場合があります。</p><p>Title : SharePoint Server など WebDAV が有効なサーバーから Office ファイルが開かない、保存できない現象について<br>URL : <a href="https://social.msdn.microsoft.com/Forums/ja-JP/ea318b53-5f30-4a35-b21c-64ac83be977e/sharepoint-server-1239412393-webdav?forum=officesupportteamja" target="_blank" rel="noopener">https://social.msdn.microsoft.com/Forums/ja-JP/ea318b53-5f30-4a35-b21c-64ac83be977e/sharepoint-server-1239412393-webdav?forum=officesupportteamja</a>  </p><p>上記の Blog 記事の方法では改善せず、ご利用されているのが MSI 版の Office 2016 の場合、セキュリティ更新のみ等、限定的に更新プログラムを適用していることに起因している可能性があります。</p><p>この場合、Microsoft Update を適用するか、少なくとも、以下のモジュールの更新プログラムを適用し、事象が回避するかをご確認いただくと解消する可能性があります。</p><p><strong>&lt;実施方法&gt;</strong></p><p>URL を開き、以下に列挙するモジュールの “Non-security” と “Security release” の日付を比較し、新しい方の KB の更新プログラムを適用してください。</p><p>なお、”Security KB superseded” は “置き換えられたセキュリティ更新の KB” を意味いたしますので、適用する必要はありません。</p><p>Title : List of the most current .msp files for Office 2016 products<br>URL : <a href="https://docs.microsoft.com/en-us/officeupdates/msp-files-office-2016" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/officeupdates/msp-files-office-2016</a></p><p>・ace-x-none<br>・csi-x-none<br>・mso-x-none<br>・msodll20-x-none<br>・msodll30-x-none<br>・msodll40ui-x-none<br>・msodll99l-x-none<br>・orgidcrl-x-none<br>・msmipc-x-none</p><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。&lt;/p&gt;
&lt;p&gt;今回の投稿では、MSI 版の Office 2016 で SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象について説明します。&lt;/p&gt;
&lt;p&gt;&lt;a 
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>「このコンピューターに組織内の別のアカウントが既にサインインしています」と表示される</title>
    <link href="https://officesupportjp.github.io/blog/%E3%80%8C%E3%81%93%E3%81%AE%E3%82%B3%E3%83%B3%E3%83%94%E3%83%A5%E3%83%BC%E3%82%BF%E3%83%BC%E3%81%AB%E7%B5%84%E7%B9%94%E5%86%85%E3%81%AE%E5%88%A5%E3%81%AE%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%81%8C%E6%97%A2%E3%81%AB%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%8D%E3%81%A8%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B/"/>
    <id>https://officesupportjp.github.io/blog/%E3%80%8C%E3%81%93%E3%81%AE%E3%82%B3%E3%83%B3%E3%83%94%E3%83%A5%E3%83%BC%E3%82%BF%E3%83%BC%E3%81%AB%E7%B5%84%E7%B9%94%E5%86%85%E3%81%AE%E5%88%A5%E3%81%AE%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%81%8C%E6%97%A2%E3%81%AB%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%8D%E3%81%A8%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B/</id>
    <published>2021-04-12T15:00:00.000Z</published>
    <updated>2021-08-05T12:02:56.910Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。  </p><p>Office 製品のサインイン時に以下のようなエラーが表示されるとお問い合わせいただくことがございます。  </p><p><img src="image1.png" alt=""></p><p><strong>【事象について】</strong></p><p>以下の公開情報のとおり、組織内の別のアカウントが既に Office にサインインしているために発生してます。  </p><p>Title : “申し訳ございません。組織の別のアカウントが、このコンピューターで既にサインインしています” という Office 2013 があります。<br>URL : <a href="https://docs.microsoft.com/ja-jp/office/troubleshoot/office-suite-issues/another-account-already-signed-in" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/office/troubleshoot/office-suite-issues/another-account-already-signed-in</a><br>※ Office 2013 と記載されておりますが、Microsoft 365 Apps for Enterprise も対象となります。</p><p><strong>【解消方法について】</strong></p><p>以下の手順で事象が解消されるかをご確認いただきますようお願いいたします。  </p><p>- 手順<br>1. Office にサインインしているユーザーをすべてサインアウトし、Office を終了してください。<br>2. OS のスタートメニュー - 歯車 - “アカウント” - “職場または学校にアクセスする” をクリックし、”職場または学校アカウント” として表示されている項目がある場合、”切断” をクリックします<br>※ Azure AD や AD に接続済みの項目を “切断” しますと、ドメインから外れてしまいますので、Azure AD や AD に接続済み の項目は切断しないようにご注意ください。</p><p><img src="image2.png" alt=""></p><p>3. Office を起動し、サインインをご実施ください</p><p>なお、”職場または学校にアクセスする” のアカウントは、Office のサインイン時に “すべてのアプリにサインインしたままにする” の旨のダイアログで、”このアプリのみ” を選択せず、そのまま OK をクリックした場合に追加されます。</p><p><img src="image3.png" alt=""></p><p>※ このダイアログの文言は OS のバージョンによって変わる場合がございます。</p><p>“職場または学校にアクセスする” にアカウントが追加されると、Office のサインインや Office 365 ポータルへのアクセス等でパスワードが求められなくなる等の利点がございますが、<br>共用の端末の場合等でこのアカウントの追加が必要ございません場合、今後、以下の対応をご検討いただけますと幸いです。  </p><p>方法 1) “すべてのアプリにサインインしたままにする” の旨のダイアログで、”このアプリのみ” を選択する<br>方法 2) 以下の BlockAADWorkplaceJoin レジストリを設定し、”すべてのアプリにサインインしたままにする” の旨のダイアログを表示させないようにする。  </p><p>Title : Azure Active Directory デバイス管理の FAQ<br>URL : <a href="https://docs.microsoft.com/ja-jp/azure/active-directory/devices/faq" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/azure/active-directory/devices/faq</a><br>-—- 抜粋開始 —–<br>HKLM\SOFTWARE\Policies\Microsoft\Windows\WorkplaceJoin, “BlockAADWorkplaceJoin”=dword:00000001<br>-—- 抜粋終了 —–</p><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。  &lt;/p&gt;
&lt;p&gt;Office 製品のサインイン時に以下のようなエラーが表示されるとお問い合わせいただくことがございます。  &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;image1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Office ファイルを開こうとすると、実際に開いているユーザーとは異なるユーザーが使用中と表示される</title>
    <link href="https://officesupportjp.github.io/blog/Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E9%96%8B%E3%81%93%E3%81%86%E3%81%A8%E3%81%99%E3%82%8B%E3%81%A8%E3%80%81%E5%AE%9F%E9%9A%9B%E3%81%AB%E9%96%8B%E3%81%84%E3%81%A6%E3%81%84%E3%82%8B%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%A8%E3%81%AF%E7%95%B0%E3%81%AA%E3%82%8B%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%8C%E4%BD%BF%E7%94%A8%E4%B8%AD%E3%81%A8%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B/"/>
    <id>https://officesupportjp.github.io/blog/Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E9%96%8B%E3%81%93%E3%81%86%E3%81%A8%E3%81%99%E3%82%8B%E3%81%A8%E3%80%81%E5%AE%9F%E9%9A%9B%E3%81%AB%E9%96%8B%E3%81%84%E3%81%A6%E3%81%84%E3%82%8B%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%A8%E3%81%AF%E7%95%B0%E3%81%AA%E3%82%8B%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%8C%E4%BD%BF%E7%94%A8%E4%B8%AD%E3%81%A8%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B/</id>
    <published>2021-03-10T15:00:00.000Z</published>
    <updated>2021-08-05T12:30:01.501Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームの半田です。<br>この記事では、Office ファイルを開こうとすると、実際に開いているユーザーとは<br>異なるユーザーが使用中と表示されることがある事象と、その対処策について説明します。  </p><p><strong>現象</strong><br>通常、既に別のユーザーが開いているファイルを開こうとすると、以下のように別のユーザーがファイルを編集中である旨のメッセージが表示されます。<br>このとき、実際には TestUserA がファイルを開いていないにも関わらず TestUserA がファイルを使用中と表示されたり、<br>誰も当該ファイルを開いていないにも関わらず、別のユーザーがファイルを使用中と表示される事象が発生することがあります。  </p><p><img src="image1.png" alt="別のユーザーが既にファイルを開いていると表示されるメッセージ">  </p><p><strong>Office の動作について</strong><br>この事象の原因と対処策について説明する前に、関連する Office の動作について解説します。  </p><p>基本的に、Office アプリは既存のファイルを開く際、開こうとしているファイルが存在するフォルダ内に<br>~$&lt;ファイル名&gt; という名前の一時ファイルを作成し、この ~$ つきの一時ファイルに自身のユーザー名を記録します。<br>例えば、”TestFile.xlsx” というファイルを開く場合は、”~$TestFile.xlsx” という一時ファイルを作成して、自分自身のユーザー名を記録します。<br>(補足: *.xls や Access ファイルなどの一部の Office ファイルについては、開いても ~$ つきファイルは作成されません)  </p><p>これにより、既に別のユーザーによって開かれている Office ファイルを開こうとすると<br>同フォルダ内に存在する ~$ つきファイルに記録されているユーザー名を確認することで<br>当該のファイルが誰によって開かれているか確認/通知することが可能になっています。  </p><p>なおこの ~$ つきのファイルは、対応する Office ファイルが閉じられると同時に削除されます。  </p><p><strong>考えられる原因</strong><br>Office アプリは、開こうとしているファイルと同じフォルダに、対応する ~$ つきの一時ファイルが存在しないか確認し、<br>存在している場合、そのファイル内に記録されているユーザー名をもとに、誰がファイルを開いているのか通知します。  </p><p>この ~$ つきの一時ファイルは、対応する Office ファイルが閉じられると同時に削除されることが期待されますが<br>Office がクラッシュしたり、クライアント - ファイルサーバー間の接続が突然切断されるなどの予期しない動作が発生した場合、<br>削除されずに残存する場合があります。  </p><p>この場合、予期せず残存した ~$ つきファイルに起因して、実際とは異なるユーザーがファイルを使用中と表示されたり<br>誰も当該ファイルを開いていないにも関わらず、別のユーザーがファイルを使用中と表示される事象が発生することがあります。  </p><p><strong>検討される対処策</strong><br>~$ つきファイルの残存に起因して発生している事象については、この ~$ つきファイルを削除することで改善することが期待できます。<br>なお、エクスプローラーで ~$ つきファイルを表示させるためには、[フォルダー オプション] – [表示] から、以下の設定を行う必要があります。  </p><p>・[隠しファイル、隠しフォルダー、および隠しドライブを表示する] : [有効]<br>・[保護されたオペレーティング システム ファイルを表示しない (推奨)] : [無効]   </p><p>また、~$ つきのファイルは、ファイルを開いているユーザー情報を格納するためのファイルであるため<br>このファイルを削除しても、元の Office ファイルの情報が欠落することはありません。  </p><p>今回の投稿は以上です。<br><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポート チームの半田です。&lt;br&gt;この記事では、Office ファイルを開こうとすると、実際に開いているユーザーとは&lt;br&gt;異なるユーザーが使用中と表示されることがある事象と、その対処策について説明します。  &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;現象
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Excel に入力した記号のフォントが Cambria Math に変更される事象について</title>
    <link href="https://officesupportjp.github.io/blog/Excel%20%E3%81%AB%E5%85%A5%E5%8A%9B%E3%81%97%E3%81%9F%E8%A8%98%E5%8F%B7%E3%81%AE%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E3%81%8C%20Cambria%20Math%20%E3%81%AB%E5%A4%89%E6%9B%B4%E3%81%95%E3%82%8C%E3%82%8B%E4%BA%8B%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/Excel%20%E3%81%AB%E5%85%A5%E5%8A%9B%E3%81%97%E3%81%9F%E8%A8%98%E5%8F%B7%E3%81%AE%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E3%81%8C%20Cambria%20Math%20%E3%81%AB%E5%A4%89%E6%9B%B4%E3%81%95%E3%82%8C%E3%82%8B%E4%BA%8B%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2021-03-03T15:00:00.000Z</published>
    <updated>2021-08-05T13:13:04.188Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームの永田です。</p><p>Excelで、「≧」「⇒」といった一部の記号のフォントが、予期せず Cambria Math に変更される事象が発生することがあります。 情報に更新があり次第、このブログ記事は更新される予定です。</p><p><strong>事象</strong></p><p>Excelで、「≧」「⇒」といった一部の記号のフォントが、予期せず Cambria Math に変更される</p><p><strong>再現手順</strong></p><ol><li>Excel を起動する</li><li>新規ブックを追加する</li><li>セル A1 を選択し、ホーム - フォント 欄より、フォントを Arial に設定する</li><li>セル A1 をダブルクリックして編集モードにする</li><li>日本語入力 ON にして、「だいなり」と入力し、≧ 記号を入力して決定する</li></ol><p>結果</p><p>フォントが Cambria Math に変更される。また、それに伴って行の高さが予期せず大きくなる。</p><p><strong>再現条件</strong></p><p>以下の場合には再現しません</p><ul><li>[ファイル] - [オプション] - [言語] - [Office の編集言語と構成機能] より、英語 (米国) が &lt;優先&gt; となっている場合には発生しない。日本語が &lt;優先&gt; の場合に発生する。</li><li>上記の手順 4. を飛ばして、編集モードまたは入力モードにしない状態で「≧」記号だけを入力した場合、発生しない。</li><li>上記の手順 3. の手順で、セルのフォントを MS Pゴシック などに設定した場合、発生しない。</li></ul><p>以下の場合、事象が発生します</p><ul><li>既に「≧」記号が入力され、期待通りに表示されているセルについて、セルのフォントを Arial に変更後、セルをダブルクリックすると、記号のフォントが Cambria Math に変更される。</li><li>セルのフォントが Arial の状態で、[挿入] - [記号と特殊記号] - [記号と特殊記号] を開き、[フォント(F): MS Pゴシック]、[種類(U): 数学記号] をそれぞれ選択し、一覧から記号を挿入すると、挿入直後はフォントが変化しない。ただし、このセルをダブルクリックすると、記号のフォントが Cambria Math に変更される。</li></ul><p><strong>影響範囲</strong></p><p>Microsoft 365 Apps 内の Excel、および、ボリュームライセンス版の Excel 2019 で発生します。Microsoft 365 Apps の場合、現時点で最新のバージョン 2102 (13801.20274) でも発生します。</p><p>Excel 2013 や、ボリュームライセンス版の Excel 2016、パッケージ版の Excel 2016 では発生しません。</p><p><strong>対応状況</strong></p><p>マイクロソフトでは現時点でこの問題を調査中です。</p><p><strong>回避策</strong></p><p>現段階での回避策としては、誠に恐れ入りますが、以下の方法を検討ください。</p><ul><li>すでに Cambria Math に変換されたセルは、セルを選択して「MS ゴシック」など日本語フォントに設定する</li><li>これから「≧」記号を入力するセルは、予め「MS ゴシック」など日本語フォントに設定しておく</li><li>「≧」記号の両辺の数字を英数字フォント (Arial など) に変更したい場合には、予めセル全体を「MS ゴシック」など日本語フォントに設定した後、セルをダブルクリックして編集モードにし、「≧」記号以外の箇所 (例: 記号の両辺の数字など) を選択して、フォントを Arial などに変更する。</li><li>[ファイル] - [オプション] - [言語] - [Office の編集言語と構成機能] より、優先する言語を、英語に変更する。</li></ul><p>今回の投稿は以上です。</p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポート チームの永田です。&lt;/p&gt;
&lt;p&gt;Excelで、「≧」「⇒」といった一部の記号のフォントが、予期せず Cambria Math に変更される事象が発生することがあります。 情報に更新があり次第、このブログ記事は更新される予定です。&lt;/p&gt;
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Excel for Microsoft 365 で上書きモードで DBCS を 1 文字を編集すると 2 文字分上書きされる</title>
    <link href="https://officesupportjp.github.io/blog/Excel%20for%20Microsoft%20365%20%E3%81%A7%E4%B8%8A%E6%9B%B8%E3%81%8D%E3%83%A2%E3%83%BC%E3%83%89%E3%81%A7%20DBCS%20%E3%82%92%201%20%E6%96%87%E5%AD%97%E3%82%92%E7%B7%A8%E9%9B%86%E3%81%99%E3%82%8B%E3%81%A8%202%20%E6%96%87%E5%AD%97%E5%88%86%E4%B8%8A%E6%9B%B8%E3%81%8D%E3%81%95%E3%82%8C%E3%82%8B/"/>
    <id>https://officesupportjp.github.io/blog/Excel%20for%20Microsoft%20365%20%E3%81%A7%E4%B8%8A%E6%9B%B8%E3%81%8D%E3%83%A2%E3%83%BC%E3%83%89%E3%81%A7%20DBCS%20%E3%82%92%201%20%E6%96%87%E5%AD%97%E3%82%92%E7%B7%A8%E9%9B%86%E3%81%99%E3%82%8B%E3%81%A8%202%20%E6%96%87%E5%AD%97%E5%88%86%E4%B8%8A%E6%9B%B8%E3%81%8D%E3%81%95%E3%82%8C%E3%82%8B/</id>
    <published>2021-02-09T15:00:00.000Z</published>
    <updated>2021-08-07T14:05:06.697Z</updated>
    
    <content type="html"><![CDATA[<p><strong>【最終更新日: 2021/02/10】</strong></p><p>こんにちは、Office サポートです。<br>本記事では新たに確認された、Excel for Microsoft 365 で上書きモードで DBCS を 1 文字を編集すると 2 文字分上書きされる問題について説明します。  </p><p><strong>現象</strong><br>Excel for Microsoft 365 で Insert キーを押下し、<br>上書きモードで DBCS (2 バイト文字) を編集すると、意図せず 2 文字ぶん上書きされます。  </p><p><strong>再現手順</strong><br>例) 「あい<strong>う</strong>えお」を「あい<strong>か</strong>えお」に直したい場合</p><p>1. 任意のセルに、「あいうえお」と入力します。<br>2.「う」のまえにカーソル入れます。<br>3. [insert] キーで上書きモードにします。</p><p><img src="image1.png" alt=""></p><p>4.「か」と入力し、確定のため [Enter] キーを押します。</p><p>結果 :<br>「う」と「え」の部分が、「か」で上書きされて、「あいかお」になります。  </p><p><img src="image2.png" alt=""></p><p>期待する結果は、「あいかえお」です。  </p><p><strong>解決方法</strong>  </p><p>以下の更新チャネル/バージョンで修正しました。<br>下記以降の更新チャネル/バージョンに更新することで解決します。</p><p>　最新チャネル (プレビュー) : バージョン 2012 (ビルド 13530.20064)<br>　最新チャネル : バージョン 2012 (ビルド 13530.20316)<br>　半期エンタープライズ チャネル (プレビュー) : バージョン 2008 (ビルド 13127.21064)<br>　半期エンタープライズ チャネル : バージョン 2008 (ビルド 13127.21064)</p><p>　月次エンタープライズ チャネル : バージョン 2012 (ビルド 13530.20528)</p><p><strong>回避策</strong><br>[insert] キーで挿入モードに切り替えて、編集します。  </p><p><strong>状況</strong><br>マイクロソフトでは、この問題をこの資料の対象製品として記載されているマイクロソフト製品の問題として認識しています  </p><p><strong>更新履歴</strong><br>2021/01/14 : 解決方法を追加しました。</p><p>2021/02/10 : 解決方法に、月次エンタープライズ チャネルを追加しました。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;【最終更新日: 2021/02/10】&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;こんにちは、Office サポートです。&lt;br&gt;本記事では新たに確認された、Excel for Microsoft 365 で上書きモードで DBCS を 1 文字を編集すると 2 文字
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>クリップボード アクセスの競合による Office でのコピー-貼り付け失敗</title>
    <link href="https://officesupportjp.github.io/blog/%E3%82%AF%E3%83%AA%E3%83%83%E3%83%97%E3%83%9C%E3%83%BC%E3%83%89%20%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%AE%E7%AB%B6%E5%90%88%E3%81%AB%E3%82%88%E3%82%8B%20Office%20%E3%81%A7%E3%81%AE%E3%82%B3%E3%83%94%E3%83%BC-%E8%B2%BC%E3%82%8A%E4%BB%98%E3%81%91%E5%A4%B1%E6%95%97/"/>
    <id>https://officesupportjp.github.io/blog/%E3%82%AF%E3%83%AA%E3%83%83%E3%83%97%E3%83%9C%E3%83%BC%E3%83%89%20%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%AE%E7%AB%B6%E5%90%88%E3%81%AB%E3%82%88%E3%82%8B%20Office%20%E3%81%A7%E3%81%AE%E3%82%B3%E3%83%94%E3%83%BC-%E8%B2%BC%E3%82%8A%E4%BB%98%E3%81%91%E5%A4%B1%E6%95%97/</id>
    <published>2021-01-18T15:00:00.000Z</published>
    <updated>2021-08-05T13:36:26.790Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームの中村です。</p><p>Office アプリケーション上でコピーや貼り付け操作を行ったときに、コピーしたはずのデータが貼り付けられなかったり、エラーが発生することがあります。これは、他のアプリケーションとのクリップボードへのアクセスが競合したことが原因である場合が非常に多いものとなります。このような原因でコピー・貼り付けに失敗する場合、基本的には再度コピーや貼り付けを行うしかありません。</p><p>弊社サポートへのお問い合わせの中で、このような状況が避けられないことに疑問を持つ声を時折頂いていますので、今回の記事では、この仕組みを解説します。</p><h4 id="1-Windows-のコピー・貼り付けの仕組み"><a href="#1-Windows-のコピー・貼り付けの仕組み" class="headerlink" title="1. Windows のコピー・貼り付けの仕組み"></a><strong>1. Windows</strong> <strong>のコピー・貼り付けの仕組み</strong></h4><p>Windows 上では、例えば Office / インターネット ブラウザ / メモ帳など、異なるアプリケーション間でデータをコピーして貼り付けることができます。このような操作が実現できるのは、OS の「クリップボード」がコピーデータを仲介しているためです。アプリケーション上でデータをコピーすると、クリップボードにコピーしたデータを格納します。また、別のアプリケーションで貼り付けを行うときには、クリップボードからコピーしたデータを取り出します。</p><p>このクリップボードを介したコピー・貼り付けの仕組みにおいては、データの整合性を担保することが重要です。例えば、コピーしたデータをクリップボードに格納している途中で他のアプリケーションがこのデータを読み取ると、中途半端な状態のコピーデータが読み取られる危険があります。また、同時に複数のプロセスが異なるコピーデータをクリップボードに書きこむと、データが破損する懸念があります。このような問題を避けるため、クリップボードに複数のアプリケーションから同時にアクセスができないよう、あるアプリケーションからクリップボードにアクセスしている最中は、クリップボードをロックする仕組みとなっています。</p><p><img src="image1.png" alt=""></p><p>このようにクリップボードがロックされている間に他のプロセスがクリップボードをオープンすると、そのアクセスは失敗します。つまり、コピーしたデータが格納できなかったり、貼り付けたいデータが取得できず何も貼り付けられなかったり、といった状況となります。アプリケーションによっては、クリップボードのオープン失敗を検知してエラーメッセージを表示することもあります。このような状況を、「クリップボード アクセスの競合」と呼んでいます。</p><p><img src="image2.png" alt=""></p><p>上記の図におけるプロセス B からは、自身がコピーなどのためにクリップボードにアクセスするとき、クリップボードがロックされているか、通常確認を行うことはありませんし、仮に確認しても強制的にロックを解除することはできません。このため、上図のようにタイミングによってはクリップボードにアクセスできない場合があることは Windows のクリップボードを介したコピー・貼り付けの仕組み上、避けることはできません。Office がプロセス B の立場になった場合も同様ですので、Office 上でのコピー・貼り付けにおいてもこの仕組みの制約を受けることになります。  </p><h4 id="2-問題に直面するシナリオ"><a href="#2-問題に直面するシナリオ" class="headerlink" title="2. 問題に直面するシナリオ"></a><strong>2. 問題に直面するシナリオ</strong></h4><p>ユーザー操作によるコピーと貼り付けでのみクリップボードが使われる場合、この流れはシリアルに行われますので、競合が発生することはありません。しかし、実際の Windows 上では、様々な目的でユーザーが意識していないタイミングでクリップボードへのアクセスが行われることがあります。以下に、その例を記載します。  </p><p><strong>・Windows 10 のクリップボード履歴機能</strong></p><p>Windows 10 バージョン 1807 から追加された新機能で、コピーしたデータの過去複数件の履歴を保持して貼り付けられるようになりました。この機能の実現のため、クリップボードにデータが格納されると、クリップボード履歴機能のプロセスからクリップボードにアクセスが発生します。</p><p>参考)クリップボードの概要<br><a href="https://support.microsoft.com/ja-jp/windows/30375039-ce71-9fe4-5b30-21b7aab6b13f" target="_blank" rel="noopener">https://support.microsoft.com/ja-jp/windows/30375039-ce71-9fe4-5b30-21b7aab6b13f</a></p><p><strong>・エクスプローラの [貼り付け] ボタン</strong></p><p>エクスプローラのリボンに [貼り付け] ボタンがあります。コピーデータがファイルなどのエクスプローラ上で貼り付けられるデータの場合に、このリボンのボタンを活性化するため、リボンが展開表示されている場合は、コピー時にエクスプローラからもアクセスが発生します。(リボンを閉じた状態で OS を再起動してそのままリボンを開かなければ、このアクセスは発生しません。)  </p><p><strong>・リモート デスクトップのクリップボード共有</strong></p><p>リモート デスクトップ時に、[ローカル リソース] タブで [クリップボード] のチェックを有効にすると、ローカルとリモートのマシン間でデータをコピーすることができます。この機能が有効な状態でリモート接続している場合、これを管理するプロセス (rdpclip.exe) からクリップボードにアクセスが発生します。  </p><p><strong>・他の Office アプリケーション</strong></p><p>Office アプリケーション間では、Word と Excel など、別の Office アプリケーション同士でコピー・貼り付けを行う独自の仕組み (Office クリップボード) があります。この機能は、OS にクリップボード履歴機能が搭載される以前から、コピーデータの履歴を利用できる機能を提供していました。この機能実現のため、いずれかの Office アプリケーションでコピーが行われると、起動している他の Office アプリケーションからクリップボードにアクセスが発生します。</p><p>なお、この機能については以下のレジストリを設定することで無効化できます。Office クリップボードを無効化しても、通常の OS としてのコピー・貼り付け機能の範囲でコピー操作を利用できます。</p><p>&lt;Office クリップボードの無効化&gt;<br>キー : HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Common\General<br>名前: AcbControl<br>種類: REG_DWORD<br>値 : 2147483648 (10 進)<br>※ Microsoft 365 / Office 2019 / Office 2016 向けのレジストリ キーです。<br>※ すべての Office アプリケーションを終了した状態で設定してください。  </p><p><strong>・サードパーティ製品 (主にクリップボード監視機能、セキュア接続機能などを提供する製品)</strong></p><p>サードパーティ ソフトでも、クリップボードへのアクセスが行われることがあります。</p><p>例えばセキュリティ ソフトなどには、ユーザーによるデータの持ち出しを監視するため、クリップボード監視機能がついているものがあります。このような製品の多くでは、クリップボード監視機能によって、データのコピー・貼り付けなどに連動してクリップボードにアクセスが発生します。</p><p>また、Windows のリモート デスクトップに似た、独自のセキュア接続としてリモート マシンに接続するソフトでも、クリップボード共有のためアクセスが発生することがあります。  </p><p>このように、様々なプロセスからクリップボードへのアクセスは発生しますが、ほとんどの場合、実際にはクリップボードがロックされるのは非常に短い時間であるため、実際に競合が生じることは一般的な環境やユーザー操作シナリオではそれほど多くはありません。</p><p>ただ、クリップボード アクセスの競合は、クリップボードがロックされている時間が長いほど発生しやすくなります。ロック時間の長さは、コピーデータのサイズやアプリケーションの処理の流れによって異なります。また当然、クリップボード アクセスを行うプロセスが多いほど競合の可能性は高くなるため、様々な製品を導入された環境や、多数のアプリケーションを起動していると比較的発生しやすくなります。そして、プログラムからループ処理で短い時間で繰り返しコピーや貼り付けを行うときは競合の可能性が高くなります。</p><p>これらの要素に該当する環境や利用状況では、実際にある程度高い頻度で競合が発生することがある、という報告は弊社サポートにも寄せられています。  </p><h4 id="3-対応方法"><a href="#3-対応方法" class="headerlink" title="3. 対応方法"></a><strong>3. 対応方法</strong></h4><p>1. でご説明した通り、仕組み上、クリップボードへのアクセス競合を完全に防ぐことはできません。このため、Office アプリケーションで競合によるコピー・貼り付けの失敗が生じる状況では、競合相手のプロセスを停止 (クリップボードにアクセスする機能を無効化) して解消するか、ユーザーが再度コピーや貼り付けを行う運用対処しかありません。</p><p>クリップボードへのアクセスが失敗した場合の Office の動作は、アプリケーションによって異なります。</p><p><strong>Excel</strong></p><p>コピー時にクリップボードへのアクセスに失敗すると以下のようなメッセージが表示され、このときにも、その Excel プロセス内ではデータの貼り付けが可能です。(他のアプリケーションには貼り付けられません。)</p><p><img src="image3.png" alt=""></p><p>貼り付け時のクリップボード アクセス失敗の場合は、クリップボードからデータを取得できないため貼り付けられません。この時は、特にエラーメッセージは表示されません。  </p><p><strong>Word / PowerPoint</strong></p><p>コピー、貼り付け共に特にエラーメッセージは表示されず、自アプリケーション内でも貼り付けはできません。  </p><p><ins><strong>マクロ等からのコピー処理で発生する場合の対処</strong></ins></p><p>VBA マクロやその他言語で Office をオートメーションしていて、その処理の中でコピー・貼り付けを行うときに現象が発生する場合は、コピー・貼り付けではなく、別の方法でデータの転記を行うよう変更して回避することをお勧めします。</p><p>例えば、Excel でセルをコピーして別のシートに貼り付けるような場合は、コピー元のセル オブジェクトの Valueなどを貼り付け先のセルに設定するよう変更し、Copy や Paste といったメソッドは使用しないことが検討できます。</p><p>例: B1 セルの内容を A1 セルへクリップボードを経由して貼り付けるコードの変更イメージ</p><p>変更前:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ActiveSheet.Range(&quot;B1&quot;).Copy</span><br><span class="line">ActiveSheet.Range(&quot;A1&quot;).Select</span><br><span class="line">ActiveSheet.Paste</span><br></pre></td></tr></table></figure><p>変更後:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ActiveSheet.Range(&quot;A1&quot;).Value &#x3D; ActiveSheet.Range(&quot;B1&quot;).Value</span><br></pre></td></tr></table></figure><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポート チームの中村です。&lt;/p&gt;
&lt;p&gt;Office アプリケーション上でコピーや貼り付け操作を行ったときに、コピーしたはずのデータが貼り付けられなかったり、エラーが発生することがあります。これは、他のアプリケーションとのクリップボードへのアク
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Excel で ScrollArea プロパティを設定すると、キーボード操作でシートがスクロールしない</title>
    <link href="https://officesupportjp.github.io/blog/Excel%20%E3%81%A7%20ScrollArea%20%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B%E3%81%A8%E3%80%81%E3%82%AD%E3%83%BC%E3%83%9C%E3%83%BC%E3%83%89%E6%93%8D%E4%BD%9C%E3%81%A7%E3%82%B7%E3%83%BC%E3%83%88%E3%81%8C%E3%82%B9%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%97%E3%81%AA%E3%81%84/"/>
    <id>https://officesupportjp.github.io/blog/Excel%20%E3%81%A7%20ScrollArea%20%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B%E3%81%A8%E3%80%81%E3%82%AD%E3%83%BC%E3%83%9C%E3%83%BC%E3%83%89%E6%93%8D%E4%BD%9C%E3%81%A7%E3%82%B7%E3%83%BC%E3%83%88%E3%81%8C%E3%82%B9%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%97%E3%81%AA%E3%81%84/</id>
    <published>2021-01-11T15:00:00.000Z</published>
    <updated>2021-08-06T00:37:13.837Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームの中村です。</p><p>Excel には、ワークシートのスクロール可能な範囲を設定する ScrollArea というシート プロパティが用意されています。本記事では、このScrollArea プロパティを設定したとき、キーボードの矢印キーや Tab キーなどで選択セルを移動したとき、ウィンドウに表示されていないセルに移動しても、そのセルが画面に表示されるようシートがスクロールしない動作について記載します。  </p><h4 id="1-現象"><a href="#1-現象" class="headerlink" title="1. 現象"></a><strong>1. 現象</strong></h4><p>以下の画面キャプチャをご覧ください。この画面では、O2 セルが現在選択されていますが、画面右端に見切れて表示された状態になっています。(赤枠部分)</p><p>通常、例えば A2 セルから右矢印キーや、Tab キーで B2、C2・・・と順に列を移動すると、選択状態のセル全体がウィンドウ内に見える位置に自動的にスクロールされます。しかしながら、後述の状況においては、この画面キャプチャのように十分にスクロールされない場合があります。またこのあと、O 列以降のセルに移動してもこの位置のままスクロールしません。</p><p><img src="image1.png" alt="">  </p><h4 id="2-現象が発生する状況"><a href="#2-現象が発生する状況" class="headerlink" title="2. 現象が発生する状況"></a><strong>2. 現象が発生する状況</strong></h4><p>この動作に直面する主な状況は、ワークシートの ScrollArea プロパティが設定された状態で、かつセルの幅や高さが広げられているときに、スクロール可能範囲の終端に近いセルに移動する場合です。</p><p>Excel が画面外の領域にスクロールするときに、スクロール後のウィンドウ内に表示するシート範囲などを、セルの幅や高さ / ウィンドウのサイズ / 残りのスクロール可能範囲などの要素を基に算出します。これらの要素の組み合わせ次第で、スクロール後の表示位置を期待通りに算出できない場合があり、この現象が発生します。</p><p>また、Excel バージョンによっても細かな動作は異なるため、例えば同じファイルを同じウィンドウ サイズで開いても、スクロールしなくなる動作が生じる列や行はバージョンによって異なる場合があります。</p><p>発生に関わる条件をまとめると以下の通りです。</p><p><strong>条件 1:</strong><br>ワークシートの ScrollArea プロパティが設定されていること</p><p>※プログラムからは Worksheet オブジェクトのプロパティや、Visual Basic Editor でプロパティ ウィンドウからも設定・確認できます。</p><p>ScrollArea プロパティ (Excel)<a href="https://docs.microsoft.com/ja-jp/office/vba/api/excel.worksheet.scrollarea" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/office/vba/api/excel.worksheet.scrollarea</a></p><p><img src="image2.png" alt=""></p><p><strong>条件 2:</strong><br>以下の要素等の組み合わせによって発生</p><ul><li>選択セルから ScrollArea プロパティの終端までの残りの幅・高さ</li><li>Excel ブック画面のウィンドウ サイズ</li><li>各セルの幅や高さ</li><li>シートの倍率</li><li>ウィンドウ サイズなどの算出に関わるディスプレイの拡大縮小、スケール設定</li></ul><p>この動作は、ユーザーの利用上、不便な場合がある動作であることは認識しておりますが、現状のスクロール動作の内部処理上の制約として、現時点でサポートされる全てのバージョンの Excel で発生しうる制限動作となっています。(2021/1/12 現在、サポート対象の Excel は Excel 2013 / 2016 / 2019 / Office 365 の Excel です。)  </p><h4 id="3-回避策"><a href="#3-回避策" class="headerlink" title="3. 回避策"></a><strong>3. 回避策</strong></h4><p>この動作が生じるファイルやウィンドウ サイズなどの構成でも、以下のいずれかの方法でスクロールできます。  </p><h5 id="3-1-スクロールバーでスクロールする"><a href="#3-1-スクロールバーでスクロールする" class="headerlink" title="3-1. スクロールバーでスクロールする"></a><strong>3-1. スクロールバーでスクロールする</strong></h5><p>マウス操作でスクロール バーによってスクロールすると、画面をスクロールできます。</p><p>以下は、先述のファイルでスクロール バーの右矢印 (赤枠部分) をマウスで操作してスクロールした例です。</p><p><img src="image3.png" alt="">  </p><h5 id="3-2-ScrollArea-を広げる、または解除する"><a href="#3-2-ScrollArea-を広げる、または解除する" class="headerlink" title="3-2. ScrollArea を広げる、または解除する"></a><strong>3-2. ScrollArea を広げる、または解除する</strong></h5><p>移動先のセルから、ScrollArea の終端までの幅や高さが十分に広い場合には、正常にスクロールできます。</p><p>例えば A～Q 列にあるテーブルの範囲だけスクロールするさせるため、ScrollArea プロパティに A ～ Q 列を設定しているとします。これを、例えば Z 列など、ある程度余裕を持った範囲をスクロールできるよう設定すると、実際にスクロールしたい範囲では期待通りスクロールできます。(どの列までを ScrollArea に設定すれば問題ないかは、条件 2 の各要素に依存します。具体的な値は定められませんが、実際の環境・ファイルで動作を確認しながら、余裕を持った範囲を設定してください。)</p><p>ScrollArea を広げるにあたって、例えば上記の例であれば、テーブル外の R ～ Z 列のセルを選択させたくない場合は、シート保護の設定で [ロックされたセル範囲の選択] を無効にすることでセル選択を禁止できます。  </p><p><strong>設定手順:</strong><br>1. 選択させたくないセル (上記の例では R ～ Z 列) のセルを右クリックし、[セルの書式設定] – [保護] で [ロック] を有効にします。(既定では有効です。)</p><p>2. 反対に、選択を可能とするセル (上記の例では A ~ Q 列) は同様のメニューで、[ロック] を無効にします。</p><p>3. [校閲] タブ – [シートの保護] – “このシートのすべてのユーザーに許可する操作” の一覧で [ロックされたセル範囲の選択] のチェックを外します。</p><p><img src="image4.png" alt=""><br><img src="image5.png" alt=""></p><p>VBA などのプログラムからは、以下で設定できます。</p><p>Worksheet. EnableSelection プロパティ (Excel)<a href="https://docs.microsoft.com/ja-jp/office/vba/api/excel.worksheet.enableselection" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/office/vba/api/excel.worksheet.enableselection</a></p><p>このプロパティで xlUnlockedCells を設定します。このプロパティは、ワークシートを保護した状態でのみ有効ですので、さらに以下の Protect メソッドでワークシートを保護します。</p><p>Protect メソッド (Excel)<a href="https://docs.microsoft.com/ja-jp/office/vba/api/excel.worksheet.protect" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/office/vba/api/excel.worksheet.protect</a></p><p>また、選択セルの移動を制限することが ScrollArea プロパティを設定している目的である場合は、上記の設定を代わりに行うことで、ScrollArea プロパティの設定自体を削除することも検討できます。(ただし、スクロール バーの操作ではスクロールできます。)</p><p>ScrollArea 設定を削除する場合は、プログラムからは ScrollArea プロパティに空の値 (“”) を設定してください。プロパティ ウィンドウの場合は、ScrollArea プロパティの値を削除してください。  </p><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポート チームの中村です。&lt;/p&gt;
&lt;p&gt;Excel には、ワークシートのスクロール可能な範囲を設定する ScrollArea というシート プロパティが用意されています。本記事では、このScrollArea プロパティを設定したとき、キーボード
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>PowerPoint Online で日本語フォントが変更される</title>
    <link href="https://officesupportjp.github.io/blog/PowerPoint%20Online%20%E3%81%A7%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E3%81%8C%E5%A4%89%E6%9B%B4%E3%81%95%E3%82%8C%E3%82%8B/"/>
    <id>https://officesupportjp.github.io/blog/PowerPoint%20Online%20%E3%81%A7%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E3%81%8C%E5%A4%89%E6%9B%B4%E3%81%95%E3%82%8C%E3%82%8B/</id>
    <published>2020-12-03T15:00:00.000Z</published>
    <updated>2021-08-06T00:45:41.077Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームです。</p><p>本記事では、PowerPoint Online で日本語フォントが異なるフォントで表示される問題について説明します。</p><p><strong>現象</strong></p><p>PowerPoint の表内の日本語フォントが、PowerPoint Online で表示すると異なるフォントで表示されます。</p><p>例えば、スライド マスターでテーマ フォントを Meiryo UI に設定しているプレゼンテーションで、PowerPoint Online 上では英数字用のフォント (例では Arial) で表示されます。</p><p><img src="image1.png" alt="">  </p><p><strong>原因</strong></p><p>この現象は問題としてフィードバックを行いました。</p><p><strong>回避策</strong></p><p>以下のいずれかの回避策で現象を回避できます。</p><p>1. 表のフォントを明示的に指定します。</p><p>スライド マスターでテーマ フォントを設定した場合、表のフォント自体は [+本文のフォント] となりますが、表のフォントを [Meiryo UI] など明示的に指定します。</p><p>2. 英数字用フォントを変更します。</p><p>スライド マスターでテーマ フォントの英数字用フォントとして、[Meiryo UI] など日本語に設定したいフォントを指定します。</p><p>新たな情報が確認された場合には、この記事に追記する形で公開していく予定です。</p><p>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポート チームです。&lt;/p&gt;
&lt;p&gt;本記事では、PowerPoint Online で日本語フォントが異なるフォントで表示される問題について説明します。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;現象&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;PowerPoint の
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Office 展開ツール (16.0.13328.20356) で生じる事象について</title>
    <link href="https://officesupportjp.github.io/blog/Office%20%E5%B1%95%E9%96%8B%E3%83%84%E3%83%BC%E3%83%AB%20(16.0.13328.20356)%20%E3%81%A7%E7%94%9F%E3%81%98%E3%82%8B%E4%BA%8B%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/Office%20%E5%B1%95%E9%96%8B%E3%83%84%E3%83%BC%E3%83%AB%20(16.0.13328.20356)%20%E3%81%A7%E7%94%9F%E3%81%98%E3%82%8B%E4%BA%8B%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2020-11-23T15:00:00.000Z</published>
    <updated>2021-08-06T00:53:51.112Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。  </p><p><strong>2020/11/19 記事の内容を更新しました</strong></p><p><strong>2020/11/24 記事の内容を更新しました</strong></p><p>Office 展開ツール (16.0.13328.20356) にて、以下の事象が報告されておりますのでご案内いたします。  </p><p><strong>【事象】</strong>  </p><p>Office 展開ツール (16.0.13328.20356) では、現時点で以下の事象が報告されております。  </p><p>1) XMLファイルの Logging 要素 Path 属性に定義したフォルダにログファイルが出力されない  </p><p>2) Office 展開ツールを管理者権限で実行しない場合、/download オプションでダウンロードが行えない  </p><p>3) XMLファイルの Add 要素 Version 属性を定義した場合、.cab ファイルがダウンロードされない</p><p><strong>- 参考</strong></p><p><a href="https://docs.microsoft.com/ja-jp/officeupdates/odt-release-history" target="_blank" rel="noopener"></a><a href="https://docs.microsoft.com/en-us/officeupdates/odt-release-history" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/officeupdates/odt-release-history</a>  </p><p><strong>1) については、Office 展開ツールの仕様変更によるものとなります。今後、Logging 要素 Path 属性はご利用いただけません。</strong></p><p><strong>2) と 3) については、</strong></p><p><strong>最新の Office 展開ツールにて修正されておりますので、最新の Office 展開ツールをご利用いただきますようお願いいたします。</strong></p><p><strong>今回の投稿は以上です。</strong>  </p><p>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。  &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2020/11/19 記事の内容を更新しました&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2020/11/24 記事の内容を更新しました&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Off
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Windows 10 バージョン 2004 (20H1) - 20H2 で VBA 関数 StrComp() で全角カナと半角カナが一致判定されない</title>
    <link href="https://officesupportjp.github.io/blog/Windows%2010%20%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%202004%20(20H1)%20-%2020H2%20%E3%81%A7%20VBA%20%E9%96%A2%E6%95%B0%20StrComp()%20%E3%81%A7%E5%85%A8%E8%A7%92%E3%82%AB%E3%83%8A%E3%81%A8%E5%8D%8A%E8%A7%92%E3%82%AB%E3%83%8A%E3%81%8C%E4%B8%80%E8%87%B4%E5%88%A4%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%AA%E3%81%84/"/>
    <id>https://officesupportjp.github.io/blog/Windows%2010%20%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%202004%20(20H1)%20-%2020H2%20%E3%81%A7%20VBA%20%E9%96%A2%E6%95%B0%20StrComp()%20%E3%81%A7%E5%85%A8%E8%A7%92%E3%82%AB%E3%83%8A%E3%81%A8%E5%8D%8A%E8%A7%92%E3%82%AB%E3%83%8A%E3%81%8C%E4%B8%80%E8%87%B4%E5%88%A4%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%AA%E3%81%84/</id>
    <published>2020-11-23T15:00:00.000Z</published>
    <updated>2021-08-06T01:24:15.659Z</updated>
    
    <content type="html"><![CDATA[<p><strong>2020/11/24 Update</strong><br>「4. その他の発生シナリオ」セクションを追加し、Excel での検索・置換 (Find / Replace) での発生を追記しました。  </p><p>こんにちは、Office サポート チームの中村です。</p><p>先日、以下の記事で同じ原因により Access フォームで発生する問題について記載していますが、VBA 関数 StrComp() も影響を受けることが分かったため、本記事にて詳細をご案内します。  </p><p><strong>関連記事</strong></p><p>Windows 10 バージョン 2004 (20H1) / 20H2 上で 半角カナのフォームを含んだ Access ファイルでエラーが発生する<br><a href="https://social.msdn.microsoft.com/Forums/ja-JP/4e6223e2-34d0-4a5f-bb61-109bc28040b6" target="_blank" rel="noopener">https://social.msdn.microsoft.com/Forums/ja-JP/4e6223e2-34d0-4a5f-bb61-109bc28040b6  </a>  </p><h4 id="1-現象"><a href="#1-現象" class="headerlink" title="1. 現象"></a><strong>1. 現象</strong></h4><p>VBA には、StrComp() という 2 つの文字列が一致するかを比較する関数が用意されています。</p><p>StrComp 関数<br><a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/strcomp-function" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/strcomp-function</a>  </p><p>例えば以下のサンプル コードのように、濁点または半濁点を含む文字列を、一方は全角、一方半角で比較すると、以前の OS では一致とみなされ 0 が返っていました。</p><p>しかし、Windows 10 バージョン 2004 および 20H2 OS 上で実行すると、不一致を示す -1 が返ります。  </p><p>&lt;サンプル コード&gt;</p><pre><code>Sub Sample()    MsgBox StrComp(&quot;サンプル&quot;, &quot;ｻﾝﾌﾟﾙ&quot;, vbTextCompare)End Sub</code></pre><p>本現象は、Office バージョンに関係なく発生します。  </p><h4 id="2-原因"><a href="#2-原因" class="headerlink" title="2. 原因"></a><strong>2. 原因</strong></h4><p>Windows 10 バージョン 2004 で、OS の自然言語処理を担う NLS (National Language Support) バージョンが更新されました。</p><p>&lt;OS バージョンと NLS バージョン&gt;  </p><table><thead><tr><th align="left">OS バージョン</th><th align="left">NLS バージョン</th></tr></thead><tbody><tr><td align="left">1909</td><td align="left">6.2</td></tr><tr><td align="left">2004 (20H1) / 20H2</td><td align="left">6.3</td></tr></tbody></table><p>この新しいバージョン 6.3 の NLS ソート テーブルにて、濁点および半濁点を含むカナ文字について、半角と全角が異なる文字と認識される問題の影響で現象が発生します。上記の例の場合、”プ” (全角) と “ﾌﾟ” (半角) が違う文字と判定されます。</p><p>この問題は、OS の更新プログラムについての公開情報でも既知の問題として記載されています。</p><p>Windows 10, version 2004 and Windows Server, version 2004 update history<br><a href="https://support.microsoft.com/en-us/help/4555932/windows-10-update-history" target="_blank" rel="noopener">https://support.microsoft.com/en-us/help/4555932/windows-10-update-history</a></p><p>Windows 10, version 20H2 and Windows Server, version 20H2 update history<br><a href="https://support.microsoft.com/en-us/help/4581839/windows-10-update-history" target="_blank" rel="noopener">https://support.microsoft.com/en-us/help/4581839/windows-10-update-history</a></p><p>&lt;公開情報より該当の記載を抜粋&gt;</p><table><thead><tr><th align="left"><strong>Symptom</strong></th><th align="left"><strong>Workaround</strong></th></tr></thead><tbody><tr><td align="left">Certain Japanese half-width Katakana and full-width Katakana characters that have a consonant mark aren’t interpreted as the same character. When you use the <strong>CompareStringEx()</strong> function with the <em>NORM_IGNOREWIDTH</em> flag to compare them, these characters are evaluated as different because of an issue in the sorting rule<strong>.</strong> This issue affects all the updates starting on June 9, 2020 for Windows 10, version 2004.</td><td align="left">Currently, there is no workaround for this issue.</td></tr></tbody></table><h4 id="3-回避策"><a href="#3-回避策" class="headerlink" title="3. 回避策"></a><strong>3. 回避策</strong></h4><p>以下のいずれかの回避策で現象を回避できます。  </p><p><strong>a.</strong> <strong>比較対象の文字列を全角、または半角に統一する</strong></p><p>実際の VBA コードでは、値は VBA 定数、Excel シート上のセルの値や Access データベースのテーブルの値、ユーザーフォームなど、様々な場所から取得されることが想定されます。VBA コード取得元となる文字列を探して全角 / 半角が統一されるよう変更します。  </p><p><strong>b. StrConv</strong> <strong>関数で全角、または半角に統一してから比較する</strong></p><p>複雑なコードで比較対象文字列の取得元を特定することが困難な場合や、ユーザーが入力するため制御が難しい場合などには、StrConv 関数を用いて全角または半角に変換してから、StrComp 関数の比較に使用することが検討できます。</p><p>StrConv 関数<br><a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/strconv-function" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/strconv-function</a></p><p>&lt;回避案 b サンプル コード&gt;</p><p>以下の例では、比較する文字列を両方とも全角カナに変換しています。</p><pre><code>Sub Sample()    str1 = &quot;サンプル&quot;    str2 = &quot;ｻﾝﾌﾟﾙ&quot;    MsgBox StrComp(StrConv(str1, vbWide), StrConv(str2, vbWide), vbTextCompare)End Sub</code></pre><p>基本的には、上記の a. / b. いずれかの方法での対応を強く推奨します。</p><p>ただ、ファイルや VBA の変更が難しい場合などには、クライアントの環境設定による以下の回避策もあります。いずれも、Office の他の動作や、OS 全体に影響を及ぼす設定となるため、以下 c. / d. 案を利用する場合は、影響に十分にご留意ください。  </p><p><strong>c. Office</strong> <strong>モジュールを互換モードに設定する</strong></p><p>Office アプリケーションの実行モジュールを互換モードで動作するよう設定すると、古い NLS バージョンを使用するため現象が発生しません。</p><p>主な Office アプリケーションの実行モジュール名は以下になります。</p><p>Excel : EXCEL.EXE<br>Word : WINWORD.EXE<br>PowerPoint : POWERPNT.EXE<br>Access : MSACCESS.EXE</p><p>互換モードに変更したアプリケーションでの全ての動作が互換モードになるため、Windows 10 OS で新たにサポートされた機能を前提とした機能が動作しなくなるなどの影響が生じる場合があります。(例 : Excel の [オプション] – [全般] にある “複数ディスプレイを使用する場合” で [表示を優先した最適化] を選択することができなくなります)  </p><p><strong>d. レジストリを使用して NLS バージョンを以前のバージョン (6.2) に変更する</strong></p><p>システム全体で影響を受けるため、Office 以外のアプリケーションも以前の NLS バージョンを使用するようになります。アプリケーションの実装やビジネスロジックによっては、ソートの整合が崩れたり、データが不正となる可能性があります。</p><p>c. / d. の具体的な設定方法や注意点については、既に公開された Access フォームの現象をご案内する以下のフォーラム記事で説明していますので、こちらを参照してください。</p><p>Windows 10 バージョン 2004 (20H1) / 20H2 上で 半角カナのフォームを含んだ Access ファイルでエラーが発生する<br><a href="https://social.msdn.microsoft.com/Forums/ja-JP/4e6223e2-34d0-4a5f-bb61-109bc28040b6" target="_blank" rel="noopener">https://social.msdn.microsoft.com/Forums/ja-JP/4e6223e2-34d0-4a5f-bb61-109bc28040b6</a></p><p>※ 参照箇所<br>c 案 : 3-1. Access アプリケーション観点 - Access の EXE (MSACCESS.EXE) について、”Windows 8” の互換設定を行う<br>d 案 : 3-3. OS 観点 – Windows OS の NLS バージョンを 6.3 から 6.2 に変更する  </p><h4 id="4-その他の発生シナリオ"><a href="#4-その他の発生シナリオ" class="headerlink" title="4. その他の発生シナリオ"></a><strong>4. その他の発生シナリオ</strong></h4><p>ここまで、一般に利用頻度の比較的高い StrComp() での発生シナリオを中心に説明してきましたが、内部的に文字の比較を行う以下の機能でも同様の問題による現象が発生します。  </p><p>・Range.Find() / Range.FindNext() / Range.FindPrevious() メソッドによる検索や Range.Replace() メソッドによる置換で、濁点・半濁点を含む半角カナと全角カナが一致判定されません。<br>※ 手動での検索や置換も同様です。</p><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;2020/11/24 Update&lt;/strong&gt;&lt;br&gt;「4. その他の発生シナリオ」セクションを追加し、Excel での検索・置換 (Find / Replace) での発生を追記しました。  &lt;/p&gt;
&lt;p&gt;こんにちは、Office サポート チーム
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Office 展開ツール (16.0.12827.20268) で RemoveMSI 属性を使用すると 30041-1039-30050-1039 等のエラーメッセージが表示される</title>
    <link href="https://officesupportjp.github.io/blog/Office%20%E5%B1%95%E9%96%8B%E3%83%84%E3%83%BC%E3%83%AB%20(16.0.12827.20268)%20%E3%81%A7%20RemoveMSI%20%E5%B1%9E%E6%80%A7%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%81%A8%2030041-1039-30050-1039%20%E7%AD%89%E3%81%AE%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%81%8C%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B/"/>
    <id>https://officesupportjp.github.io/blog/Office%20%E5%B1%95%E9%96%8B%E3%83%84%E3%83%BC%E3%83%AB%20(16.0.12827.20268)%20%E3%81%A7%20RemoveMSI%20%E5%B1%9E%E6%80%A7%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%81%A8%2030041-1039-30050-1039%20%E7%AD%89%E3%81%AE%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%81%8C%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B/</id>
    <published>2020-10-29T15:00:00.000Z</published>
    <updated>2021-08-08T01:55:23.764Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。</p><p>表題の件について、既知の事象が報告されておりますのでご案内いたします。</p><p><strong>【事象】</strong>  </p><p>Office 展開ツール (16.0.12827.20268) で 30041-1039 や 30050-1039 のエラーメッセージが表示される</p><p><strong>【説明】</strong>  </p><p>本事象は 2020/6/9 にリリースされた Office 展開ツール (Version 16.0.12827.20268) に起因した事象である可能性がございます。</p><p>当該バージョンの Office 展開ツールでは、RemoveMSI 属性 で Office 2007 製品もアンインストールが可能となりましたが、<br>バージョン番号が “12” から始まる一部の MSI インストール形式の製品がインストールされている環境で、アンインストールが失敗しエラーとなる事象が発生しております。</p><p>本事象は、最新の Office 展開ツールで改善されておりますので、最新の Office 展開ツールをご利用いただきますようお願いいたします。</p><p>Title : Release history for Office Deployment Tool<br>URL : <a href="https://docs.microsoft.com/en-us/officeupdates/odt-release-history" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/officeupdates/odt-release-history</a><br>-—————抜粋開始—————-  </p><p>October 29, 2020<br>Version 16.0.13328.20292 (setup.exe version 16.0.13328.20290)<br>• Resolves an issue where certain Office 2007 products may unexpectedly block installation when using RemoveMSI  </p><p>-—————抜粋終了—————-  </p><p>Title : Office Deployment Tool<br>URL : <a href="https://www.microsoft.com/en-us/download/details.aspx?id=49117" target="_blank" rel="noopener">https://www.microsoft.com/en-us/download/details.aspx?id=49117</a>  </p><p><del>本不具合については、リリース時期はまだ未定ですが、次期バージョンの ODT で修正される見込みとなっております</del></p><p><del><strong>【回避策】</strong></del>  </p><p><del>以下の何れかの回避策をご実施いただけますようお願いいたします。</del></p><p><del>・Office 2007 製品をコントロールパネルからアンインストールするか、以下の資料の OffScrub07.vbs により Office 2007 製品をアンインストールしてください。</del>  </p><p><del><a href="https://github.com/OfficeDev/Office-IT-Pro-Deployment-Scripts/tree/master/Office-ProPlus-Deployment/Remove-PreviousOfficeInstalls" target="_blank" rel="noopener">https://github.com/OfficeDev/Office-IT-Pro-Deployment-Scripts/tree/master/Office-ProPlus-Deployment/Remove-PreviousOfficeInstalls</a></del>  </p><p><del>・RemoveMSI 属性を削除してください</del></p><p><del><strong>【参考】</strong></del>  </p><p><del>Release history for Office Deployment Tool</del></p><p><del><a href="https://docs.microsoft.com/en-us/officeupdates/odt-release-history" target="_blank" rel="noopener"></a><a href="https://docs.microsoft.com/en-us/officeupdates/odt-release-history" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/officeupdates/odt-release-history</a></del>  </p><p><strong>2020/10/15 :</strong> <strong>回避策について説明を追記しました。</strong></p><p><strong>2020/10/30 :</strong> <strong>回避策について対応バージョンを変更しました。</strong></p><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。&lt;/p&gt;
&lt;p&gt;表題の件について、既知の事象が報告されておりますのでご案内いたします。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;【事象】&lt;/strong&gt;  &lt;/p&gt;
&lt;p&gt;Office 展開ツール (16.0.12827.20
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>VDI 環境における Microsoft 365 Apps のライセンス認証について</title>
    <link href="https://officesupportjp.github.io/blog/VDI%20%E7%92%B0%E5%A2%83%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%20Microsoft%20365%20Apps%20%E3%81%AE%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E8%AA%8D%E8%A8%BC%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/VDI%20%E7%92%B0%E5%A2%83%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%20Microsoft%20365%20Apps%20%E3%81%AE%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E8%AA%8D%E8%A8%BC%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2020-10-27T15:00:00.000Z</published>
    <updated>2021-08-08T01:28:00.012Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。</p><p>今回の投稿では、VDI 環境における M365Apps のライセンス認証についてご案内します。</p><p>お問い合わせいただく中では、共有 VDI 上に M365Apps をインストールしたいというご要望をいただくことがあります。</p><p>共有 VDI では、ユーザーが不特定の端末にログオンする場合があるため、M365Apps の 5 台の制限にかかってしまいます。</p><p>この場合、M365Apps では以下の共有コンピュータライセンス認証のソリューションが用意されています。</p><p>Microsoft 365 Apps に対する共有コンピューターのライセンス認証の概要</p><p><a href="https://docs.microsoft.com/ja-jp/deployoffice/overview-shared-computer-activation" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/deployoffice/overview-shared-computer-activation</a></p><p>記載の通り、共有コンピューターのライセンス認証を利用して M365Apps を使用する場合、この台数制限の対象にはなりません。 </p><p>ただし、以下の注意点がありますので、ご参考にしてください。</p><ul><li><p>常にインターネット接続ができる環境で使用すること<br>以下のエンドポイントに接続できる必要があります。  </p><p>Office 365 URL および IP アドレス範囲<br><a href="https://docs.microsoft.com/ja-jp/microsoft-365/enterprise/urls-and-ip-address-ranges?view=o365-worldwide" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/microsoft-365/enterprise/urls-and-ip-address-ranges?view=o365-worldwide  </a>  </p></li><li><p>“ライセンス認証の制限” について<br>記事内の本項目は、基本的に悪意のあるシステム等に断続的にライセンス認証を行われた場合を想定しています。<br>通常、一般的なご利用の範囲で、本エラーに遭遇することはございません。  </p></li></ul><ul><li><p>シングルサインオン環境が必須であること<br>記事内では “ライセンス トークンの移動” について触れられていますが、”ライセンストークンの移動” を実施しても、次回 OS にログオンし M365Apps を起動すると、アカウント画面に警告が表示されたり、サインイン画面が表示されたりします。  </p><p>M365Apps では、ライセンストークンと O365 サービスへの接続情報を分けて %localappdata% 配下に保持しています。<br>ライセンストークンをローミング対象にすることはできますが、O365 サービスへの接続情報をローミング対象にすることはできません。<br>共有 VDI 環境でログオフ時に %localappdata% が失われる構成の場合、O365 サービスへの接続情報が失われるため、次回 OS にログオンし M365Apps を起動すると、アカウント画面に警告が表示されたり、サインイン画面が表示されたりするため、シングルサインオンが必須となります。<br>なお、移動ユーザー プロファイル等で %localappdata% をローミング対象とするのは非推奨となりますが、ご利用の環境において失われない方法があるかはご利用されている製品観点でご確認ください。  </p><p>シングルサインオンについては、ADFS やシームレスシングルサインオンを使用したユーザ対話がなくサインインできる方式をご検討ください。<br>Azure Active Directory シームレス シングル サインオンとは<br><a href="https://docs.microsoft.com/ja-jp/azure/active-directory/hybrid/how-to-connect-sso" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/azure/active-directory/hybrid/how-to-connect-sso</a></p></li><li><p>デバイス登録の無効化について<br>Microsoft 365 Apps でサインインをする際、以下の画面が表示される場合があります。  </p><p><img src="image1.png" alt=""><br>チェック オンに設定すると、Intune のライセンスを保有しており Windows の自動登録が可能な場合、Intune および Azure AD にデバイス登録が行われ、[職場または学校にアクセスする]にアカウントが追加されます。<br>チェックをオフとすると、Azure AD にデバイス登録が行われ、[職場または学校にアクセスする]にアカウントが追加されます。<br>“このアプリのみ” をクリックすると、認証情報は Office でのみ管理されます。[職場または学校にアクセスする]にアカウントは追加されません。  </p><p>そのため、デバイス登録が不要であれば、Windows 10 Ver 1803 (KB4489894 適用済) 以降の OS においては以下のレジストリを設定していただくと、この画面は表示されず “このアプリのみ” をクリックした際と同等の動作となります。<br><a href="https://docs.microsoft.com/ja-jp/azure/active-directory/devices/hybrid-azuread-join-plan" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/azure/active-directory/devices/hybrid-azuread-join-plan</a><br>-—– 抜粋開始 —–<br>次のレジストリ値を HKLM\SOFTWARE\Policies\Microsoft\Windows\WorkplaceJoin に追加すると、ドメイン参加済みデバイスが Azure AD 登録済みになることを防ぐことができます:”BlockAADWorkplaceJoin”=dword:00000001。<br>-—– 抜粋終了 —–</p></li></ul><p>今回の投稿は以上です。</p><p><strong>2020/10/16 : デバイス登録の無効化について説明を追記しました。</strong></p><p><strong>2020/10/28 : デバイス登録の無効化について、および、シングルサインオンが必須の理由の説明を変更しました。</strong></p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。&lt;/p&gt;
&lt;p&gt;今回の投稿では、VDI 環境における M365Apps のライセンス認証についてご案内します。&lt;/p&gt;
&lt;p&gt;お問い合わせいただく中では、共有 VDI 上に M365Apps をインストールしたいという
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>モバイル版の Office のトラブルシューティングについて</title>
    <link href="https://officesupportjp.github.io/blog/%E3%83%A2%E3%83%90%E3%82%A4%E3%83%AB%E7%89%88%E3%81%AE%20Office%20%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/%E3%83%A2%E3%83%90%E3%82%A4%E3%83%AB%E7%89%88%E3%81%AE%20Office%20%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2020-10-01T15:00:00.000Z</published>
    <updated>2021-08-08T01:31:28.076Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。  </p><p>今回の投稿では、モバイル版の Office のトラブルシューティングについてご案内します。</p><p>Android や iOS で Office アプリケーションにおいて、以下のようなお問い合わせをいただくことがあります。</p><p>・サインインができない</p><p>・ファイルが開けない</p><p>この場合、以下の手順でリセットすることで、事象が解消する可能性があります。</p><p><strong>iOS の場合</strong><br>1. iOS の [設定]-[&lt;Office もしくは アプリ名&gt;] をタップします。<br>2. [&lt;Office もしくは アプリ名&gt;] をタップし、[ログイン資格情報の削除] 等のトグルを有効にします。<br>3. アプリケーションを再起動します。  </p><p><strong>android の場合</strong><br>1. android の [設定]- [アカウント] - “Office” をタップします。<br>2. [アカウントを削除] を行います</p><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。  &lt;/p&gt;
&lt;p&gt;今回の投稿では、モバイル版の Office のトラブルシューティングについてご案内します。&lt;/p&gt;
&lt;p&gt;Android や iOS で Office アプリケーションにおいて、以下のようなお問い合
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Windows 10 バージョン 2004 (20H1) - 20H2 上で 半角カナのフォームを含んだ Access ファイルでエラーが発生する</title>
    <link href="https://officesupportjp.github.io/blog/Windows%2010%20%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%202004%20(20H1)%20-%2020H2%20%E4%B8%8A%E3%81%A7%20%E5%8D%8A%E8%A7%92%E3%82%AB%E3%83%8A%E3%81%AE%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0%E3%82%92%E5%90%AB%E3%82%93%E3%81%A0%20Access%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%8C%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B/"/>
    <id>https://officesupportjp.github.io/blog/Windows%2010%20%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%202004%20(20H1)%20-%2020H2%20%E4%B8%8A%E3%81%A7%20%E5%8D%8A%E8%A7%92%E3%82%AB%E3%83%8A%E3%81%AE%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0%E3%82%92%E5%90%AB%E3%82%93%E3%81%A0%20Access%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%8C%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B/</id>
    <published>2020-08-23T15:00:00.000Z</published>
    <updated>2021-08-08T02:14:13.157Z</updated>
    
    <content type="html"><![CDATA[<p>※2020/10/28 OS 観点での回避方法 (3-3) を追加しました。</p><p>※2021/06/03 OS 21H1 も本現象の発生対象バージョンであることを追加しました。</p><p>こんにちは、Office サポート チームの佐村です。</p><p>今回の記事では、Windows 10 バージョン 2004 上で半角カナ + カナに濁音 / 半濁音を含んでいる Access ファイルを開くとエラーが発生する状況について説明します。</p><p>(Access のバージョンに依存性はなく Windows 10 バージョン 2004 / 20H2 /21H1 上での Access アプリケーションで発生します。)</p><p><strong>1.</strong> <strong>現象</strong></p><p>Windows 10 バージョン 2004 上で Access ファイルを開いた時、VBA を実行しようとしたとき、VBA プロジェクトを開こうとしたとき等に以下のようなエラーが発生する可能性があります。</p><p>・フォーム名 ‘半角カナを含んだフォーム名’ が正しくないか、存在しないフォームを参照しています。</p><p><img src="image1.png" alt=""></p><p>・データベースに含まれている VBA プロジェクトを読み取れないため、データベースを開くことができません。</p><p> <img src="image2.png" alt=""></p><p>「データベースに含まれている VBA プロジェクトを～」のエラーダイアログで「OK」ボタンをクリックするとファイルに保存されている VBA プロジェクトが全て削除され、Access ファイルは操作の都度保存されるため VBA プロジェクトが削除された状態でファイルが自動保存されてしまい、コードが消失して復元ができなくなる可能性があります。</p><p>また、フォームとの不整合状態が保持されることで以前の OS 上の Access で該当のファイルを開いても VBA が正しく参照できないといった問題が発生します。</p><p>この動作が生じる条件は以下になります。 </p><p><strong>問題発生条件</strong></p><p>・Windows 10 OS バージョン 2004 または 20H2 / 21H1 である。</p><p>・Access ファイル内のフォーム名に半角カタカナを利用して濁音、半濁音のいずれかが含まれている。</p><p>この条件を満たす場合、フォームに紐づく VBA プロジェクトが存在している場合や、半角カナのサブフォームを指定する際に全角で指定していると上記であげたエラーが発生します。</p><p><strong>2.</strong> <strong>原因の説明</strong></p><p>Access アプリケーションでは、フォーム名に関して OS で用意している機能を利用し、半角と全角とを区別せずに比較しています。</p><p>そのため、以前の OS では “ガ” と “ガ” のような全角 / 半角は同じ文字列として判定されていましたが、Windows 10 バージョン 2004 / 20H2 /21H1 では OS の自然言語処理を担う NLS (National Language Support) バージョンが更新 (6.3) され異なる文字列として判定されてしまいます。</p><p>これによって内部管理上同じとみなされることが期待されるフォームが異なるものとして認識されるためにエラーが発生します。</p><p><strong>3.</strong> <strong>対応方法</strong></p><p>本問題について確認し、修正方法を検討いたしましたが、更新プログラム等で現在のバージョンに対する更新は仕様上出来ないことを確認いたしました。</p><p>自然言語処理を担う NLS の定義に基づいて発生している問題となりますが、NLS の性質上、既存のモジュールと修正されたモジュールがネットワークシステム上で混在すると解決の難しい不整合が生じる可能性があり、そのような状況を避けるため一度リリースされたバージョンの内容を修正することができません。</p><p>このため、問題があった場合には新しいバージョンの NLS を開発して新しい OS とともにリリースする必要があります。</p><p>つまり、既にリリース済のバージョン 2004 および 20H2 / 21H1 において既存のバージョンのまま問題を回避することは機能仕様上出来ず、2021年後半以降の Windows 10 OS にて本問題を修正したバージョンがリリースされます。</p><p>これらのことから、バージョン 2004 および 20H2 /21H1 においては、利用者様にて問題が発生しないように対応をしていただく必要があります。</p><p><strong>3-1. Access</strong> <strong>アプリケーション観点 - Access の EXE (MSACCESS.EXE) について、”Windows 8” の互換設定を行う</strong></p><p>エクスプローラーで MSACCESS.EXE までを展開し、MSACCESS.EXE のプロパティから互換モードで動作するように変更します。</p><p><img src="image3.png" alt=""></p><p>※OfficeNN バージョン番号</p><p>Office16 : Microsoft 365 Apps (Office 365 ProPlus) / Office 2019 / Office 2016</p><p>Office15 : Office 2013</p><p>Office14 : Office 2010</p><p>-ご参考</p><p>タイトル : クイック実行形式 (C2R) と Windows インストーラー形式 (MSI) を見分ける方法</p><p>URL : <a href="https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fsocial.msdn.microsoft.com%2FForums%2Fja-JP%2F57e5d81e-ef69-4c1f-9ef0-932d03d0e7ce%2F1246312452124831246323455348922441824335-c2r-12392-windows&data=02%7C01%7Cmasamura%40microsoft.com%7C3ad5c5de6c1348d728f508d847f6a5de%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637338471963470942&sdata=td%2FgO%2BMeA2HHyTyR%2FW%2FbrJHzTmnVb2Anp2JvIW9mQ6Y%3D&reserved=0" target="_blank" rel="noopener">https://social.msdn.microsoft.com/Forums/ja-JP/57e5d81e-ef69-4c1f-9ef0-932d03d0e7ce/1246312452124831246323455348922441824335-c2r-12392-windows</a></p><p>&lt;設定変更方法 (C2R版 Office の場合)&gt;</p><p>-———————–</p><p>・エクスプローラー上から、MSACCESS.EXE を右クリックし、「プロパティ」を選択します。</p><p>・MSACCESS.EXE のプロパティ画面で「互換性」タブを選択します。</p><p>・「互換モードでこのプログラムを実行する」のチェックを ON にしてターゲットとして Windows 8 が選択されていることを確認します。</p><p>・「OK」ボタンをクリックします。</p><p>※元の設定に戻す場合は「互換モードでこのプログラムを実行する」のチェックを OFF にします</p><p>-———————–<br><br /></p><p>&lt;設定変更方法 (MSI版 Office の場合)&gt;</p><p>-———————–</p><p>・エクスプローラー上から、MSACCESS.EXE を右クリックし、「互換性のトラブルシューティング」を選択します。</p><p>・「推奨設定を使用する」を選択する。</p><p>・Windows 互換モード : Windows 8 となっていることを確認し「プログラムのテスト」ボタンをクリックします。</p><p>・Access アプリケーションが起動したら×ボタンで閉じて「次へ」ボタンをクリックします。</p><p>・「はい、このプログラムのこの設定を保存します」を選択します。</p><p>・「閉じる」ボタンでトラブルシューティングツールを閉じます。</p><p>※元の設定に戻す場合は以下のレジストリ配下の MSACCESS への設定を削除します。</p><p>HKCU\Software\Microsoft\Windows NT\CurrentVersion\AppCompactFlags\Layers</p><p>-———————–</p><p>なお、Access をはじめ Office アプリケーションは互換性を変更した検証は実施しておらず、</p><p>互換性を変更して動作させた場合に、予期しない動作が発生することがございます。</p><p><strong>3-2. Access</strong> <strong>ファイル観点 - Access のフォームで半角カタカナを全角カタカナに変更する</strong></p><p>Windows 10 の OS 1909 等、以前の問題が発生しない OS バージョンでフォーム等の半角カタカナを全角カタカナに統一します。</p><p>VBA コードに半角カナでフォームを指定している場合等、半角カタカナのフォームを参照している処理は全角カナに修正する必要があります。</p><p> <strong>3-3. OS</strong> <strong>観点 – Windows OS の NLS バージョンを 6.3 から 6.2 に変更する</strong></p><p>問題の発生しない NLS バージョン 6.2 (以前の OS で利用されていたバージョン) を利用することで本問題は発生しません。レジストリを変更して対処する必要があります。</p><p>&lt;レジストリ NLS\Version の値の変更手順&gt;</p><p>- 以前の NLS バージョンに戻す場合 (Access のエラーを回避する)</p><p>キー : [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\Sorting\Versions]</p><p>名前 : 既定</p><p>値 : 0006020F</p><p>コマンド) REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Nls\Sorting\Versions /ve /d 0006020F /f</p><p>※管理者として起動したコマンドプロンプトで実行ください。</p><p>- バージョン 2004 / 20H2 の既定値 (Access のエラーが発生) に戻す場合</p><p>コマンド) REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Nls\Sorting\Versions /ve /d 00060305 /f</p><p>注意点</p><p>本レジストリの変更で NLS バージョンを 6.2 に変更した OS についても弊社にてサポートいたします。</p><p>しかしながら、アプリケーションの実装やビジネスロジックによっては、ソートの整合が崩れたり、データが不正となる可能性がありますので、何か問題が発生してお問い合わせいただく場合には、NLS バージョンを 6.2 に変更して運用していることを随時担当エンジニアにお知らせくださいますようお願いいたします。</p><p>また、NLS バージョン 6.3 では合字データ (㋿ や ㍻) のソート順を変更していますので、合字を利用する場合にこのソート順が</p><p>変わります (Windows 10 バージョン 1909 と同じになる) ことも合わせてご了承ください。</p><p>バージョン 6.2 昇順 : ㋿ ㍻ ㍾ ㍼</p><p>バージョン 6.3 昇順 : ㍾ ㍼ ㍻ ㋿</p><p>ユーザーや管理者による対処不要で、更新プログラム適用等で対処ができず申し訳ありませんが、</p><p>問題によって NLS バージョンの値を変更するか、MSACCESS.EXE の互換モードを下げるという</p><p>対処が必要となりますことご了承くださいますようお願いいたします。  </p><p><strong>補足</strong></p><p>一度エラーが発生した Access ファイルは不整合の内容を保持しているため、上記対応方法を実施後もエラーが発生する可能性がございます。その場合、バックアップファイルから戻すといった修正が必要になります。</p><p>今後の方針や追加の回避方法等が分かり次第本資料を更新します。</p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;※2020/10/28 OS 観点での回避方法 (3-3) を追加しました。&lt;/p&gt;
&lt;p&gt;※2021/06/03 OS 21H1 も本現象の発生対象バージョンであることを追加しました。&lt;/p&gt;
&lt;p&gt;こんにちは、Office サポート チームの佐村です。&lt;/p&gt;
&lt;p&gt;今
      
    
    </summary>
    
    
    
  </entry>
  
</feed>
