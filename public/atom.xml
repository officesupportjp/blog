<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan Office Client Support Blog</title>
  
  <subtitle>日本マイクロソフト Office Client サポート チームのブログです</subtitle>
  <link href="/blog/atom.xml" rel="self"/>
  
  <link href="https://officesupportjp.github.io/blog/"/>
  <updated>2022-02-17T01:55:53.391Z</updated>
  <id>https://officesupportjp.github.io/blog/</id>
  
  <author>
    <name>Office Support Japan</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Office ファイルの SPO &amp; OneDrive 移行におけるマクロ (VBA) 影響</title>
    <link href="https://officesupportjp.github.io/blog/Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%20SPO%20&amp;%20OneDrive%20%E7%A7%BB%E8%A1%8C%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%83%9E%E3%82%AF%E3%83%AD%20(VBA)%20%E5%BD%B1%E9%9F%BF/"/>
    <id>https://officesupportjp.github.io/blog/Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%20SPO%20&amp;%20OneDrive%20%E7%A7%BB%E8%A1%8C%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%83%9E%E3%82%AF%E3%83%AD%20(VBA)%20%E5%BD%B1%E9%9F%BF/</id>
    <published>2022-02-16T15:00:00.000Z</published>
    <updated>2022-02-17T01:55:53.391Z</updated>
    
    <content type="html"><![CDATA[<br>こんにちは、Office サポート チームの中村です。<br>  Office ファイルの保存場所として、ファイル サーバーの共有フォルダから、SharePoint Online のドキュメント ライブラリや 個人用 OneDrive / OneDrive for Business への移行を検討する企業も増えてきたかと思います。Office ファイルでは業務効率化のためマクロ (VBA) を利用されていることが多く、弊社サポートにも、マクロ ファイル自身やマクロ内で操作するファイルの保存場所がクラウドになることの影響を確認したい、というお問い合わせを時折頂きます。<p>今後、さらにクラウド活用が進むと想定されるため、今回の記事で、このようなシナリオで一般的に生じる影響と対応方法、考慮すべき点についてまとめたいと思います。<br><br></p><h2 id="1-クラウド移行で変化すること"><a href="#1-クラウド移行で変化すること" class="headerlink" title="1. クラウド移行で変化すること"></a><strong>1. クラウド移行で変化すること</strong></h2><p>ファイルの格納場所を変更したとき、マクロに影響を与える要素は主に以下の 2 点です。</p><p>・フォルダやファイルのパスが UNC 共有パス形式 (\\Server\folder) から URL 形式 (http://tenantname.sharepoint.com/xxxx など) に変わる<br>・SharePoint や OneDrive によってアクセス権が管理される<br><br></p><h2 id="2-ファイル-パス変更の影響"><a href="#2-ファイル-パス変更の影響" class="headerlink" title="2. ファイル パス変更の影響"></a><strong>2. ファイル パス変更の影響</strong></h2><p>マクロからファイルやフォルダを操作するときに使用する関数によっては、URL 形式に対応していません。このような関数を利用している場合は、マクロ処理の見直しが必要です。以下に、マクロで主に使用されるファイル操作関数の URL 形式対応状況を記載します。<br><br></p><h3 id="Excel-Word-PowerPoint-のライブラリ"><a href="#Excel-Word-PowerPoint-のライブラリ" class="headerlink" title="Excel / Word / PowerPoint のライブラリ"></a><strong>Excel / Word / PowerPoint のライブラリ</strong></h3><p>これらのアプリ用のライブラリ Microsoft xxx 16.0 Object Library (xxx は各種アプリ名) で提供されるファイル操作メソッドやプロパティは、Web 上のファイルを直接読み書きすることを想定しているため、基本的に URL 形式を扱うことができます。これらのメソッド・プロパティを利用している場合は、特に対応の必要はありません。<br>例) Excel の Workbooks.Open や Workbook.Path<br>※ Access ファイルは Web から直接開くことができず、ダウンロードしてから開くため URL 形式を扱うことは想定されません。<br><br></p><p><strong>補足情報</strong><br>エクスプローラーで、OneDrive や SharePoint ライブラリの同期フォルダからファイルを開く場合、以前の Office バージョンでは、ThisWorkbook.Path などで開いたファイルのパスを取得すると、同期フォルダのローカル パスが返されました。<br>Microsoft 365 の最新チャネル バージョン 1903 および半期チャネル バージョン 2008 以降は、この操作シナリオでも、サーバー側の URL パスが返るようになりました。<br>古い Office バージョンを利用する場合は、取得されるパスが異なることに注意してください。<br><br></p><h3 id="VBA-関数"><a href="#VBA-関数" class="headerlink" title="VBA 関数"></a><strong>VBA 関数</strong></h3><p>Dir や Open といった VBA 関数は、URL 形式に対応していません。以下に、ファイル操作に関わる主な VBA 関数がまとめられていますが、ここに記載されている関数を利用している場合、他の仕組みへの変更を検討してください。</p><p>Directories and files keyword summary<br><a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/directories-and-files-keyword-summary" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/directories-and-files-keyword-summary</a><br>Input and output keyword summary<br><a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/input-and-output-keyword-summary" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/input-and-output-keyword-summary</a><br><br></p><h3 id="FileSystemObject-ライブラリ"><a href="#FileSystemObject-ライブラリ" class="headerlink" title="FileSystemObject ライブラリ"></a><strong>FileSystemObject ライブラリ</strong></h3><p>Scripting.FileSystemObject ライブラリで提供される各種メソッドは、URL 形式に対応していません。以下の公開情報で Scripting.FileSystemObject ライブラリで提供されるファイル・フォルダ操作メソッドがまとめられています。これらを利用している場合は、他の仕組みへの変更を検討してください。</p><p>FileSystemObject object<br><a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/filesystemobject-object" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/filesystemobject-object</a><br>File object<br><a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/file-object" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/file-object</a><br>Folder object<br><a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/folder-object" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/folder-object</a><br><br></p><h3 id="補足-その他、独自にパスを解析・組み立てる処理"><a href="#補足-その他、独自にパスを解析・組み立てる処理" class="headerlink" title="補足) その他、独自にパスを解析・組み立てる処理"></a><strong>補足) その他、独自にパスを解析・組み立てる処理</strong></h3><p>マクロの独自処理として、例えばマクロ ファイル自身の格納フォルダ パスの一部を加工して処理結果ファイルの出力パスを組み立てるなど、パスのテキストを意識した処理がある場合は注意が必要です。URL 形式への変更に伴い、既存の文字列操作処理では、期待する結果が得られない場合があります。<br><br></p><h2 id="3-影響を受ける場合の対処方法"><a href="#3-影響を受ける場合の対処方法" class="headerlink" title="3. 影響を受ける場合の対処方法"></a><strong>3. 影響を受ける場合の対処方法</strong></h2><p>一般的には、以下のような対処方法が検討できます。実際の処理内容や環境構成、対応にかけられる工数などを考慮して対処方法をご検討ください。<br><br></p><h3 id="a-Office-ライブラリを用いて操作する"><a href="#a-Office-ライブラリを用いて操作する" class="headerlink" title="a. Office ライブラリを用いて操作する"></a><strong>a. Office ライブラリを用いて操作する</strong></h3><p>先述の通り、Microsoft xxx 16.0 Object Library で提供されるメソッド・プロパティは基本的に URL 形式を扱うことができます。そして、Word や Excel は、テキスト ファイルを扱うこともできます。現在 VBA 関数や FileSystemObject でテキスト ファイルを操作している場合には、これを Word や Excel アプリで Microsoft xxx 16.0 Object Library を用いて扱うよう変更することが検討できます。<br><br></p><h3 id="b-不要なファイル・フォルダ操作を止める"><a href="#b-不要なファイル・フォルダ操作を止める" class="headerlink" title="b. 不要なファイル・フォルダ操作を止める"></a><strong>b. 不要なファイル・フォルダ操作を止める</strong></h3><p>例えば、次回利用時に引き継ぎたい内容を動的に保持する設定ファイルを別ファイルとして用意し、これを読み書きするために対応していない関数を使っている、というシナリオを考えます。このような場合、これをマクロ ファイル自身のどこかに保持する (Excel の非表示シート、Word の隠し文字、ファイルのユーザー設定プロパティ等) ことで、他のファイルへの読み書きを行わないようにする、といった対応もマクロの内容次第では検討できます。<br><br></p><h3 id="c-Graph-API-に変更する-ファイル操作と-Excel-操作が対応"><a href="#c-Graph-API-に変更する-ファイル操作と-Excel-操作が対応" class="headerlink" title="c. Graph API に変更する (ファイル操作と Excel 操作が対応)"></a><strong>c. Graph API に変更する (ファイル操作と Excel 操作が対応)</strong></h3><p>SharePoint Online や OneDrive に対し、HTTP リクエスト ベースで操作する API として Graph API が提供されています。現在、SharePoint ライブラリや OneDrive のフォルダ・ファイル自体の操作 (作成やコピー、削除など) と、Excel ファイルの操作用 API が利用できます。ただし、プログラムの実装イメージがマクロと大きく異なりますので、Graph API 自体の利用に習熟している開発者向けの代替案です。  </p><p>Microsoft Graph API を使用する<br><a href="https://docs.microsoft.com/ja-jp/graph/use-the-api" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/graph/use-the-api</a><br>Microsoft Graph REST API v1.0 リファレンス<br><a href="https://docs.microsoft.com/ja-jp/graph/api/overview" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/graph/api/overview</a>  </p><p>現時点では、マクロで可能な全ての操作が Graph API からも行えるものではありませんが、簡単な操作は可能です。ただし、一般的に、マクロから呼び出すことには適していません。一般的には、独立したアプリケーションを作成して HTTP リクエストを発行し、Web 上のファイルを操作します。また、Microsoft 365 サービスへの認証も考慮する必要があります。  </p><p><strong>参考資料</strong><br>(WebAPI)OAuth Bearer Token (Access Token) の取得方法について<br><a href="https://officesupportjp.github.io/blog/(WebAPI)OAuth%20Bearer%20Token%20(Access%20Token)%20%E3%81%AE%E5%8F%96%E5%BE%97%E6%96%B9%E6%B3%95%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">https://officesupportjp.github.io/blog/(WebAPI)OAuth Bearer Token (Access Token) の取得方法について</a><br>(WebAPI)Microsoft Graph を使用した開発に便利なツール群<br><a href="https://officesupportjp.github.io/blog/(WebAPI)Microsoft%20Graph%20%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E9%96%8B%E7%99%BA%E3%81%AB%E4%BE%BF%E5%88%A9%E3%81%AA%E3%83%84%E3%83%BC%E3%83%AB%E7%BE%A4">https://officesupportjp.github.io/blog/(WebAPI)Microsoft Graph を使用した開発に便利なツール群</a><br>(WebAPI)Microsoft Graph - OneDrive API (C Sharp) を使ったサンプル コード<br><a href="https://officesupportjp.github.io/blog/(WebAPI)Microsoft%20Graph%20-%20OneDrive%20API%20(C%20Sharp)%20%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%9F%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%20%E3%82%B3%E3%83%BC%E3%83%89">https://officesupportjp.github.io/blog/(WebAPI)Microsoft Graph - OneDrive API (C Sharp) を使ったサンプル コード</a><br>(WebAPI)Microsoft Graph – Excel REST API (C Sharp) を使い Range を操作するサンプル コード<br><a href="https://officesupportjp.github.io/blog/(WebAPI)Microsoft%20Graph%20%E2%80%93%20Excel%20REST%20API%20(C%20Sharp)%20%E3%82%92%E4%BD%BF%E3%81%84%20Range%20%E3%82%92%E6%93%8D%E4%BD%9C%E3%81%99%E3%82%8B%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%20%E3%82%B3%E3%83%BC%E3%83%89">https://officesupportjp.github.io/blog/(WebAPI)Microsoft Graph – Excel REST API (C Sharp) を使い Range を操作するサンプル コード</a><br><br></p><h3 id="d-OneDrive-や-SharePoint-ライブラリの同期フォルダを操作する"><a href="#d-OneDrive-や-SharePoint-ライブラリの同期フォルダを操作する" class="headerlink" title="d. OneDrive や SharePoint ライブラリの同期フォルダを操作する"></a><strong>d. OneDrive や SharePoint ライブラリの同期フォルダを操作する</strong></h3><p>OneDrive 同期クライアントで、ファイル格納フォルダをクライアント コンピューターと同期すると、ローカルの同期フォルダにファイルがコピーされます。この同期フォルダに対してマクロから操作を行うと、通常のローカル パスとして扱うことができます。(なお、先述の通り、ThisWorkbook.Path の結果は最新の Microsoft 365 では URL 形式になり、同期フォルダのローカル パスではない点にご注意ください。)  </p><p>Windows の OneDrive とファイルを同期する<br><a href="https://support.microsoft.com/ja-jp/office/615391c4-2bd3-4aae-a42a-858262e42a49" target="_blank" rel="noopener">https://support.microsoft.com/ja-jp/office/615391c4-2bd3-4aae-a42a-858262e42a49</a>  </p><p>ただし、マクロから編集した内容がサーバー上へ同期されることは、マクロの動作としては保証されません。マクロからは、ローカルの同期フォルダへの操作が成功することをもって成功と判断されます。ネットワークの問題で同期に失敗したり、クラウド上のファイルに他のユーザーから競合する変更が行われて同期エラーが生じるなど、クラウド上にマクロの実行結果が期待通り反映されない可能性についての考慮が必要です。<br><br></p><h4 id="補足-WebDAV-パスでのアクセス"><a href="#補足-WebDAV-パスでのアクセス" class="headerlink" title="補足: WebDAV パスでのアクセス"></a><strong>補足: WebDAV パスでのアクセス</strong></h4><p>SharePoint ライブラリを Internet Explorer で開くと、[エクスプローラ―で開く] というメニューが使用でき、”\\SharePoint サイト\DavWWWRoot\Folder” のような UNC パスで、ライブラリが開かれていました。これは、WebDAV と呼ばれる Web フォルダを読み書き可能とする技術を用いて​実現されています。<br>以前は、このパスを用いてマクロからアクセスすることも検討できる方法の 1 つでした。<br>しかしながら、この仕組みはレガシな技術を用いており、Edge ブラウザでは対応していません。<br>また、WebDAV でのアクセスには別のサービス (WebClient サービス) が利用されるため、マクロが実行されている Office アプリの認証情報は引き継がれません。<br>WebClient サービス用の認証情報の保存にはまもなくサポートを終了する Internet Explorer を利用する必要があることなどからも、新たに WebDAV パスでの利用を検討することは推奨しません。<br><br></p><h2 id="4-Microsoft-365-サービスへの認証とアクセス権"><a href="#4-Microsoft-365-サービスへの認証とアクセス権" class="headerlink" title="4. Microsoft 365 サービスへの認証とアクセス権"></a><strong>4. Microsoft 365 サービスへの認証とアクセス権</strong></h2><p>対応方法のうち、引き続きマクロから Microsoft 365 サービス上のファイルへのアクセスを行う “a. Office ライブラリを用いて操作する” の場合、マクロが実行されている Office アプリケーションにサインインしているユーザーとして認証が行われます。このため、マクロ実行時の Office サインイン ユーザーに、マクロで操作するファイルへのアクセス権を付与する必要があります。<br><br></p><h2 id="5-サポートされる-Office-クライアント-アプリケーション"><a href="#5-サポートされる-Office-クライアント-アプリケーション" class="headerlink" title="5. サポートされる Office クライアント アプリケーション"></a><strong>5. サポートされる Office クライアント アプリケーション</strong></h2><p>マクロからの操作においても、Microsoft 365 サービスとの接続がサポートされる Office クライアント アプリケーションがサポート対象です。サポートされる製品は、以下の公開情報でご確認ください。</p><p>Office versions and connectivity to Microsoft 365 services<br><a href="https://docs.microsoft.com/en-us/deployoffice/endofsupport/microsoft-365-services-connectivity" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/deployoffice/endofsupport/microsoft-365-services-connectivity</a></p><p>今回の投稿は以上です。<br><br></p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;br&gt;
こんにちは、Office サポート チームの中村です。
&lt;br&gt;  
Office ファイルの保存場所として、ファイル サーバーの共有フォルダから、SharePoint Online のドキュメント ライブラリや 個人用 OneDrive / OneDrive for 
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>インターネットから入手した Office ファイルのマクロがブロックされる既定の動作変更について (MC322553)</title>
    <link href="https://officesupportjp.github.io/blog/%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%8D%E3%83%83%E3%83%88%E3%81%8B%E3%82%89%E5%85%A5%E6%89%8B%E3%81%97%E3%81%9F%20Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%83%9E%E3%82%AF%E3%83%AD%E3%81%8C%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%81%95%E3%82%8C%E3%82%8B%E6%97%A2%E5%AE%9A%E3%81%AE%E5%8B%95%E4%BD%9C%E5%A4%89%E6%9B%B4%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%20(MC322553)/"/>
    <id>https://officesupportjp.github.io/blog/%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%8D%E3%83%83%E3%83%88%E3%81%8B%E3%82%89%E5%85%A5%E6%89%8B%E3%81%97%E3%81%9F%20Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%83%9E%E3%82%AF%E3%83%AD%E3%81%8C%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%81%95%E3%82%8C%E3%82%8B%E6%97%A2%E5%AE%9A%E3%81%AE%E5%8B%95%E4%BD%9C%E5%A4%89%E6%9B%B4%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%20(MC322553)/</id>
    <published>2022-02-14T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:05.041Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームです。</p><p>本記事では、2022 年 4 月 より Microsoft 365 Apps への展開が開始されるインターネットから入手した Office ファイルのマクロがブロックされる既定の動作変更について説明します。この情報は、MC322553 で通知されているものです。</p><br><h1 id="【前提】"><a href="#【前提】" class="headerlink" title="【前提】"></a>【前提】</h1><p>今回のご説明は以下公開情報でご案内している内容となります。</p><p>タイトル : Macros from the internet will be blocked by default in Office<br>アドレス  : <a href="https://docs.microsoft.com/ja-jp/DeployOffice/security/internet-macros-blocked" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/DeployOffice/security/internet-macros-blocked</a> (日本語版 - 機械翻訳)<br>アドレス  : <a href="https://docs.microsoft.com/en-us/DeployOffice/security/internet-macros-blocked" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/DeployOffice/security/internet-macros-blocked</a> (英語版)  </p><p>また、以下のとおり、ブログ記事も公開されています。</p><p>タイトル : Helping users stay safe: Blocking internet macros by default in Office<br>アドレス  : <a href="https://techcommunity.microsoft.com/t5/microsoft-365-blog/helping-users-stay-safe-blocking-internet-macros-by-default-in/ba-p/3071805" target="_blank" rel="noopener">https://techcommunity.microsoft.com/t5/microsoft-365-blog/helping-users-stay-safe-blocking-internet-macros-by-default-in/ba-p/3071805</a> (英語版)</p><br><h1 id="【概要】"><a href="#【概要】" class="headerlink" title="【概要】"></a>【概要】</h1><p>上記公開情報で記載の概要は、Office のセキュリティ向上のため、 Office アプリケーションにてインターネットから入手した Office ファイルのマクロの実行をブロックするよう既定の動作を変更するという内容です。</p><p>これまでの Office では、インターネットから入手したファイルは保護ビューでは開かれますが、保護ビューを解除して編集モードにした後のマクロの実行可否の判断には、インターネットからの入手であることは考慮されず、他のセキュリティ設定でブロックされない限りはマクロを実行できました。今回の変更で、インターネットから入手したファイルは既定でマクロ実行がブロックされるようになります。</p><p>本変更はインターネットから入手したすべての Office ファイルが対象ではなく、特定の条件でマクロの有効 / 無効が決定されなかった場合にブロックされる動作となります。</p><p>つまり、この条件次第でインターネットから入手するファイルのマクロを今後も実行できるようになりますので、引き続きマクロを実行したい場合は、いずれかの先に判断される条件を利用してマクロを有効にできますので、本記事で詳しく紹介します。</p><p>なお、ここで言う「インターネットから入手したファイル」とは、Mark of the Web (MOTW) 属性と呼ばれる Windows によってインターネットからのファイル取得時に自動的に付与される Web マークが付与されたファイルを指します。<br>MOTW 属性が付与されていることは、ファイルのプロパティ画面で確認できます (後述の “Web マークを削除する方法” に実際の画面イメージを掲載します)。</p><br><h1 id="【本変更の対象範囲について】"><a href="#【本変更の対象範囲について】" class="headerlink" title="【本変更の対象範囲について】"></a>【本変更の対象範囲について】</h1><p>先の 公開情報 “この変更のOfficeのバージョン” に記載のとおり、本件の対象となる Office アプリケーションは Access / Excel / PowerPoint / Visio / Word です。</p><p>また、本変更の対象の Office は Windows デバイスにインストールされる以下となります。</p><ul><li>Microsoft 365 Apps 最新チャネル (プレビュー)</li><li>Microsoft 365 Apps 最新チャネル</li><li>Microsoft 365 Apps 月次エンタープライズ チャネル</li><li>Microsoft 365 Apps 半期エンタープライズ チャネル (プレビュー)</li><li>Microsoft 365 Apps 半期エンタープライズ チャネル</li><li>Office LTSC</li><li>Office 2021</li><li>Office 2019</li><li>Office 2016</li><li>Office 2013</li></ul><br><h1 id="【変更される既定の動作の詳細】"><a href="#【変更される既定の動作の詳細】" class="headerlink" title="【変更される既定の動作の詳細】"></a>【変更される既定の動作の詳細】</h1><p>今回の既定の動作の変更は、先の公開情報に記載の以下フローチャートにて <span style="color:#ff0000"><strong>赤枠で囲った 7 の状況</strong></span> となった場合に該当します。</p><p><img src="vba-macro-flowchart.png" alt=""></p><p>上記フローチャートにおいて今回の動作変更の影響を受ける条件は以下をすべて満たす場合となります。</p><ul><li>開かれるマクロ付きファイルにインターネットから入手されたことを意味する Web マークが付与されている (フローチャート 1 = START)</li><li>マクロ付きファイルが “信頼できる場所”  に保存されていない (フローチャート 2 = No)</li><li>マクロ付きファイルが デジタル署名されていない、またはデジタル署名されているが “信頼できる発行元” に登録されている証明書と署名が一致しない (フローチャート 3 = No)</li><li>クラウド ポリシー / グループ ポリシー等のポリシーにてマクロの有効 / 無効が設定されていない (フローチャート 4a,4b = No)</li><li>ユーザーが以前このファイルを開いていない、または以前このファイルを開いたが表示される通知にて [コンテンツを有効にする] を選択していない (フローチャート 6 = No)</li></ul><p>これらの条件すべてに合致した場合、以下のとおり動作が変更となります。</p><h3 id="変更前"><a href="#変更前" class="headerlink" title="変更前"></a>変更前</h3><p>以下のオプション設定に従ってマクロの有効 / 無効を決定します。</p><h4 id="lt-オプション設定-Excel-アプリケーションから確認する例-gt"><a href="#lt-オプション設定-Excel-アプリケーションから確認する例-gt" class="headerlink" title="&lt;オプション設定 (Excel アプリケーションから確認する例)&gt;"></a>&lt;オプション設定 (Excel アプリケーションから確認する例)&gt;</h4><p>[ファイル] タブ - [オプション] - [トラスト センター]- [トラスト センターの設定] - [マクロの設定] - [マクロの設定] の選択</p><p><img src="macro-settings.png" alt=""></p><p>なお、既定の設定である “警告して、VBA マクロを有効にする” の場合、以下が出力されます。</p><p><img src="vba-security-warning-banner.png" alt=""></p><h3 id="変更後"><a href="#変更後" class="headerlink" title="変更後"></a>変更後</h3><p>以下のメッセージが出力されマクロの実行がブロックされます。</p><p><img src="vba-security-risk-banner.png" alt=""></p><br><h1 id="【マクロを有効にする方法について】"><a href="#【マクロを有効にする方法について】" class="headerlink" title="【マクロを有効にする方法について】"></a>【マクロを有効にする方法について】</h1><p>上記の動作変更にて無効化されたマクロを有効にする方法を以下に説明します。</p><h2 id="1-ポリシーでマクロを有効にする方法"><a href="#1-ポリシーでマクロを有効にする方法" class="headerlink" title="1) ポリシーでマクロを有効にする方法"></a>1) ポリシーでマクロを有効にする方法</h2><p>Office 管理用テンプレートのグループ ポリシーなどを利用し以下を設定するとインターネットから入手した Office ファイルについてもマクロを有効にできます。</p><h4 id="lt-グループ-ポリシー設定-gt"><a href="#lt-グループ-ポリシー設定-gt" class="headerlink" title="&lt;グループ ポリシー設定&gt;"></a>&lt;グループ ポリシー設定&gt;</h4><ul><li>Access<br>[ユーザーの構成] - [ポリシー] - [管理用テンプレート]<br>- [Microsoft Access 2016] - [アプリケーション設定] -[セキュリティ] - [セキュリティ センター]<br>&nbsp;- [インターネットから取得した Office ファイル内のマクロの実行をブロックします] : 無効</li><li>Excel / PowerPoint / Visio / Word<br>[ユーザーの構成] - [ポリシー] - [管理用テンプレート]<br>- [Microsoft xxx 2016] - [xxx のオプション] - [セキュリティ] - [セキュリティ センター]<br>&nbsp;- [インターネットから取得した Office ファイル内のマクロの実行をブロックします] : 無効<br>注) xxx はそれぞれ Excel / PowerPoint / Visio / Word です。<br></li></ul><h2 id="2-特定のファイルでマクロを有効にする方法"><a href="#2-特定のファイルでマクロを有効にする方法" class="headerlink" title="2) 特定のファイルでマクロを有効にする方法"></a>2) 特定のファイルでマクロを有効にする方法</h2><p>特定のファイルでマクロを有効にする方法ついて、以下の “Web マークを削除する方法” 及び “信頼できる発行元のデジタル署名を追加する方法” があります。</p><h3 id="Web-マークを削除する方法"><a href="#Web-マークを削除する方法" class="headerlink" title="Web マークを削除する方法"></a>Web マークを削除する方法</h3><p>インターネットから入手したファイルには Web マークが付与されると先ほど述べましたが、この Web マークの実体はWindows OS で広く利用されている NTFS ファイルシステムの代替データストリーム（ADS：Alternate Data Stream）に保存されているゾーン識別子 (Zone.Identifier) です。</p><p>そのため、このゾーン識別子を削除すると、本動作変更の対象外となり、ローカルで作成したマクロ付きファイルと同様の動作となります。以下画面から削除する手順と PowerShell で削除する手順をそれぞれ記載します。</p><h4 id="lt-ゾーン識別子の削除手順-画面-gt"><a href="#lt-ゾーン識別子の削除手順-画面-gt" class="headerlink" title="&lt;ゾーン識別子の削除手順 (画面) &gt;"></a>&lt;ゾーン識別子の削除手順 (画面) &gt;</h4><ol><li>エクスプローラーから該当のマクロ付きファイルを右クリックし、[プロパティ]を表示します。</li><li>[全般] タブの最下部に以下画面のように [セキュリティ] が表示されている場合は、右側の [許可する] をチェックし、[OK] をクリックします。 </li></ol><p><img src="file-property-security.png" alt=""></p><h4 id="lt-ゾーン識別子の削除手順-PowerShell-コマンド-gt"><a href="#lt-ゾーン識別子の削除手順-PowerShell-コマンド-gt" class="headerlink" title="&lt;ゾーン識別子の削除手順 (PowerShell コマンド) &gt;"></a>&lt;ゾーン識別子の削除手順 (PowerShell コマンド) &gt;</h4><p>以下のコマンドを PowerShell で実行します。  (対象ファイル : C:\temp\sample.xlsm)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Remove-Item &#39;C:\temp\sample.xlsm&#39; -Stream Zone.Identifier;</span><br></pre></td></tr></table></figure><br><h3 id="信頼できる発行元のデジタル署名を追加する方法"><a href="#信頼できる発行元のデジタル署名を追加する方法" class="headerlink" title="信頼できる発行元のデジタル署名を追加する方法"></a>信頼できる発行元のデジタル署名を追加する方法</h3><p>Office アプリケーション実行環境にて、”信頼できる発行元” として登録されている証明書を使用したデジタル署名がマクロに追加されている場合にはマクロが実行可能となります。</p><p>この動作を利用してマクロを実行可能とするため、署名者は秘密鍵を持つ証明書で VBA マクロに署名を行い、この証明書をマクロ実行環境のユーザーの「信頼された発行元」ストアに登録します。証明書の信頼に関する動作詳細は Windows 全般の動作となるため本記事では割愛し、Office の動作に関わる部分のみ以下に記載します。</p><p>以下に各 Office アプリケーション上での “信頼できる発行元” として登録されている証明書の確認方法を記載します。</p><h4 id="lt-オプション設定-信頼できる発行元-gt"><a href="#lt-オプション設定-信頼できる発行元-gt" class="headerlink" title="&lt;オプション設定 - 信頼できる発行元&gt;"></a>&lt;オプション設定 - 信頼できる発行元&gt;</h4><p>[ファイル] タブ - [オプション] - [トラスト センター] - [トラスト センターの設定] -  [信頼できる発行元]</p><p><img src="trusted-publisher.png" alt=""></p><p>上記画面にて “信頼できる発行元” として登録されているデジタル証明書の一覧を確認することが可能です。  </p><p>マクロにデジタル署名を付与する手順は以下となります。</p><h4 id="lt-デジタル署名追加手順-gt"><a href="#lt-デジタル署名追加手順-gt" class="headerlink" title="&lt;デジタル署名追加手順&gt;"></a>&lt;デジタル署名追加手順&gt;</h4><ol><li>マクロ付きファイルを各 Officeアプリケーションで開きます。</li><li>[Alt] + [F11] キーを を押下し、Visual Basic Editor (VBE) を開きます。</li><li>VBE の [ツール] タブ - [デジタル署名] をクリックします。</li><li>表示されたウィンドウの [選択] をクリックし、使用する “信頼できる発行元” の証明書を選択して [OK] をクリックします。</li><li>“この VBA プロジェクトは以下のように署名されています。” の下の “証明書名” に選択した証明書名が表示されたことを確認し、[OK] をクリックします。</li><li>ファイルを保存して閉じます。</li></ol><p><img src="digital-signature.png" alt=""></p><br><h2 id="3-特定のフォルダーのファイルでマクロを有効にする方法"><a href="#3-特定のフォルダーのファイルでマクロを有効にする方法" class="headerlink" title="3) 特定のフォルダーのファイルでマクロを有効にする方法"></a>3) 特定のフォルダーのファイルでマクロを有効にする方法</h2><p>各アプリケーションの以下オプション設定で確認 / 追加可能な “信頼できる場所” に登録されているパスにマクロ付きファイルを保存をすることにより、マクロが実行可能となります。</p><h4 id="lt-オプション-設定-gt"><a href="#lt-オプション-設定-gt" class="headerlink" title="&lt;オプション 設定&gt;"></a>&lt;オプション 設定&gt;</h4><p>[ファイル] タブ - [オプション] - [トラスト センター] - [トラスト センターの設定] -  [信頼できる場所]<br>注) 既定で登録された場所は特殊なフォルダですので、マクロを実行したいファイルを保存するためのフォルダは [新しい場所の追加] から任意の場所を追加することをお勧めします。</p><p><img src="trusted-location.png" alt=""></p><p>注) Access / Excel / PowerPoint / Visio / Word の各アプリケーションでそれぞれ異なる設定となります。</p><p>なお、本設定は以下グループ ポリシーでも追加 / 削除が可能です。</p><h4 id="lt-グループポリシー設定-信頼できる場所-gt"><a href="#lt-グループポリシー設定-信頼できる場所-gt" class="headerlink" title="&lt;グループポリシー設定 - 信頼できる場所&gt;"></a>&lt;グループポリシー設定 - 信頼できる場所&gt;</h4><ul><li>Access<br>[ユーザーの構成] - [ポリシー] - [管理用テンプレート]<br>- [Microsoft Access 2016] - [アプリケーション設定] - [セキュリティ]<br>&nbsp;- [セキュリティ センター] - [信頼できる場所]<br>&nbsp;&nbsp;- [信頼できる場所 #1 - #20] : 有効 且つ [パス] に C:\temp などのフォルダーパスを登録します。</li><li>Visio<br>[ユーザーの構成] - [ポリシー] - [管理用テンプレート]<br>- [Microsoft Visio 2016] - [Visio のオプション] -[セキュリティ]<br>&nbsp;- [セキュリティ センター]<br>&nbsp;&nbsp;- [信頼できる場所 #1 - #20] : 有効 且つ [パス] に C:\temp などのフォルダーパスを登録します。  </li><li>Excel / PowerPoint / Word<br>[ユーザーの構成] - [ポリシー] - [管理用テンプレート]<br>- [Microsoft xxx 2016] - [xxx のオプション] -[セキュリティ]<br>&nbsp;- [セキュリティ センター] - [信頼できる場所]<br>&nbsp;&nbsp;- [信頼できる場所 #1 - #20] : 有効 且つ [パス] に C:\temp などのフォルダーパスを登録します。<br>注) xxx は それぞれ Excel / PowerPoint / Word です。</li></ul><p>また、[信頼できる場所] 下部に表示されている [自分のネットワーク上にある信頼できる場所を許可する (推奨しません)] に対応するグループ ポリシーは以下となります。共有フォルダーなどネットワーク上のパスを指定する場合はこちらをご利用ください。</p><h4 id="lt-グループポリシー設定-自分のネットワーク上にある信頼できる場所を許可する-gt"><a href="#lt-グループポリシー設定-自分のネットワーク上にある信頼できる場所を許可する-gt" class="headerlink" title="&lt;グループポリシー設定 - 自分のネットワーク上にある信頼できる場所を許可する&gt;"></a>&lt;グループポリシー設定 - 自分のネットワーク上にある信頼できる場所を許可する&gt;</h4><ul><li>Access<br>[ユーザーの構成] - [ポリシー] - [管理用テンプレート]<br>- [Microsoft Access 2016] - [アプリケーション設定] - [セキュリティ]<br>&nbsp;- [セキュリティ センター] - [信頼できる場所] - [ネットワーク上の信頼できる場所を許可する]</li><li>Visio<br>[ユーザーの構成] - [ポリシー] - [管理用テンプレート]<br>- [Microsoft Visio 2016] - [Visio のオプション] - [セキュリティ]<br>&nbsp;- [セキュリティ センター] - [ネットワーク上の信頼できる場所を許可する]</li><li>Excel / PowerPoint / Word<br>[ユーザーの構成] - [ポリシー] - [管理用テンプレート]<br>- [Microsoft xxx 2016] - [xxx のオプション] - [セキュリティ]<br>&nbsp;- [セキュリティ センター] - [信頼できる場所] - [ネットワーク上の信頼できる場所を許可する]<br>注) xxx は それぞれ Excel / PowerPoint / Word です。</li></ul><br><h2 id="ご参考"><a href="#ご参考" class="headerlink" title="ご参考"></a>ご参考</h2><p>Office グループポリシー管理用テンプレートの導入手順について、以下に詳細が記載されていますので、こちらをご確認ください。</p><p>タイトル : Office の管理用テンプレートを使用してグループ ポリシー (GPO) で Office 365 ProPlus を制御する<br>アドレス  : <a href="https://answers.microsoft.com/ja-jp/msoffice/forum/all/office/3ec9d79c-44ec-4273-97e2-2a6f3a1fd8ef" target="_blank" rel="noopener">https://answers.microsoft.com/ja-jp/msoffice/forum/all/office/3ec9d79c-44ec-4273-97e2-2a6f3a1fd8ef</a>  </p><p>また、上記以外に Microsoft 365 管理センターより設定可能な Office にサインインしているユーザーに適用するクラウド ポリシーや Microsoft Intune を利用したグループ ポリシーを構成する方法も存在します。ご利用の Office バージョンや環境に応じてこれらもご利用ください。以下に公開情報を記載します。</p><p>タイトル : Microsoft 365 Apps for enterprise 向け Office クラウド ポリシー サービスの概要<br>アドレス  : <a href="https://docs.microsoft.com/ja-jp/deployoffice/admincenter/overview-office-cloud-policy-service" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/deployoffice/admincenter/overview-office-cloud-policy-service</a> (日本語版 - 機械翻訳)<br>アドレス  : <a href="https://docs.microsoft.com/en-us/deployoffice/admincenter/overview-office-cloud-policy-service" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/deployoffice/admincenter/overview-office-cloud-policy-service</a> (英語版)  </p><p>タイトル : Windows 10/11 テンプレートを使用して、Microsoft Intune でグループ ポリシー設定を構成する<br>アドレス  : <a href="https://docs.microsoft.com/ja-jp/mem/intune/configuration/administrative-templates-windows" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/mem/intune/configuration/administrative-templates-windows</a> (日本語版 - 機械翻訳)<br>アドレス  : <a href="https://docs.microsoft.com/en-us/mem/intune/configuration/administrative-templates-windows" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/mem/intune/configuration/administrative-templates-windows</a> (英語版)    </p><br><p>今回の投稿は以上です。</p><br><p><strong>本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポート チームです。&lt;/p&gt;
&lt;p&gt;本記事では、2022 年 4 月 より Microsoft 365 Apps への展開が開始されるインターネットから入手した Office ファイルのマクロがブロックされる既定の動作変更について説明します。この
      
    
    </summary>
    
    
    
      <category term="マクロ" scheme="https://officesupportjp.github.io/blog/tags/%E3%83%9E%E3%82%AF%E3%83%AD/"/>
    
      <category term="MC322553" scheme="https://officesupportjp.github.io/blog/tags/MC322553/"/>
    
  </entry>
  
  <entry>
    <title>お知らせ - Japan Office Client Support Blog について</title>
    <link href="https://officesupportjp.github.io/blog/%E3%81%8A%E7%9F%A5%E3%82%89%E3%81%9B%20-%20Japan%20Office%20Client%20Support%20Blog%20%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/%E3%81%8A%E7%9F%A5%E3%82%89%E3%81%9B%20-%20Japan%20Office%20Client%20Support%20Blog%20%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2022-01-30T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:05.026Z</updated>
    
    <content type="html"><![CDATA[<p>いつも Microsoft Office をご愛顧いただき誠にありがとうございます。<br>「Japan Office Client Support Blog」の運用についてお知らせします。</p><p>「Japan Office Client Support Blog」は、Office サポートチームより、よくお問い合わせをいただく情報をサポートトピックとして、皆様よりご要望が多い情報を配信します。</p><p>また、「Office サポートチーム」フォーラムにて公開しておりました記事について、本ブログでの公開を進めております。</p><p>なお、本ブログは情報発信専用のフォーラムとなります。</p><p>Office サポートチーム</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;いつも Microsoft Office をご愛顧いただき誠にありがとうございます。&lt;br&gt;「Japan Office Client Support Blog」の運用についてお知らせします。&lt;/p&gt;
&lt;p&gt;「Japan Office Client Support Blog」
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Teams、SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象のトラブルシューティングについて</title>
    <link href="https://officesupportjp.github.io/blog/Teams%E3%80%81SPO%E3%80%81OneDrive%E3%80%81WebDav%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%8B%E3%82%89%20Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C%E9%96%8B%E3%81%8B%E3%81%AA%E3%81%84%E3%80%81%E4%BF%9D%E5%AD%98%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E7%8F%BE%E8%B1%A1%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/Teams%E3%80%81SPO%E3%80%81OneDrive%E3%80%81WebDav%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%8B%E3%82%89%20Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C%E9%96%8B%E3%81%8B%E3%81%AA%E3%81%84%E3%80%81%E4%BF%9D%E5%AD%98%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E7%8F%BE%E8%B1%A1%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2021-06-20T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:05.010Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。  </p><p>今回の投稿では、Teams、SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象のトラブルシューティングについて説明します。</p><p>以下、問題の切り分けに有用な情報を以下にご案内いたします。</p><p>これらの手順を上から順にご実施ください。</p><p><strong>&lt;実施方法&gt;</strong></p><p>1) Office への再サインイン</p><p>-——————————-</p><p>1. Office からサインアウトし、Office を全て終了します。</p><p>2. OS のスタートメニュー - 歯車 - “アカウント” - “職場または学校にアクセスする” をクリックし、”職場または学校アカウント” として表示されている項目がある場合、”切断” をクリックします</p><p>※ Azure AD や AD に接続済みの項目を “切断” しますと、ドメインから外れてしまいますので、Azure AD や AD に接続済み の項目は切断しないようにご注意ください。</p><p>3. OS からログオフします。(可能であれば、再起動してください)</p><p>4. Office を起動してサインインし、事象が解消するかをお試しください。</p><p>　<br>2) Office アップロードセンターのキャッシュクリア</p><p>-————————————————–</p><p>1. Office を全て終了します。</p><p>2. [スタート]-[すべてのプログラム]-[Microsoft Officeツール]-[Office アップロードセンター] をクリックし、[設定] を押下後、[キャッシュ ファイルの削除] を実施してください。</p><p>3. [ファイルを閉じたときに Office ドキュメント キャッシュから削除する] オプションでチェックを入れ有効に設定します。</p><p>4. [OK] ボタンをクリックし、Microsoft Office アップロード センターの設定 ダイアログを閉じます。  </p><p>上記の手順でアップロードセンターが見つからない場合、以下の手順をご実施ください。</p><p>1. Excel 等を開きます。</p><p>2. [ファイル] タブ - “オプション” を開きます。</p><p>3. “保存” より、”キャッシュ” の設定 - [ファイルを閉じたときに Office ドキュメント キャッシュから削除する] オプションでチェックを入れ有効に設定し、[キャッシュ ファイルの削除] を実施します。</p><p>　<br>3) Office アップロードセンターの完全キャッシュクリア</p><p>-————————————————–</p><p>1. Ctrl + Shift + Esc キーを押してタスク マネージャーを起動します。</p><p>2. [プロセス] タブで [MSOSYNC.EXE] が存在する場合、クリックし、[プロセスの終了] をクリックしてから、タスク マネージャーを終了します。</p><p>3. %userprofile%\AppData\Local\Microsoft\Office\16.0\ に移動します。</p><p>※ Office 2013 の場合は 15.0 となります。</p><p>4. OfficeFileCache フォルダー配下のファイルを削除できるもののみ、削除して下さい。</p><p>5. スタートメニューを右クリックして [ファイル名を指定して実行] から regedit と入力し、レジストリ エディタを起動します。</p><p>6. 以下のキーを展開します。</p><p>HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Common\Internet\Server Cache</p><p>7. Server Cache キーを選択し、削除します。</p><p>8. OS を再起動します。  </p><p>　<br>4) Office のサインインキャッシュのクリア</p><p>-————————————————–</p><p>以下の記事の手順により、サインインキャッシュのクリアをご実施ください。</p><p>Title : Office のサインインのトラブルシュートについて<br>URL : <a href="https://officesupportjp.github.io/blog/Office%20%E3%81%AE%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%88%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/">https://officesupportjp.github.io/blog/Office のサインインのトラブルシュートについて</a></p><p><strong>- 関連情報</strong></p><p>Title : MSI 版の Office 2016 で SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象について</p><p>URL : <a href="https://officesupportjp.github.io/blog/MSI%20%E7%89%88%E3%81%AE%20Office%202016%20%E3%81%A7%20SPO%E3%80%81OneDrive%E3%80%81WebDav%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%8B%E3%82%89%20Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C%E9%96%8B%E3%81%8B%E3%81%AA%E3%81%84%E3%80%81%E4%BF%9D%E5%AD%98%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E7%8F%BE%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/">https://officesupportjp.github.io/blog/MSI 版の Office 2016 で SPO、OneDrive、WebDav サーバーから Office ファイルが開かない、保存できない現象について</a></p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。  &lt;/p&gt;
&lt;p&gt;今回の投稿では、Teams、SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象のトラブルシューティングについて説明します。&lt;/p&gt;
&lt;p&gt;以下、問
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Office 製品のサインインで先進認証が有効化、無効化されているかを確認する方法について</title>
    <link href="https://officesupportjp.github.io/blog/Office%20%E8%A3%BD%E5%93%81%E3%81%AE%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%81%A7%E5%85%88%E9%80%B2%E8%AA%8D%E8%A8%BC%E3%81%8C%E6%9C%89%E5%8A%B9%E5%8C%96%E3%80%81%E7%84%A1%E5%8A%B9%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E3%81%8B%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/Office%20%E8%A3%BD%E5%93%81%E3%81%AE%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%81%A7%E5%85%88%E9%80%B2%E8%AA%8D%E8%A8%BC%E3%81%8C%E6%9C%89%E5%8A%B9%E5%8C%96%E3%80%81%E7%84%A1%E5%8A%B9%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E3%81%8B%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2021-06-16T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:04.978Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。  </p><p>Office 製品のサインインで先進認証が有効化、無効化されているかを確認したいとお問い合わせいただくことがございます。</p><p>本投稿では、先進認証の有効化、無効化を確認する方法についてご案内いたします。</p><p><strong>【確認方法について】</strong></p><p>Office のサインイン画面を表示することで確認することが可能です。</p><p><strong>- 先進認証が有効の場合 (以下の何れかが表示されます)</strong></p><p><img src="image1.png" alt=""><br><img src="image2.png" alt=""></p><p><strong>- 先進認証が無効の場合</strong></p><p><img src="image3.png" alt=""></p><p><strong>【先進認証を有効化、無効化する方法について】</strong></p><p><strong>- Office 2013 製品の場合</strong></p><p>Office 2013 製品では、既定で先進認証が無効です。</p><p>以下のレジストリキーを設定することで、先進認証を有効にしていただけます。</p><p>キー: HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\15.0\Common\Identity<br>名前: EnableADAL<br>種類: REG_DWORD<br>データ: 1</p><p>名前: Version<br>種類: REG_DWORD<br>データ: 1</p><p>※ Office 2013 では、Microsoft Update により更新プログラムを最新に適用していただかないと、上記のレジストリを設定しても先進認証が有効にならない場合がございます。</p><p>※ 本レジストリキーは HKEY_CURRENT_USER 配下のため、レジストリエディターで値を編集される場合、別の管理者ユーザーなどでレジストリエディターを起動しないでください。</p><p><strong>- Office 2016、2019、Microsoft 365 Apps (Office 365 ProPlus) 製品の場合</strong></p><p>Office 2016 以降となるこれらの製品では、既定で先進認証が有効です。</p><p>Microsoft 365 Apps 製品では将来的に廃止される可能性はございますが、以下のレジストリの設定により、先進認証を無効化していただけます。</p><p>キー: HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\16.0\Common\Identity<br>名前: EnableADAL<br>種類: REG_DWORD<br>データ: 0</p><p>※ 本レジストリキーは HKEY_CURRENT_USER 配下のため、レジストリエディターで値を編集される場合、別の管理者ユーザーなどでレジストリエディターを起動しないでください。</p><p><strong>【参考資料】</strong></p><p>EnableADAL の説明や各製品の詳細につきましては、以下の資料をご参考にいただきますようお願いいたします。</p><p>Title : 2013、Office 2016、および 2019 Office 2019 クライアント アプリOfficeのしくみ</p><p>URL : <a href="https://docs.microsoft.com/ja-jp/microsoft-365/enterprise/modern-auth-for-office-2013-and-2016?view=o365-worldwide" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/microsoft-365/enterprise/modern-auth-for-office-2013-and-2016?view=o365-worldwide</a></p><p>Title : Windows デバイスの Office 2013 の先進認証を有効にする<a href="https://docs.microsoft.com/ja-jp/microsoft-365/enterprise/modern-auth-for-office-2013-and-2016?view=o365-worldwide" target="_blank" rel="noopener"></a><br>URL : <a href="https://docs.microsoft.com/ja-jp/microsoft-365/admin/security-and-compliance/enable-modern-authentication?view=o365-worldwide" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/microsoft-365/admin/security-and-compliance/enable-modern-authentication?view=o365-worldwide</a></p><p><strong>- 関連記事</strong>  </p><p>Title : Office のサインインでネットワーク接続がない旨のメッセージが表示される事象について<br>URL : <a href="https://officesupportjp.github.io/blog/Office%20%E3%81%AE%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%81%A7%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E6%8E%A5%E7%B6%9A%E3%81%8C%E3%81%AA%E3%81%84%E6%97%A8%E3%81%AE%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%81%8C%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B%E4%BA%8B%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/">https://officesupportjp.github.io/blog/Office のサインインでネットワーク接続がない旨のメッセージが表示される事象について</a></p><p>今回の投稿は以上です。</p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。  &lt;/p&gt;
&lt;p&gt;Office 製品のサインインで先進認証が有効化、無効化されているかを確認したいとお問い合わせいただくことがございます。&lt;/p&gt;
&lt;p&gt;本投稿では、先進認証の有効化、無効化を確認する方法についてご案
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>「このコンピューターに組織内の別のアカウントが既にサインインしています」と表示される</title>
    <link href="https://officesupportjp.github.io/blog/%E3%80%8C%E3%81%93%E3%81%AE%E3%82%B3%E3%83%B3%E3%83%94%E3%83%A5%E3%83%BC%E3%82%BF%E3%83%BC%E3%81%AB%E7%B5%84%E7%B9%94%E5%86%85%E3%81%AE%E5%88%A5%E3%81%AE%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%81%8C%E6%97%A2%E3%81%AB%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%8D%E3%81%A8%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B/"/>
    <id>https://officesupportjp.github.io/blog/%E3%80%8C%E3%81%93%E3%81%AE%E3%82%B3%E3%83%B3%E3%83%94%E3%83%A5%E3%83%BC%E3%82%BF%E3%83%BC%E3%81%AB%E7%B5%84%E7%B9%94%E5%86%85%E3%81%AE%E5%88%A5%E3%81%AE%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%81%8C%E6%97%A2%E3%81%AB%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%8D%E3%81%A8%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B/</id>
    <published>2021-04-12T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:05.026Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。  </p><p>Office 製品のサインイン時に以下のようなエラーが表示されるとお問い合わせいただくことがございます。  </p><p><img src="image1.png" alt=""></p><p><strong>【事象について】</strong></p><p>以下の公開情報のとおり、組織内の別のアカウントが既に Office にサインインしているために発生してます。  </p><p>Title : “申し訳ございません。組織の別のアカウントが、このコンピューターで既にサインインしています” という Office 2013 があります。<br>URL : <a href="https://docs.microsoft.com/ja-jp/office/troubleshoot/office-suite-issues/another-account-already-signed-in" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/office/troubleshoot/office-suite-issues/another-account-already-signed-in</a><br>※ Office 2013 と記載されておりますが、Microsoft 365 Apps for Enterprise も対象となります。</p><p><strong>【解消方法について】</strong></p><p>以下の手順で事象が解消されるかをご確認いただきますようお願いいたします。  </p><p>- 手順<br>1. Office にサインインしているユーザーをすべてサインアウトし、Office を終了してください。<br>2. OS のスタートメニュー - 歯車 - “アカウント” - “職場または学校にアクセスする” をクリックし、”職場または学校アカウント” として表示されている項目がある場合、”切断” をクリックします<br>※ Azure AD や AD に接続済みの項目を “切断” しますと、ドメインから外れてしまいますので、Azure AD や AD に接続済み の項目は切断しないようにご注意ください。</p><p><img src="image2.png" alt=""></p><p>3. Office を起動し、サインインをご実施ください</p><p>なお、”職場または学校にアクセスする” のアカウントは、Office のサインイン時に “すべてのアプリにサインインしたままにする” の旨のダイアログで、”このアプリのみ” を選択せず、そのまま OK をクリックした場合に追加されます。</p><p><img src="image3.png" alt=""></p><p>※ このダイアログの文言は OS のバージョンによって変わる場合がございます。</p><p>“職場または学校にアクセスする” にアカウントが追加されると、Office のサインインや Office 365 ポータルへのアクセス等でパスワードが求められなくなる等の利点がございますが、<br>共用の端末の場合等でこのアカウントの追加が必要ございません場合、今後、以下の対応をご検討いただけますと幸いです。  </p><p>方法 1) “すべてのアプリにサインインしたままにする” の旨のダイアログで、”このアプリのみ” を選択する<br>方法 2) 以下の BlockAADWorkplaceJoin レジストリを設定し、”すべてのアプリにサインインしたままにする” の旨のダイアログを表示させないようにする。  </p><p>Title : Azure Active Directory デバイス管理の FAQ<br>URL : <a href="https://docs.microsoft.com/ja-jp/azure/active-directory/devices/faq" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/azure/active-directory/devices/faq</a><br>-—- 抜粋開始 —–<br>HKLM\SOFTWARE\Policies\Microsoft\Windows\WorkplaceJoin, “BlockAADWorkplaceJoin”=dword:00000001<br>-—- 抜粋終了 —–</p><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。  &lt;/p&gt;
&lt;p&gt;Office 製品のサインイン時に以下のようなエラーが表示されるとお問い合わせいただくことがございます。  &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;image1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Office ファイルを開こうとすると、実際に開いているユーザーとは異なるユーザーが使用中と表示される</title>
    <link href="https://officesupportjp.github.io/blog/Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E9%96%8B%E3%81%93%E3%81%86%E3%81%A8%E3%81%99%E3%82%8B%E3%81%A8%E3%80%81%E5%AE%9F%E9%9A%9B%E3%81%AB%E9%96%8B%E3%81%84%E3%81%A6%E3%81%84%E3%82%8B%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%A8%E3%81%AF%E7%95%B0%E3%81%AA%E3%82%8B%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%8C%E4%BD%BF%E7%94%A8%E4%B8%AD%E3%81%A8%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B/"/>
    <id>https://officesupportjp.github.io/blog/Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E9%96%8B%E3%81%93%E3%81%86%E3%81%A8%E3%81%99%E3%82%8B%E3%81%A8%E3%80%81%E5%AE%9F%E9%9A%9B%E3%81%AB%E9%96%8B%E3%81%84%E3%81%A6%E3%81%84%E3%82%8B%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%A8%E3%81%AF%E7%95%B0%E3%81%AA%E3%82%8B%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%8C%E4%BD%BF%E7%94%A8%E4%B8%AD%E3%81%A8%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B/</id>
    <published>2021-03-10T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:04.900Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームの半田です。<br>この記事では、Office ファイルを開こうとすると、実際に開いているユーザーとは<br>異なるユーザーが使用中と表示されることがある事象と、その対処策について説明します。  </p><p><strong>現象</strong><br>通常、既に別のユーザーが開いているファイルを開こうとすると、以下のように別のユーザーがファイルを編集中である旨のメッセージが表示されます。<br>このとき、実際には TestUserA がファイルを開いていないにも関わらず TestUserA がファイルを使用中と表示されたり、<br>誰も当該ファイルを開いていないにも関わらず、別のユーザーがファイルを使用中と表示される事象が発生することがあります。  </p><p><img src="image1.png" alt="別のユーザーが既にファイルを開いていると表示されるメッセージ">  </p><p><strong>Office の動作について</strong><br>この事象の原因と対処策について説明する前に、関連する Office の動作について解説します。  </p><p>基本的に、Office アプリは既存のファイルを開く際、開こうとしているファイルが存在するフォルダ内に<br>~$&lt;ファイル名&gt; という名前の一時ファイルを作成し、この ~$ つきの一時ファイルに自身のユーザー名を記録します。<br>例えば、”TestFile.xlsx” というファイルを開く場合は、”~$TestFile.xlsx” という一時ファイルを作成して、自分自身のユーザー名を記録します。<br>(補足: *.xls や Access ファイルなどの一部の Office ファイルについては、開いても ~$ つきファイルは作成されません)  </p><p>これにより、既に別のユーザーによって開かれている Office ファイルを開こうとすると<br>同フォルダ内に存在する ~$ つきファイルに記録されているユーザー名を確認することで<br>当該のファイルが誰によって開かれているか確認/通知することが可能になっています。  </p><p>なおこの ~$ つきのファイルは、対応する Office ファイルが閉じられると同時に削除されます。  </p><p><strong>考えられる原因</strong><br>Office アプリは、開こうとしているファイルと同じフォルダに、対応する ~$ つきの一時ファイルが存在しないか確認し、<br>存在している場合、そのファイル内に記録されているユーザー名をもとに、誰がファイルを開いているのか通知します。  </p><p>この ~$ つきの一時ファイルは、対応する Office ファイルが閉じられると同時に削除されることが期待されますが<br>Office がクラッシュしたり、クライアント - ファイルサーバー間の接続が突然切断されるなどの予期しない動作が発生した場合、<br>削除されずに残存する場合があります。  </p><p>この場合、予期せず残存した ~$ つきファイルに起因して、実際とは異なるユーザーがファイルを使用中と表示されたり<br>誰も当該ファイルを開いていないにも関わらず、別のユーザーがファイルを使用中と表示される事象が発生することがあります。  </p><p><strong>検討される対処策</strong><br>~$ つきファイルの残存に起因して発生している事象については、この ~$ つきファイルを削除することで改善することが期待できます。<br>なお、エクスプローラーで ~$ つきファイルを表示させるためには、[フォルダー オプション] – [表示] から、以下の設定を行う必要があります。  </p><p>・[隠しファイル、隠しフォルダー、および隠しドライブを表示する] : [有効]<br>・[保護されたオペレーティング システム ファイルを表示しない (推奨)] : [無効]   </p><p>また、~$ つきのファイルは、ファイルを開いているユーザー情報を格納するためのファイルであるため<br>このファイルを削除しても、元の Office ファイルの情報が欠落することはありません。  </p><p>今回の投稿は以上です。<br><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポート チームの半田です。&lt;br&gt;この記事では、Office ファイルを開こうとすると、実際に開いているユーザーとは&lt;br&gt;異なるユーザーが使用中と表示されることがある事象と、その対処策について説明します。  &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;現象
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Excel に入力した記号のフォントが Cambria Math に変更される事象について</title>
    <link href="https://officesupportjp.github.io/blog/Excel%20%E3%81%AB%E5%85%A5%E5%8A%9B%E3%81%97%E3%81%9F%E8%A8%98%E5%8F%B7%E3%81%AE%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E3%81%8C%20Cambria%20Math%20%E3%81%AB%E5%A4%89%E6%9B%B4%E3%81%95%E3%82%8C%E3%82%8B%E4%BA%8B%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/Excel%20%E3%81%AB%E5%85%A5%E5%8A%9B%E3%81%97%E3%81%9F%E8%A8%98%E5%8F%B7%E3%81%AE%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E3%81%8C%20Cambria%20Math%20%E3%81%AB%E5%A4%89%E6%9B%B4%E3%81%95%E3%82%8C%E3%82%8B%E4%BA%8B%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2021-03-03T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:04.806Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームの永田です。</p><p>Excelで、「≧」「⇒」といった一部の記号のフォントが、予期せず Cambria Math に変更される事象が発生することがあります。 情報に更新があり次第、このブログ記事は更新される予定です。</p><p><strong>事象</strong></p><p>Excelで、「≧」「⇒」といった一部の記号のフォントが、予期せず Cambria Math に変更される</p><p><strong>再現手順</strong></p><ol><li>Excel を起動する</li><li>新規ブックを追加する</li><li>セル A1 を選択し、ホーム - フォント 欄より、フォントを Arial に設定する</li><li>セル A1 をダブルクリックして編集モードにする</li><li>日本語入力 ON にして、「だいなり」と入力し、≧ 記号を入力して決定する</li></ol><p>結果</p><p>フォントが Cambria Math に変更される。また、それに伴って行の高さが予期せず大きくなる。</p><p><strong>再現条件</strong></p><p>以下の場合には再現しません</p><ul><li>[ファイル] - [オプション] - [言語] - [Office の編集言語と構成機能] より、英語 (米国) が &lt;優先&gt; となっている場合には発生しない。日本語が &lt;優先&gt; の場合に発生する。</li><li>上記の手順 4. を飛ばして、編集モードまたは入力モードにしない状態で「≧」記号だけを入力した場合、発生しない。</li><li>上記の手順 3. の手順で、セルのフォントを MS Pゴシック などに設定した場合、発生しない。</li></ul><p>以下の場合、事象が発生します</p><ul><li>既に「≧」記号が入力され、期待通りに表示されているセルについて、セルのフォントを Arial に変更後、セルをダブルクリックすると、記号のフォントが Cambria Math に変更される。</li><li>セルのフォントが Arial の状態で、[挿入] - [記号と特殊記号] - [記号と特殊記号] を開き、[フォント(F): MS Pゴシック]、[種類(U): 数学記号] をそれぞれ選択し、一覧から記号を挿入すると、挿入直後はフォントが変化しない。ただし、このセルをダブルクリックすると、記号のフォントが Cambria Math に変更される。</li></ul><p><strong>影響範囲</strong></p><p>Microsoft 365 Apps 内の Excel、および、ボリュームライセンス版の Excel 2019 で発生します。Microsoft 365 Apps の場合、現時点で最新のバージョン 2102 (13801.20274) でも発生します。</p><p>Excel 2013 や、ボリュームライセンス版の Excel 2016、パッケージ版の Excel 2016 では発生しません。</p><p><strong>対応状況</strong></p><p>マイクロソフトでは現時点でこの問題を調査中です。</p><p><strong>回避策</strong></p><p>現段階での回避策としては、誠に恐れ入りますが、以下の方法を検討ください。</p><ul><li>すでに Cambria Math に変換されたセルは、セルを選択して「MS ゴシック」など日本語フォントに設定する</li><li>これから「≧」記号を入力するセルは、予め「MS ゴシック」など日本語フォントに設定しておく</li><li>「≧」記号の両辺の数字を英数字フォント (Arial など) に変更したい場合には、予めセル全体を「MS ゴシック」など日本語フォントに設定した後、セルをダブルクリックして編集モードにし、「≧」記号以外の箇所 (例: 記号の両辺の数字など) を選択して、フォントを Arial などに変更する。</li><li>[ファイル] - [オプション] - [言語] - [Office の編集言語と構成機能] より、優先する言語を、英語に変更する。</li></ul><p>今回の投稿は以上です。</p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポート チームの永田です。&lt;/p&gt;
&lt;p&gt;Excelで、「≧」「⇒」といった一部の記号のフォントが、予期せず Cambria Math に変更される事象が発生することがあります。 情報に更新があり次第、このブログ記事は更新される予定です。&lt;/p&gt;
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>クリップボード アクセスの競合による Office でのコピー-貼り付け失敗</title>
    <link href="https://officesupportjp.github.io/blog/%E3%82%AF%E3%83%AA%E3%83%83%E3%83%97%E3%83%9C%E3%83%BC%E3%83%89%20%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%AE%E7%AB%B6%E5%90%88%E3%81%AB%E3%82%88%E3%82%8B%20Office%20%E3%81%A7%E3%81%AE%E3%82%B3%E3%83%94%E3%83%BC-%E8%B2%BC%E3%82%8A%E4%BB%98%E3%81%91%E5%A4%B1%E6%95%97/"/>
    <id>https://officesupportjp.github.io/blog/%E3%82%AF%E3%83%AA%E3%83%83%E3%83%97%E3%83%9C%E3%83%BC%E3%83%89%20%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%AE%E7%AB%B6%E5%90%88%E3%81%AB%E3%82%88%E3%82%8B%20Office%20%E3%81%A7%E3%81%AE%E3%82%B3%E3%83%94%E3%83%BC-%E8%B2%BC%E3%82%8A%E4%BB%98%E3%81%91%E5%A4%B1%E6%95%97/</id>
    <published>2021-01-18T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:05.057Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームの中村です。</p><p>Office アプリケーション上でコピーや貼り付け操作を行ったときに、コピーしたはずのデータが貼り付けられなかったり、エラーが発生することがあります。これは、他のアプリケーションとのクリップボードへのアクセスが競合したことが原因である場合が非常に多いものとなります。このような原因でコピー・貼り付けに失敗する場合、基本的には再度コピーや貼り付けを行うしかありません。</p><p>弊社サポートへのお問い合わせの中で、このような状況が避けられないことに疑問を持つ声を時折頂いていますので、今回の記事では、この仕組みを解説します。</p><h4 id="1-Windows-のコピー・貼り付けの仕組み"><a href="#1-Windows-のコピー・貼り付けの仕組み" class="headerlink" title="1. Windows のコピー・貼り付けの仕組み"></a><strong>1. Windows</strong> <strong>のコピー・貼り付けの仕組み</strong></h4><p>Windows 上では、例えば Office / インターネット ブラウザ / メモ帳など、異なるアプリケーション間でデータをコピーして貼り付けることができます。このような操作が実現できるのは、OS の「クリップボード」がコピーデータを仲介しているためです。アプリケーション上でデータをコピーすると、クリップボードにコピーしたデータを格納します。また、別のアプリケーションで貼り付けを行うときには、クリップボードからコピーしたデータを取り出します。</p><p>このクリップボードを介したコピー・貼り付けの仕組みにおいては、データの整合性を担保することが重要です。例えば、コピーしたデータをクリップボードに格納している途中で他のアプリケーションがこのデータを読み取ると、中途半端な状態のコピーデータが読み取られる危険があります。また、同時に複数のプロセスが異なるコピーデータをクリップボードに書きこむと、データが破損する懸念があります。このような問題を避けるため、クリップボードに複数のアプリケーションから同時にアクセスができないよう、あるアプリケーションからクリップボードにアクセスしている最中は、クリップボードをロックする仕組みとなっています。</p><p><img src="image1.png" alt=""></p><p>このようにクリップボードがロックされている間に他のプロセスがクリップボードをオープンすると、そのアクセスは失敗します。つまり、コピーしたデータが格納できなかったり、貼り付けたいデータが取得できず何も貼り付けられなかったり、といった状況となります。アプリケーションによっては、クリップボードのオープン失敗を検知してエラーメッセージを表示することもあります。このような状況を、「クリップボード アクセスの競合」と呼んでいます。</p><p><img src="image2.png" alt=""></p><p>上記の図におけるプロセス B からは、自身がコピーなどのためにクリップボードにアクセスするとき、クリップボードがロックされているか、通常確認を行うことはありませんし、仮に確認しても強制的にロックを解除することはできません。このため、上図のようにタイミングによってはクリップボードにアクセスできない場合があることは Windows のクリップボードを介したコピー・貼り付けの仕組み上、避けることはできません。Office がプロセス B の立場になった場合も同様ですので、Office 上でのコピー・貼り付けにおいてもこの仕組みの制約を受けることになります。  </p><h4 id="2-問題に直面するシナリオ"><a href="#2-問題に直面するシナリオ" class="headerlink" title="2. 問題に直面するシナリオ"></a><strong>2. 問題に直面するシナリオ</strong></h4><p>ユーザー操作によるコピーと貼り付けでのみクリップボードが使われる場合、この流れはシリアルに行われますので、競合が発生することはありません。しかし、実際の Windows 上では、様々な目的でユーザーが意識していないタイミングでクリップボードへのアクセスが行われることがあります。以下に、その例を記載します。  </p><p><strong>・Windows 10 のクリップボード履歴機能</strong></p><p>Windows 10 バージョン 1807 から追加された新機能で、コピーしたデータの過去複数件の履歴を保持して貼り付けられるようになりました。この機能の実現のため、クリップボードにデータが格納されると、クリップボード履歴機能のプロセスからクリップボードにアクセスが発生します。</p><p>参考)クリップボードの概要<br><a href="https://support.microsoft.com/ja-jp/windows/30375039-ce71-9fe4-5b30-21b7aab6b13f" target="_blank" rel="noopener">https://support.microsoft.com/ja-jp/windows/30375039-ce71-9fe4-5b30-21b7aab6b13f</a></p><p><strong>・エクスプローラの [貼り付け] ボタン</strong></p><p>エクスプローラのリボンに [貼り付け] ボタンがあります。コピーデータがファイルなどのエクスプローラ上で貼り付けられるデータの場合に、このリボンのボタンを活性化するため、リボンが展開表示されている場合は、コピー時にエクスプローラからもアクセスが発生します。(リボンを閉じた状態で OS を再起動してそのままリボンを開かなければ、このアクセスは発生しません。)  </p><p><strong>・リモート デスクトップのクリップボード共有</strong></p><p>リモート デスクトップ時に、[ローカル リソース] タブで [クリップボード] のチェックを有効にすると、ローカルとリモートのマシン間でデータをコピーすることができます。この機能が有効な状態でリモート接続している場合、これを管理するプロセス (rdpclip.exe) からクリップボードにアクセスが発生します。  </p><p><strong>・他の Office アプリケーション</strong></p><p>Office アプリケーション間では、Word と Excel など、別の Office アプリケーション同士でコピー・貼り付けを行う独自の仕組み (Office クリップボード) があります。この機能は、OS にクリップボード履歴機能が搭載される以前から、コピーデータの履歴を利用できる機能を提供していました。この機能実現のため、いずれかの Office アプリケーションでコピーが行われると、起動している他の Office アプリケーションからクリップボードにアクセスが発生します。</p><p>なお、この機能については以下のレジストリを設定することで無効化できます。Office クリップボードを無効化しても、通常の OS としてのコピー・貼り付け機能の範囲でコピー操作を利用できます。</p><p>&lt;Office クリップボードの無効化&gt;<br>キー : HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Common\General<br>名前: AcbControl<br>種類: REG_DWORD<br>値 : 2147483648 (10 進)<br>※ Microsoft 365 / Office 2019 / Office 2016 向けのレジストリ キーです。<br>※ すべての Office アプリケーションを終了した状態で設定してください。  </p><p><strong>・サードパーティ製品 (主にクリップボード監視機能、セキュア接続機能などを提供する製品)</strong></p><p>サードパーティ ソフトでも、クリップボードへのアクセスが行われることがあります。</p><p>例えばセキュリティ ソフトなどには、ユーザーによるデータの持ち出しを監視するため、クリップボード監視機能がついているものがあります。このような製品の多くでは、クリップボード監視機能によって、データのコピー・貼り付けなどに連動してクリップボードにアクセスが発生します。</p><p>また、Windows のリモート デスクトップに似た、独自のセキュア接続としてリモート マシンに接続するソフトでも、クリップボード共有のためアクセスが発生することがあります。  </p><p>このように、様々なプロセスからクリップボードへのアクセスは発生しますが、ほとんどの場合、実際にはクリップボードがロックされるのは非常に短い時間であるため、実際に競合が生じることは一般的な環境やユーザー操作シナリオではそれほど多くはありません。</p><p>ただ、クリップボード アクセスの競合は、クリップボードがロックされている時間が長いほど発生しやすくなります。ロック時間の長さは、コピーデータのサイズやアプリケーションの処理の流れによって異なります。また当然、クリップボード アクセスを行うプロセスが多いほど競合の可能性は高くなるため、様々な製品を導入された環境や、多数のアプリケーションを起動していると比較的発生しやすくなります。そして、プログラムからループ処理で短い時間で繰り返しコピーや貼り付けを行うときは競合の可能性が高くなります。</p><p>これらの要素に該当する環境や利用状況では、実際にある程度高い頻度で競合が発生することがある、という報告は弊社サポートにも寄せられています。  </p><h4 id="3-対応方法"><a href="#3-対応方法" class="headerlink" title="3. 対応方法"></a><strong>3. 対応方法</strong></h4><p>1. でご説明した通り、仕組み上、クリップボードへのアクセス競合を完全に防ぐことはできません。このため、Office アプリケーションで競合によるコピー・貼り付けの失敗が生じる状況では、競合相手のプロセスを停止 (クリップボードにアクセスする機能を無効化) して解消するか、ユーザーが再度コピーや貼り付けを行う運用対処しかありません。</p><p>クリップボードへのアクセスが失敗した場合の Office の動作は、アプリケーションによって異なります。</p><p><strong>Excel</strong></p><p>コピー時にクリップボードへのアクセスに失敗すると以下のようなメッセージが表示され、このときにも、その Excel プロセス内ではデータの貼り付けが可能です。(他のアプリケーションには貼り付けられません。)</p><p><img src="image3.png" alt=""></p><p>貼り付け時のクリップボード アクセス失敗の場合は、クリップボードからデータを取得できないため貼り付けられません。この時は、特にエラーメッセージは表示されません。  </p><p><strong>Word / PowerPoint</strong></p><p>コピー、貼り付け共に特にエラーメッセージは表示されず、自アプリケーション内でも貼り付けはできません。  </p><p><ins><strong>マクロ等からのコピー処理で発生する場合の対処</strong></ins></p><p>VBA マクロやその他言語で Office をオートメーションしていて、その処理の中でコピー・貼り付けを行うときに現象が発生する場合は、コピー・貼り付けではなく、別の方法でデータの転記を行うよう変更して回避することをお勧めします。</p><p>例えば、Excel でセルをコピーして別のシートに貼り付けるような場合は、コピー元のセル オブジェクトの Valueなどを貼り付け先のセルに設定するよう変更し、Copy や Paste といったメソッドは使用しないことが検討できます。</p><p>例: B1 セルの内容を A1 セルへクリップボードを経由して貼り付けるコードの変更イメージ</p><p>変更前:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ActiveSheet.Range(&quot;B1&quot;).Copy</span><br><span class="line">ActiveSheet.Range(&quot;A1&quot;).Select</span><br><span class="line">ActiveSheet.Paste</span><br></pre></td></tr></table></figure><p>変更後:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ActiveSheet.Range(&quot;A1&quot;).Value &#x3D; ActiveSheet.Range(&quot;B1&quot;).Value</span><br></pre></td></tr></table></figure><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポート チームの中村です。&lt;/p&gt;
&lt;p&gt;Office アプリケーション上でコピーや貼り付け操作を行ったときに、コピーしたはずのデータが貼り付けられなかったり、エラーが発生することがあります。これは、他のアプリケーションとのクリップボードへのアク
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Excel で ScrollArea プロパティを設定すると、キーボード操作でシートがスクロールしない</title>
    <link href="https://officesupportjp.github.io/blog/Excel%20%E3%81%A7%20ScrollArea%20%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B%E3%81%A8%E3%80%81%E3%82%AD%E3%83%BC%E3%83%9C%E3%83%BC%E3%83%89%E6%93%8D%E4%BD%9C%E3%81%A7%E3%82%B7%E3%83%BC%E3%83%88%E3%81%8C%E3%82%B9%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%97%E3%81%AA%E3%81%84/"/>
    <id>https://officesupportjp.github.io/blog/Excel%20%E3%81%A7%20ScrollArea%20%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B%E3%81%A8%E3%80%81%E3%82%AD%E3%83%BC%E3%83%9C%E3%83%BC%E3%83%89%E6%93%8D%E4%BD%9C%E3%81%A7%E3%82%B7%E3%83%BC%E3%83%88%E3%81%8C%E3%82%B9%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%97%E3%81%AA%E3%81%84/</id>
    <published>2021-01-11T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:04.806Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームの中村です。</p><p>Excel には、ワークシートのスクロール可能な範囲を設定する ScrollArea というシート プロパティが用意されています。本記事では、このScrollArea プロパティを設定したとき、キーボードの矢印キーや Tab キーなどで選択セルを移動したとき、ウィンドウに表示されていないセルに移動しても、そのセルが画面に表示されるようシートがスクロールしない動作について記載します。  </p><h4 id="1-現象"><a href="#1-現象" class="headerlink" title="1. 現象"></a><strong>1. 現象</strong></h4><p>以下の画面キャプチャをご覧ください。この画面では、O2 セルが現在選択されていますが、画面右端に見切れて表示された状態になっています。(赤枠部分)</p><p>通常、例えば A2 セルから右矢印キーや、Tab キーで B2、C2・・・と順に列を移動すると、選択状態のセル全体がウィンドウ内に見える位置に自動的にスクロールされます。しかしながら、後述の状況においては、この画面キャプチャのように十分にスクロールされない場合があります。またこのあと、O 列以降のセルに移動してもこの位置のままスクロールしません。</p><p><img src="image1.png" alt="">  </p><h4 id="2-現象が発生する状況"><a href="#2-現象が発生する状況" class="headerlink" title="2. 現象が発生する状況"></a><strong>2. 現象が発生する状況</strong></h4><p>この動作に直面する主な状況は、ワークシートの ScrollArea プロパティが設定された状態で、かつセルの幅や高さが広げられているときに、スクロール可能範囲の終端に近いセルに移動する場合です。</p><p>Excel が画面外の領域にスクロールするときに、スクロール後のウィンドウ内に表示するシート範囲などを、セルの幅や高さ / ウィンドウのサイズ / 残りのスクロール可能範囲などの要素を基に算出します。これらの要素の組み合わせ次第で、スクロール後の表示位置を期待通りに算出できない場合があり、この現象が発生します。</p><p>また、Excel バージョンによっても細かな動作は異なるため、例えば同じファイルを同じウィンドウ サイズで開いても、スクロールしなくなる動作が生じる列や行はバージョンによって異なる場合があります。</p><p>発生に関わる条件をまとめると以下の通りです。</p><p><strong>条件 1:</strong><br>ワークシートの ScrollArea プロパティが設定されていること</p><p>※プログラムからは Worksheet オブジェクトのプロパティや、Visual Basic Editor でプロパティ ウィンドウからも設定・確認できます。</p><p>ScrollArea プロパティ (Excel)<br><a href="https://docs.microsoft.com/ja-jp/office/vba/api/excel.worksheet.scrollarea" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/office/vba/api/excel.worksheet.scrollarea</a></p><p><img src="image2.png" alt=""></p><p><strong>条件 2:</strong><br>以下の要素等の組み合わせによって発生</p><ul><li>選択セルから ScrollArea プロパティの終端までの残りの幅・高さ</li><li>Excel ブック画面のウィンドウ サイズ</li><li>各セルの幅や高さ</li><li>シートの倍率</li><li>ウィンドウ サイズなどの算出に関わるディスプレイの拡大縮小、スケール設定</li></ul><p>この動作は、ユーザーの利用上、不便な場合がある動作であることは認識しておりますが、現状のスクロール動作の内部処理上の制約として、現時点でサポートされる全てのバージョンの Excel で発生しうる制限動作となっています。(2021/1/12 現在、サポート対象の Excel は Excel 2013 / 2016 / 2019 / Office 365 の Excel です。)  </p><h4 id="3-回避策"><a href="#3-回避策" class="headerlink" title="3. 回避策"></a><strong>3. 回避策</strong></h4><p>この動作が生じるファイルやウィンドウ サイズなどの構成でも、以下のいずれかの方法でスクロールできます。  </p><h5 id="3-1-スクロールバーでスクロールする"><a href="#3-1-スクロールバーでスクロールする" class="headerlink" title="3-1. スクロールバーでスクロールする"></a><strong>3-1. スクロールバーでスクロールする</strong></h5><p>マウス操作でスクロール バーによってスクロールすると、画面をスクロールできます。</p><p>以下は、先述のファイルでスクロール バーの右矢印 (赤枠部分) をマウスで操作してスクロールした例です。</p><p><img src="image3.png" alt="">  </p><h5 id="3-2-ScrollArea-を広げる、または解除する"><a href="#3-2-ScrollArea-を広げる、または解除する" class="headerlink" title="3-2. ScrollArea を広げる、または解除する"></a><strong>3-2. ScrollArea を広げる、または解除する</strong></h5><p>移動先のセルから、ScrollArea の終端までの幅や高さが十分に広い場合には、正常にスクロールできます。</p><p>例えば A～Q 列にあるテーブルの範囲だけスクロールするさせるため、ScrollArea プロパティに A ～ Q 列を設定しているとします。これを、例えば Z 列など、ある程度余裕を持った範囲をスクロールできるよう設定すると、実際にスクロールしたい範囲では期待通りスクロールできます。(どの列までを ScrollArea に設定すれば問題ないかは、条件 2 の各要素に依存します。具体的な値は定められませんが、実際の環境・ファイルで動作を確認しながら、余裕を持った範囲を設定してください。)</p><p>ScrollArea を広げるにあたって、例えば上記の例であれば、テーブル外の R ～ Z 列のセルを選択させたくない場合は、シート保護の設定で [ロックされたセル範囲の選択] を無効にすることでセル選択を禁止できます。  </p><p><strong>設定手順:</strong><br>1. 選択させたくないセル (上記の例では R ～ Z 列) のセルを右クリックし、[セルの書式設定] – [保護] で [ロック] を有効にします。(既定では有効です。)</p><p>2. 反対に、選択を可能とするセル (上記の例では A ~ Q 列) は同様のメニューで、[ロック] を無効にします。</p><p>3. [校閲] タブ – [シートの保護] – “このシートのすべてのユーザーに許可する操作” の一覧で [ロックされたセル範囲の選択] のチェックを外します。</p><p><img src="image4.png" alt=""><br><img src="image5.png" alt=""></p><p>VBA などのプログラムからは、以下で設定できます。</p><p>Worksheet. EnableSelection プロパティ (Excel)<br><a href="https://docs.microsoft.com/ja-jp/office/vba/api/excel.worksheet.enableselection" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/office/vba/api/excel.worksheet.enableselection</a></p><p>このプロパティで xlUnlockedCells を設定します。このプロパティは、ワークシートを保護した状態でのみ有効ですので、さらに以下の Protect メソッドでワークシートを保護します。</p><p>Protect メソッド (Excel)<br><a href="https://docs.microsoft.com/ja-jp/office/vba/api/excel.worksheet.protect" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/office/vba/api/excel.worksheet.protect</a></p><p>また、選択セルの移動を制限することが ScrollArea プロパティを設定している目的である場合は、上記の設定を代わりに行うことで、ScrollArea プロパティの設定自体を削除することも検討できます。(ただし、スクロール バーの操作ではスクロールできます。)</p><p>ScrollArea 設定を削除する場合は、プログラムからは ScrollArea プロパティに空の値 (“”) を設定してください。プロパティ ウィンドウの場合は、ScrollArea プロパティの値を削除してください。  </p><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポート チームの中村です。&lt;/p&gt;
&lt;p&gt;Excel には、ワークシートのスクロール可能な範囲を設定する ScrollArea というシート プロパティが用意されています。本記事では、このScrollArea プロパティを設定したとき、キーボード
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>PowerPoint Online で日本語フォントが変更される</title>
    <link href="https://officesupportjp.github.io/blog/PowerPoint%20Online%20%E3%81%A7%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E3%81%8C%E5%A4%89%E6%9B%B4%E3%81%95%E3%82%8C%E3%82%8B/"/>
    <id>https://officesupportjp.github.io/blog/PowerPoint%20Online%20%E3%81%A7%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E3%81%8C%E5%A4%89%E6%9B%B4%E3%81%95%E3%82%8C%E3%82%8B/</id>
    <published>2020-12-03T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:04.999Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームです。</p><p>本記事では、PowerPoint Online で日本語フォントが異なるフォントで表示される問題について説明します。</p><p><strong>現象</strong></p><p>PowerPoint の表内の日本語フォントが、PowerPoint Online で表示すると異なるフォントで表示されます。</p><p>例えば、スライド マスターでテーマ フォントを Meiryo UI に設定しているプレゼンテーションで、PowerPoint Online 上では英数字用のフォント (例では Arial) で表示されます。</p><p><img src="image1.png" alt="">  </p><p><strong>原因</strong></p><p>この現象は問題としてフィードバックを行いました。</p><p><strong>回避策</strong></p><p>以下のいずれかの回避策で現象を回避できます。</p><p>1. 表のフォントを明示的に指定します。</p><p>スライド マスターでテーマ フォントを設定した場合、表のフォント自体は [+本文のフォント] となりますが、表のフォントを [Meiryo UI] など明示的に指定します。</p><p>2. 英数字用フォントを変更します。</p><p>スライド マスターでテーマ フォントの英数字用フォントとして、[Meiryo UI] など日本語に設定したいフォントを指定します。</p><p>新たな情報が確認された場合には、この記事に追記する形で公開していく予定です。</p><p>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポート チームです。&lt;/p&gt;
&lt;p&gt;本記事では、PowerPoint Online で日本語フォントが異なるフォントで表示される問題について説明します。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;現象&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;PowerPoint の
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Office 展開ツール (16.0.13328.20356) で生じる事象について</title>
    <link href="https://officesupportjp.github.io/blog/Office%20%E5%B1%95%E9%96%8B%E3%83%84%E3%83%BC%E3%83%AB%20(16.0.13328.20356)%20%E3%81%A7%E7%94%9F%E3%81%98%E3%82%8B%E4%BA%8B%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/Office%20%E5%B1%95%E9%96%8B%E3%83%84%E3%83%BC%E3%83%AB%20(16.0.13328.20356)%20%E3%81%A7%E7%94%9F%E3%81%98%E3%82%8B%E4%BA%8B%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2020-11-15T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:04.978Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。  </p><div style="color:#ff0000">  <p><strong>2020/11/19 記事の内容を更新しました</strong></p><p><strong>2020/11/24 記事の内容を更新しました</strong></p></div><p>Office 展開ツール (16.0.13328.20356) にて、以下の事象が報告されておりますのでご案内いたします。  </p><p><strong>【事象】</strong>  </p><p>Office 展開ツール (16.0.13328.20356) では、現時点で以下の事象が報告されております。  </p><p>1) XMLファイルの Logging 要素 Path 属性に定義したフォルダにログファイルが出力されない  </p><p>2) Office 展開ツールを管理者権限で実行しない場合、/download オプションでダウンロードが行えない  </p><p>3) XMLファイルの Add 要素 Version 属性を定義した場合、.cab ファイルがダウンロードされない</p><p><strong>- 参考</strong></p><p><a href="https://docs.microsoft.com/ja-jp/officeupdates/odt-release-history" target="_blank" rel="noopener"></a><a href="https://docs.microsoft.com/en-us/officeupdates/odt-release-history" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/officeupdates/odt-release-history</a>  </p><div style="color:#ff0000">  <p><strong>1) については、Office 展開ツールの仕様変更によるものとなります。今後、Logging 要素 Path 属性はご利用いただけません。</strong></p><p><strong>2) と 3) については、</strong></p><p><strong>最新の Office 展開ツールにて修正されておりますので、最新の Office 展開ツールをご利用いただきますようお願いいたします。</strong></p></div><p><strong>今回の投稿は以上です。</strong>  </p><p>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。  &lt;/p&gt;
&lt;div style=&quot;color:#ff0000&quot;&gt;  

&lt;p&gt;&lt;strong&gt;2020/11/19 記事の内容を更新しました&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2020/11/24 記
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Windows 10 バージョン 2004 以降で VBA 関数 StrComp() で全角カナと半角カナが一致判定されない</title>
    <link href="https://officesupportjp.github.io/blog/Windows%2010%20%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%202004%20(20H1)%20-%2020H2%20%E3%81%A7%20VBA%20%E9%96%A2%E6%95%B0%20StrComp()%20%E3%81%A7%E5%85%A8%E8%A7%92%E3%82%AB%E3%83%8A%E3%81%A8%E5%8D%8A%E8%A7%92%E3%82%AB%E3%83%8A%E3%81%8C%E4%B8%80%E8%87%B4%E5%88%A4%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%AA%E3%81%84/"/>
    <id>https://officesupportjp.github.io/blog/Windows%2010%20%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%202004%20(20H1)%20-%2020H2%20%E3%81%A7%20VBA%20%E9%96%A2%E6%95%B0%20StrComp()%20%E3%81%A7%E5%85%A8%E8%A7%92%E3%82%AB%E3%83%8A%E3%81%A8%E5%8D%8A%E8%A7%92%E3%82%AB%E3%83%8A%E3%81%8C%E4%B8%80%E8%87%B4%E5%88%A4%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%AA%E3%81%84/</id>
    <published>2020-11-11T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:05.010Z</updated>
    
    <content type="html"><![CDATA[<p><span style="color:#ff0000"><strong>2020/11/24 Update</strong></span><br><span style="color:#339966">「4. その他の発生シナリオ」セクションを追加し、Excel での検索・置換 (Find / Replace) での発生を追記しました。</span>  </p><p><span style="color:#ff0000"><strong>2021/10/22 Update</strong></span><br><span style="color:#339966">現象発生 OS と回避策に記載の対応を行った場合の既知の問題を追記しました。</span>  </p><p><span style="color:#ff0000"><strong>2021/10/18 Update</strong></span><br><span style="color:#339966">Windows 11 では修正済みであることを追記しました。</span>  </p><p>こんにちは、Office サポート チームの中村です。</p><p>先日、以下の記事で同じ原因により Access フォームで発生する問題について記載していますが、VBA 関数 StrComp() も影響を受けることが分かったため、本記事にて詳細をご案内します。  </p><p><strong>関連記事</strong></p><p>Windows 10 バージョン 2004 以降で 半角カナのフォームを含んだ Access ファイルでエラーが発生する<br><a href="https://officesupportjp.github.io/blog/Windows%2010%20%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%202004%20(20H1)%20-%2020H2%20%E4%B8%8A%E3%81%A7%20%E5%8D%8A%E8%A7%92%E3%82%AB%E3%83%8A%E3%81%AE%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0%E3%82%92%E5%90%AB%E3%82%93%E3%81%A0%20Access%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%8C%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B/">https://officesupportjp.github.io/blog/Windows 10 バージョン 2004 以降で 半角カナのフォームを含んだ Access ファイルでエラーが発生する/</a>  </p><h4 id="1-現象"><a href="#1-現象" class="headerlink" title="1. 現象"></a><strong>1. 現象</strong></h4><p>VBA には、StrComp() という 2 つの文字列が一致するかを比較する関数が用意されています。</p><p>StrComp 関数<br><a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/strcomp-function" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/strcomp-function</a>  </p><p>例えば以下のサンプル コードのように、濁点または半濁点を含む文字列を、一方は全角、もう一方を半角で比較すると、以前の OS では一致とみなされ 0 が返っていました。</p><p>しかし、Windows 10 バージョン 2004 以降の OS 上で実行すると、不一致を示す -1 が返ります。  </p><p>&lt;サンプル コード&gt;</p><pre><code>Sub Sample()    MsgBox StrComp(&quot;サンプル&quot;, &quot;ｻﾝﾌﾟﾙ&quot;, vbTextCompare)End Sub</code></pre><p>本現象は、Office バージョンに関係なく発生します。  </p><h4 id="2-原因"><a href="#2-原因" class="headerlink" title="2. 原因"></a><strong>2. 原因</strong></h4><p>Windows 10 バージョン 2004 で、OS の自然言語処理を担う NLS (National Language Support) バージョンが更新されました。</p><p>&lt;OS バージョンと NLS バージョン&gt;  </p><table><thead><tr><th align="left">OS バージョン</th><th align="left">NLS バージョン</th></tr></thead><tbody><tr><td align="left">Windows 10 バージョン 1909</td><td align="left">6.2</td></tr><tr><td align="left">Windows 10 バージョン 2004 以降</td><td align="left">6.3</td></tr><tr><td align="left">Windows 11</td><td align="left">6.4</td></tr></tbody></table><p>この新しいバージョン 6.3 の NLS ソート テーブルにて、濁点および半濁点を含むカナ文字について、半角と全角が異なる文字と認識される問題の影響で現象が発生します。上記の例の場合、”プ” (全角) と “ﾌﾟ” (半角) が違う文字と判定されます。</p><p>この問題は、OS の更新プログラムについての公開情報でも既知の問題として記載されています。</p><p>Current status of Windows 10, version 2004 and Windows Server, version 2004<br><a href="https://support.microsoft.com/en-us/topic/windows-10-update-history-24ea91f4-36e7-d8fd-0ddb-d79d9d0cdbda" target="_blank" rel="noopener">https://support.microsoft.com/en-us/topic/windows-10-update-history-24ea91f4-36e7-d8fd-0ddb-d79d9d0cdbda</a></p><p>Windows 10 update history - Updates for Windows 10, version 20H2 and Windows Server, version 20H2<br><a href="https://support.microsoft.com/en-us/topic/windows-10-update-history-7dd3071a-3906-fa2c-c342-f7f86728a6e3" target="_blank" rel="noopener">https://support.microsoft.com/en-us/topic/windows-10-update-history-7dd3071a-3906-fa2c-c342-f7f86728a6e3</a></p><p>Windows 10 update history - Updates for Windows 10, version 21H1<br><a href="https://support.microsoft.com/en-us/topic/windows-10-update-history-1b6aac92-bf01-42b5-b158-f80c6d93eb11" target="_blank" rel="noopener">https://support.microsoft.com/en-us/topic/windows-10-update-history-1b6aac92-bf01-42b5-b158-f80c6d93eb11</a></p><p>&lt;公開情報より該当の記載を抜粋&gt;</p><table><thead><tr><th align="left"><strong>Symptom</strong></th><th align="left"><strong>Workaround</strong></th></tr></thead><tbody><tr><td align="left">Certain Japanese half-width Katakana and full-width Katakana characters that have a consonant mark aren’t interpreted as the same character. When you use the <strong>CompareStringEx()</strong> function with the <em>NORM_IGNOREWIDTH</em> flag to compare them, these characters are evaluated as different because of an issue in the sorting rule<strong>.</strong> This issue affects all the updates starting on June 9, 2020 for Windows 10, version 2004.</td><td align="left">Currently, there is no workaround for this issue.</td></tr></tbody></table><p>※ 次期リリース予定の Windows 10 バージョン 21H2 においても引き続きこの問題は発生します。</p><h4 id="3-対応状況-回避策"><a href="#3-対応状況-回避策" class="headerlink" title="3. 対応状況 / 回避策"></a><strong>3. 対応状況 / 回避策</strong></h4><p>Windows 11 では、NLS バージョン 6.4 に更新され、この問題は修正されています。<br>Windows 10 の現象が発生するバージョンでは、以下のいずれかの回避策で現象を回避できます。</p><p><strong>a.</strong> <strong>比較対象の文字列を全角、または半角に統一する</strong></p><p>実際の VBA コードでは、値は VBA 定数、Excel シート上のセルの値や Access データベースのテーブルの値、ユーザーフォームなど、様々な場所から取得されることが想定されます。VBA コード取得元となる文字列を探して全角 / 半角が統一されるよう変更します。  </p><p><strong>b. StrConv</strong> <strong>関数で全角、または半角に統一してから比較する</strong></p><p>複雑なコードで比較対象文字列の取得元を特定することが困難な場合や、ユーザーが入力するため制御が難しい場合などには、StrConv 関数を用いて全角または半角に変換してから、StrComp 関数の比較に使用することが検討できます。</p><p>StrConv 関数<br><a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/strconv-function" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/strconv-function</a></p><p>&lt;回避案 b サンプル コード&gt;</p><p>以下の例では、比較する文字列を両方とも全角カナに変換しています。</p><pre><code>Sub Sample()    str1 = &quot;サンプル&quot;    str2 = &quot;ｻﾝﾌﾟﾙ&quot;    MsgBox StrComp(StrConv(str1, vbWide), StrConv(str2, vbWide), vbTextCompare)End Sub</code></pre><p>基本的には、上記の a. / b. いずれかの方法での対応を強く推奨します。</p><p>ただ、ファイルや VBA の変更が難しい場合などには、クライアントの環境設定による以下の回避策もあります。いずれも、Office の他の動作や、OS 全体に影響を及ぼす設定となるため、以下 c. / d. 案を利用する場合は、影響に十分にご留意ください。  </p><p><strong>c. Office</strong> <strong>モジュールを互換モードに設定する</strong></p><p>Office アプリケーションの実行モジュールを互換モードで動作するよう設定すると、古い NLS バージョンを使用するため現象が発生しません。</p><p>主な Office アプリケーションの実行モジュール名は以下になります。</p><p>Excel : EXCEL.EXE<br>Word : WINWORD.EXE<br>PowerPoint : POWERPNT.EXE<br>Access : MSACCESS.EXE</p><p>互換モードに変更したアプリケーションでの全ての動作が互換モードになるため、Windows 10 OS で新たにサポートされた機能を前提とした機能が動作しなくなるなどの影響が生じる場合があります。(例 : Excel の [オプション] – [全般] にある “複数ディスプレイを使用する場合” で [表示を優先した最適化] を選択することができなくなります)  </p><p><strong>d. レジストリを使用して NLS バージョンを以前のバージョン (6.2) に変更する</strong></p><p>システム全体で影響を受けるため、Office 以外のアプリケーションも以前の NLS バージョンを使用するようになります。アプリケーションの実装やビジネスロジックによっては、ソートの整合が崩れたり、データが不正となる可能性があります。</p><p>c. / d. の具体的な設定方法や注意点については、既に公開された Access フォームの現象をご案内する以下のフォーラム記事で説明していますので、こちらを参照してください。</p><p>Windows 10 バージョン 2004 以降で 半角カナのフォームを含んだ Access ファイルでエラーが発生する<br><a href="https://officesupportjp.github.io/blog/Windows%2010%20%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%202004%20(20H1)%20-%2020H2%20%E4%B8%8A%E3%81%A7%20%E5%8D%8A%E8%A7%92%E3%82%AB%E3%83%8A%E3%81%AE%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0%E3%82%92%E5%90%AB%E3%82%93%E3%81%A0%20Access%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%8C%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B/">https://officesupportjp.github.io/blog/Windows 10 バージョン 2004 以降で 半角カナのフォームを含んだ Access ファイルでエラーが発生する/</a></p><p>※ 参照箇所<br>c 案 : 3-1. Access アプリケーション観点 - Access の EXE (MSACCESS.EXE) について、”Windows 8” の互換設定を行う<br>d 案 : 3-3. OS 観点 – Windows OS の NLS バージョンを 6.3 から 6.2 に変更する  </p><p><strong>注意</strong><br>この d 案の設定を行うと、Windows のライセンス認証が行われない場合があることを確認しています。ライセンス認証を実行する際はこの変更を元に戻してから実行してください。</p><h4 id="4-その他の発生シナリオ"><a href="#4-その他の発生シナリオ" class="headerlink" title="4. その他の発生シナリオ"></a><strong>4. その他の発生シナリオ</strong></h4><p>ここまで、一般に利用頻度の比較的高い StrComp() での発生シナリオを中心に説明してきましたが、内部的に文字の比較を行う以下の機能でも同様の問題による現象が発生します。  </p><p>・Range.Find() / Range.FindNext() / Range.FindPrevious() メソッドによる検索や Range.Replace() メソッドによる置換で、濁点・半濁点を含む半角カナと全角カナが一致判定されません。<br>※ 手動での検索や置換も同様です。</p><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;span style=&quot;color:#ff0000&quot;&gt;&lt;strong&gt;2020/11/24 Update&lt;/strong&gt;&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;color:#339966&quot;&gt;「4. その他の発生シナリオ」セクションを追加し、Excel での検索・
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Excel for Microsoft 365 で上書きモードで DBCS を 1 文字を編集すると 2 文字分上書きされる</title>
    <link href="https://officesupportjp.github.io/blog/Excel%20for%20Microsoft%20365%20%E3%81%A7%E4%B8%8A%E6%9B%B8%E3%81%8D%E3%83%A2%E3%83%BC%E3%83%89%E3%81%A7%20DBCS%20%E3%82%92%201%20%E6%96%87%E5%AD%97%E3%82%92%E7%B7%A8%E9%9B%86%E3%81%99%E3%82%8B%E3%81%A8%202%20%E6%96%87%E5%AD%97%E5%88%86%E4%B8%8A%E6%9B%B8%E3%81%8D%E3%81%95%E3%82%8C%E3%82%8B/"/>
    <id>https://officesupportjp.github.io/blog/Excel%20for%20Microsoft%20365%20%E3%81%A7%E4%B8%8A%E6%9B%B8%E3%81%8D%E3%83%A2%E3%83%BC%E3%83%89%E3%81%A7%20DBCS%20%E3%82%92%201%20%E6%96%87%E5%AD%97%E3%82%92%E7%B7%A8%E9%9B%86%E3%81%99%E3%82%8B%E3%81%A8%202%20%E6%96%87%E5%AD%97%E5%88%86%E4%B8%8A%E6%9B%B8%E3%81%8D%E3%81%95%E3%82%8C%E3%82%8B/</id>
    <published>2020-10-19T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:04.806Z</updated>
    
    <content type="html"><![CDATA[<p><span style="color:#ff0000"><strong>【最終更新日: 2021/02/10】</strong></span></p><p>こんにちは、Office サポートです。<br>本記事では新たに確認された、Excel for Microsoft 365 で上書きモードで DBCS を 1 文字を編集すると 2 文字分上書きされる問題について説明します。  </p><p><strong>現象</strong><br>Excel for Microsoft 365 で Insert キーを押下し、<br>上書きモードで DBCS (2 バイト文字) を編集すると、意図せず 2 文字ぶん上書きされます。  </p><p><strong>再現手順</strong><br>例) 「あい<strong>う</strong>えお」を「あい<strong>か</strong>えお」に直したい場合</p><p>1. 任意のセルに、「あいうえお」と入力します。<br>2.「う」のまえにカーソル入れます。<br>3. [insert] キーで上書きモードにします。</p><p><img src="image1.png" alt=""></p><p>4.「か」と入力し、確定のため [Enter] キーを押します。</p><p>結果 :<br>「う」と「え」の部分が、「か」で上書きされて、「あいかお」になります。  </p><p><img src="image2.png" alt=""></p><p>期待する結果は、「あいかえお」です。  </p><p><strong>解決方法</strong>  </p><p>以下の更新チャネル/バージョンで修正しました。<br>下記以降の更新チャネル/バージョンに更新することで解決します。</p><p>　最新チャネル (プレビュー) : バージョン 2012 (ビルド 13530.20064)<br>　最新チャネル : バージョン 2012 (ビルド 13530.20316)<br>　半期エンタープライズ チャネル (プレビュー) : バージョン 2008 (ビルド 13127.21064)<br>　半期エンタープライズ チャネル : バージョン 2008 (ビルド 13127.21064)</p><p>　月次エンタープライズ チャネル : バージョン 2012 (ビルド 13530.20528)</p><p><strong>回避策</strong><br>[insert] キーで挿入モードに切り替えて、編集します。  </p><p><strong>状況</strong><br>マイクロソフトでは、この問題をこの資料の対象製品として記載されているマイクロソフト製品の問題として認識しています  </p><p><strong>更新履歴</strong><br>2021/01/14 : 解決方法を追加しました。</p><p>2021/02/10 : 解決方法に、月次エンタープライズ チャネルを追加しました。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;span style=&quot;color:#ff0000&quot;&gt;&lt;strong&gt;【最終更新日: 2021/02/10】&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;こんにちは、Office サポートです。&lt;br&gt;本記事では新たに確認された、Excel for Microsoft 
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>VDI 環境における Microsoft 365 Apps のライセンス認証について</title>
    <link href="https://officesupportjp.github.io/blog/VDI%20%E7%92%B0%E5%A2%83%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%20Microsoft%20365%20Apps%20%E3%81%AE%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E8%AA%8D%E8%A8%BC%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/VDI%20%E7%92%B0%E5%A2%83%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%20Microsoft%20365%20Apps%20%E3%81%AE%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E8%AA%8D%E8%A8%BC%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2020-10-11T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:05.010Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。</p><p>今回の投稿では、VDI 環境における M365Apps のライセンス認証についてご案内します。</p><p>お問い合わせいただく中では、共有 VDI 上に M365Apps をインストールしたいというご要望をいただくことがあります。</p><p>共有 VDI では、ユーザーが不特定の端末にログオンする場合があるため、M365Apps の 5 台の制限にかかってしまいます。</p><p>この場合、M365Apps では以下の共有コンピュータライセンス認証のソリューションが用意されています。</p><p>Microsoft 365 Apps に対する共有コンピューターのライセンス認証の概要</p><p><a href="https://docs.microsoft.com/ja-jp/deployoffice/overview-shared-computer-activation" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/deployoffice/overview-shared-computer-activation</a></p><p>記載の通り、共有コンピューターのライセンス認証を利用して M365Apps を使用する場合、この台数制限の対象にはなりません。 </p><p>ただし、以下の注意点がありますので、ご参考にしてください。</p><ul><li><p>常にインターネット接続ができる環境で使用すること<br>以下のエンドポイントに接続できる必要があります。  </p><p>Office 365 URL および IP アドレス範囲<br><a href="https://docs.microsoft.com/ja-jp/microsoft-365/enterprise/urls-and-ip-address-ranges?view=o365-worldwide" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/microsoft-365/enterprise/urls-and-ip-address-ranges?view=o365-worldwide  </a>  </p></li><li><p>“ライセンス認証の制限” について<br>記事内の本項目は、基本的に悪意のあるシステム等に断続的にライセンス認証を行われた場合を想定しています。<br>通常、一般的なご利用の範囲で、本エラーに遭遇することはございません。  </p></li></ul><ul><li><p>シングルサインオン環境が必須であること<br>記事内では “ライセンス トークンの移動” について触れられていますが、”ライセンストークンの移動” を実施しても、次回 OS にログオンし M365Apps を起動すると、アカウント画面に警告が表示されたり、サインイン画面が表示されたりします。  </p><p>M365Apps では、ライセンストークンと O365 サービスへの接続情報を分けて %localappdata% 配下に保持しています。<br>ライセンストークンをローミング対象にすることはできますが、O365 サービスへの接続情報をローミング対象にすることはできません。<br>共有 VDI 環境でログオフ時に %localappdata% が失われる構成の場合、O365 サービスへの接続情報が失われるため、次回 OS にログオンし M365Apps を起動すると、アカウント画面に警告が表示されたり、サインイン画面が表示されたりするため、シングルサインオンが必須となります。<br>なお、移動ユーザー プロファイル等で %localappdata% をローミング対象とするのは非推奨となりますが、ご利用の環境において失われない方法があるかはご利用されている製品観点でご確認ください。  </p><p>シングルサインオンについては、ADFS やシームレスシングルサインオンを使用したユーザ対話がなくサインインできる方式をご検討ください。<br>Azure Active Directory シームレス シングル サインオンとは<br><a href="https://docs.microsoft.com/ja-jp/azure/active-directory/hybrid/how-to-connect-sso" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/azure/active-directory/hybrid/how-to-connect-sso</a></p></li><li><p>デバイス登録の無効化について<br>Microsoft 365 Apps でサインインをする際、以下の画面が表示される場合があります。  </p><p><img src="image1.png" alt=""><br>チェック オンに設定すると、Intune のライセンスを保有しており Windows の自動登録が可能な場合、Intune および Azure AD にデバイス登録が行われ、[職場または学校にアクセスする]にアカウントが追加されます。<br>チェックをオフとすると、Azure AD にデバイス登録が行われ、[職場または学校にアクセスする]にアカウントが追加されます。<br>“このアプリのみ” をクリックすると、認証情報は Office でのみ管理されます。[職場または学校にアクセスする]にアカウントは追加されません。  </p><p>そのため、デバイス登録が不要であれば、Windows 10 Ver 1803 (KB4489894 適用済) 以降の OS においては以下のレジストリを設定していただくと、この画面は表示されず “このアプリのみ” をクリックした際と同等の動作となります。<br><a href="https://docs.microsoft.com/ja-jp/azure/active-directory/devices/hybrid-azuread-join-plan" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/azure/active-directory/devices/hybrid-azuread-join-plan</a><br>-—– 抜粋開始 —–<br>次のレジストリ値を HKLM\SOFTWARE\Policies\Microsoft\Windows\WorkplaceJoin に追加すると、ドメイン参加済みデバイスが Azure AD 登録済みになることを防ぐことができます:”BlockAADWorkplaceJoin”=dword:00000001。<br>-—– 抜粋終了 —–</p></li></ul><p>今回の投稿は以上です。</p><p><strong>2020/10/16 : デバイス登録の無効化について説明を追記しました。</strong></p><p><strong>2020/10/28 : デバイス登録の無効化について、および、シングルサインオンが必須の理由の説明を変更しました。</strong></p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。&lt;/p&gt;
&lt;p&gt;今回の投稿では、VDI 環境における M365Apps のライセンス認証についてご案内します。&lt;/p&gt;
&lt;p&gt;お問い合わせいただく中では、共有 VDI 上に M365Apps をインストールしたいという
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>モバイル版の Office のトラブルシューティングについて</title>
    <link href="https://officesupportjp.github.io/blog/%E3%83%A2%E3%83%90%E3%82%A4%E3%83%AB%E7%89%88%E3%81%AE%20Office%20%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/%E3%83%A2%E3%83%90%E3%82%A4%E3%83%AB%E7%89%88%E3%81%AE%20Office%20%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2020-10-01T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:05.057Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。  </p><p>今回の投稿では、モバイル版の Office のトラブルシューティングについてご案内します。</p><p>Android や iOS で Office アプリケーションにおいて、以下のようなお問い合わせをいただくことがあります。</p><p>・サインインができない</p><p>・ファイルが開けない</p><p>この場合、以下の手順でリセットすることで、事象が解消する可能性があります。</p><p><strong>iOS の場合</strong><br>1. iOS の [設定]-[&lt;Office もしくは アプリ名&gt;] をタップします。<br>2. [&lt;Office もしくは アプリ名&gt;] をタップし、[ログイン資格情報の削除] 等のトグルを有効にします。<br>3. アプリケーションを再起動します。  </p><p><strong>android の場合</strong><br>1. android の [設定]- [アカウント] - “Office” をタップします。<br>2. [アカウントを削除] を行います</p><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。  &lt;/p&gt;
&lt;p&gt;今回の投稿では、モバイル版の Office のトラブルシューティングについてご案内します。&lt;/p&gt;
&lt;p&gt;Android や iOS で Office アプリケーションにおいて、以下のようなお問い合
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>MSI 版の Office 2016 で SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象について</title>
    <link href="https://officesupportjp.github.io/blog/MSI%20%E7%89%88%E3%81%AE%20Office%202016%20%E3%81%A7%20SPO%E3%80%81OneDrive%E3%80%81WebDav%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%8B%E3%82%89%20Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C%E9%96%8B%E3%81%8B%E3%81%AA%E3%81%84%E3%80%81%E4%BF%9D%E5%AD%98%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E7%8F%BE%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/"/>
    <id>https://officesupportjp.github.io/blog/MSI%20%E7%89%88%E3%81%AE%20Office%202016%20%E3%81%A7%20SPO%E3%80%81OneDrive%E3%80%81WebDav%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%8B%E3%82%89%20Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C%E9%96%8B%E3%81%8B%E3%81%AA%E3%81%84%E3%80%81%E4%BF%9D%E5%AD%98%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E7%8F%BE%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/</id>
    <published>2020-09-22T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:04.837Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。</p><p>今回の投稿では、MSI 版の Office 2016 で SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象について説明します。</p><p><a href="https://officesupportjp.github.io/blog/%E3%82%AF%E3%82%A4%E3%83%83%E3%82%AF%E5%AE%9F%E8%A1%8C%E5%BD%A2%E5%BC%8F%20(C2R)%20%E3%81%A8%20Windows%20%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%A9%E3%83%BC%E5%BD%A2%E5%BC%8F%20(MSI)%20%E3%82%92%E8%A6%8B%E5%88%86%E3%81%91%E3%82%8B%E6%96%B9%E6%B3%95/">MSI 版の Office 2016 とは？</a></p><p>以下の Blog 記事のとおり、「SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない」現象についてお問い合わせいただく場合があります。</p><p>Title : SharePoint Server など WebDAV が有効なサーバーから Office ファイルが開かない、保存できない現象について<br>URL : <a href="https://officesupportjp.github.io/blog/SharePoint%20Server%20%E3%81%AA%E3%81%A9%20WebDAV%20%E3%81%8C%E6%9C%89%E5%8A%B9%E3%81%AA%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%8B%E3%82%89%20Office%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C%E9%96%8B%E3%81%8B%E3%81%AA%E3%81%84%E3%80%81%E4%BF%9D%E5%AD%98%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E7%8F%BE%E8%B1%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/">https://officesupportjp.github.io/blog/SharePoint Server など WebDAV が有効なサーバーから Office ファイルが開かない、保存できない現象について</a>  </p><p>上記の Blog 記事の方法では改善せず、ご利用されているのが MSI 版の Office 2016 の場合、セキュリティ更新のみ等、限定的に更新プログラムを適用していることに起因している可能性があります。</p><p>この場合、Microsoft Update を適用するか、少なくとも、以下のモジュールの更新プログラムを適用し、事象が回避するかをご確認いただくと解消する可能性があります。</p><p><strong>&lt;実施方法&gt;</strong></p><p>URL を開き、以下に列挙するモジュールの “Non-security” と “Security release” の日付を比較し、新しい方の KB の更新プログラムを適用してください。</p><p>なお、”Security KB superseded” は “置き換えられたセキュリティ更新の KB” を意味いたしますので、適用する必要はありません。</p><p>Title : List of the most current .msp files for Office 2016 products<br>URL : <a href="https://docs.microsoft.com/en-us/officeupdates/msp-files-office-2016" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/officeupdates/msp-files-office-2016</a></p><p>・ace-x-none<br>・csi-x-none<br>・mso-x-none<br>・msodll20-x-none<br>・msodll30-x-none<br>・msodll40ui-x-none<br>・msodll99l-x-none<br>・orgidcrl-x-none<br>・msmipc-x-none</p><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。&lt;/p&gt;
&lt;p&gt;今回の投稿では、MSI 版の Office 2016 で SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象について説明します。&lt;/p&gt;
&lt;p&gt;&lt;a 
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Office 展開ツール (16.0.12827.20268) で RemoveMSI 属性を使用すると 30041-1039-30050-1039 等のエラーメッセージが表示される</title>
    <link href="https://officesupportjp.github.io/blog/Office%20%E5%B1%95%E9%96%8B%E3%83%84%E3%83%BC%E3%83%AB%20(16.0.12827.20268)%20%E3%81%A7%20RemoveMSI%20%E5%B1%9E%E6%80%A7%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%81%A8%2030041-1039-30050-1039%20%E7%AD%89%E3%81%AE%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%81%8C%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B/"/>
    <id>https://officesupportjp.github.io/blog/Office%20%E5%B1%95%E9%96%8B%E3%83%84%E3%83%BC%E3%83%AB%20(16.0.12827.20268)%20%E3%81%A7%20RemoveMSI%20%E5%B1%9E%E6%80%A7%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%81%A8%2030041-1039-30050-1039%20%E7%AD%89%E3%81%AE%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%81%8C%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B/</id>
    <published>2020-09-14T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:04.963Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。</p><p>表題の件について、既知の事象が報告されておりますのでご案内いたします。</p><p><strong>【事象】</strong>  </p><p>Office 展開ツール (16.0.12827.20268) で 30041-1039 や 30050-1039 のエラーメッセージが表示される</p><p><strong>【説明】</strong>  </p><p>本事象は 2020/6/9 にリリースされた Office 展開ツール (Version 16.0.12827.20268) に起因した事象である可能性がございます。</p><p>当該バージョンの Office 展開ツールでは、RemoveMSI 属性 で Office 2007 製品もアンインストールが可能となりましたが、<br>バージョン番号が “12” から始まる一部の MSI インストール形式の製品がインストールされている環境で、アンインストールが失敗しエラーとなる事象が発生しております。</p><div style="color:#ff0000">本事象は、最新の Office 展開ツールで改善されておりますので、最新の Office 展開ツールをご利用いただきますようお願いいたします。<p>Title : Release history for Office Deployment Tool<br>URL : <a href="https://docs.microsoft.com/en-us/officeupdates/odt-release-history" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/officeupdates/odt-release-history</a><br>-—————抜粋開始—————-  </p><p>October 29, 2020<br>Version 16.0.13328.20292 (setup.exe version 16.0.13328.20290)<br>• Resolves an issue where certain Office 2007 products may unexpectedly block installation when using RemoveMSI  </p><p>-—————抜粋終了—————-  </p><p>Title : Office Deployment Tool<br>URL : <a href="https://www.microsoft.com/en-us/download/details.aspx?id=49117" target="_blank" rel="noopener">https://www.microsoft.com/en-us/download/details.aspx?id=49117</a>  </p></div><p><del>本不具合については、リリース時期はまだ未定ですが、次期バージョンの ODT で修正される見込みとなっております</del></p><p><del><strong>【回避策】</strong></del>  </p><p><del>以下の何れかの回避策をご実施いただけますようお願いいたします。</del></p><p><del>・Office 2007 製品をコントロールパネルからアンインストールするか、以下の資料の OffScrub07.vbs により Office 2007 製品をアンインストールしてください。</del>  </p><p><del><a href="https://github.com/OfficeDev/Office-IT-Pro-Deployment-Scripts/tree/master/Office-ProPlus-Deployment/Remove-PreviousOfficeInstalls" target="_blank" rel="noopener">https://github.com/OfficeDev/Office-IT-Pro-Deployment-Scripts/tree/master/Office-ProPlus-Deployment/Remove-PreviousOfficeInstalls</a></del>  </p><p><del>・RemoveMSI 属性を削除してください</del></p><p><del><strong>【参考】</strong></del>  </p><p><del>Release history for Office Deployment Tool</del></p><p><del><a href="https://docs.microsoft.com/en-us/officeupdates/odt-release-history" target="_blank" rel="noopener"></a><a href="https://docs.microsoft.com/en-us/officeupdates/odt-release-history" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/officeupdates/odt-release-history</a></del>  </p><p><strong>2020/10/15 :</strong> <strong>回避策について説明を追記しました。</strong></p><p><strong>2020/10/30 :</strong> <strong>回避策について対応バージョンを変更しました。</strong></p><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポートの西川 (直) です。&lt;/p&gt;
&lt;p&gt;表題の件について、既知の事象が報告されておりますのでご案内いたします。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;【事象】&lt;/strong&gt;  &lt;/p&gt;
&lt;p&gt;Office 展開ツール (16.0.12827.20
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Windows 10 バージョン 2004 以降で 半角カナのフォームを含んだ Access ファイルでエラーが発生する</title>
    <link href="https://officesupportjp.github.io/blog/Windows%2010%20%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%202004%20(20H1)%20-%2020H2%20%E4%B8%8A%E3%81%A7%20%E5%8D%8A%E8%A7%92%E3%82%AB%E3%83%8A%E3%81%AE%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0%E3%82%92%E5%90%AB%E3%82%93%E3%81%A0%20Access%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%8C%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B/"/>
    <id>https://officesupportjp.github.io/blog/Windows%2010%20%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%202004%20(20H1)%20-%2020H2%20%E4%B8%8A%E3%81%A7%20%E5%8D%8A%E8%A7%92%E3%82%AB%E3%83%8A%E3%81%AE%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0%E3%82%92%E5%90%AB%E3%82%93%E3%81%A0%20Access%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%A7%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%8C%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B/</id>
    <published>2020-08-23T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:05.010Z</updated>
    
    <content type="html"><![CDATA[<div style="color:#ff0000">※2020/10/28 OS 観点での回避方法 (3-3) を追加しました。<p>※2021/06/03 OS 21H1 も本現象の発生対象バージョンであることを追加しました。</p><p>※2021/10/18 OS 21H2 も本現象の発生対象バージョンであること、回避方法の補足、今後の修正について追記しました。</p></div><p>こんにちは、Office サポート チームの佐村です。</p><p>今回の記事では、Windows 10 バージョン 2004 上で半角カナ + カナに濁音 / 半濁音を含んでいる Access ファイルを開くとエラーが発生する状況について説明します。</p><p>(Access のバージョンに依存性はなく Windows 10 バージョン 2004 / 20H2 / 21H1 / 21H2 上での Access アプリケーションで発生します。)</p><p><strong>1.</strong> <strong>現象</strong></p><p>Windows 10 バージョン 2004 以降で Access ファイルを開いた時、VBA を実行しようとしたとき、VBA プロジェクトを開こうとしたとき等に以下のようなエラーが発生する可能性があります。</p><p>・フォーム名 ‘半角カナを含んだフォーム名’ が正しくないか、存在しないフォームを参照しています。</p><p><img src="image1.png" alt=""></p><p>・データベースに含まれている VBA プロジェクトを読み取れないため、データベースを開くことができません。</p><p> <img src="image2.png" alt=""></p><p>「データベースに含まれている VBA プロジェクトを～」のエラーダイアログで「OK」ボタンをクリックするとファイルに保存されている VBA プロジェクトが全て削除され、Access ファイルは操作の都度保存されるため VBA プロジェクトが削除された状態でファイルが自動保存されてしまい、コードが消失して復元ができなくなる可能性があります。</p><p><span style="color:#ff0000">また、フォームとの不整合状態が保持されることで以前の OS 上の Access で該当のファイルを開いても VBA が正しく参照できないといった問題が発生します。</span></p><p>この動作が生じる条件は以下になります。 </p><p><strong>問題発生条件</strong></p><p>・Windows 10 OS バージョン 2004 <span style="color:#ff0000">以降</span> である。<span style="color:#ff0000">(Windows 11 では本現象は発生しません。)</span></p><p>・Access ファイル内のフォーム名に半角カタカナを利用して濁音、半濁音のいずれかが含まれている。</p><p>この条件を満たす場合、フォームに紐づく VBA プロジェクトが存在している場合や、半角カナのサブフォームを指定する際に全角で指定していると上記であげたエラーが発生します。</p><p><strong>2.</strong> <strong>原因の説明</strong></p><p>Access アプリケーションでは、フォーム名に関して OS で用意している機能を利用し、半角と全角とを区別せずに比較しています。</p><p>そのため、以前の OS では “ガ” と “ガ” のような全角 / 半角は同じ文字列として判定されていましたが、Windows 10 バージョン 2004 <span style="color:#ff0000">以降</span> では OS の自然言語処理を担う NLS (National Language Support) バージョンが更新 (6.3) され異なる文字列として判定されてしまいます。</p><p>これによって内部管理上同じとみなされることが期待されるフォームが異なるものとして認識されるためにエラーが発生します。</p><p><strong>3.</strong> <strong>対応方法</strong><br>本問題について確認し、修正方法を検討いたしましたが、更新プログラム等で現在のバージョンに対する更新は仕様上出来ないことを確認いたしました。</p><p>自然言語処理を担う NLS の定義に基づいて発生している問題となりますが、NLS の性質上、既存のモジュールと修正されたモジュールがネットワークシステム上で混在すると解決の難しい不整合が生じる可能性があり、そのような状況を避けるため一度リリースされたバージョンの内容を修正することができません。</p><p>このため、問題があった場合には新しいバージョンの NLS を開発して新しい OS とともにリリースする必要があります。</p><div style="color:#ff0000">現在のところ、本問題を修正した Windows 10 バージョンのリリース予定については未定となります。  Windows 11 では、NLS バージョンが更新されているため、この問題は修正されています。  これらのことから、Windows 10 バージョン 2004 以降 においては、利用者様にて問題が発生しないように対応をしていただく必要があります。</div><p><strong>3-1. Access</strong> <strong>アプリケーション観点 - Access の EXE (MSACCESS.EXE) について、”Windows 8” の互換設定を行う</strong></p><p>エクスプローラーで MSACCESS.EXE までを展開し、MSACCESS.EXE のプロパティから互換モードで動作するように変更します。</p><p><img src="image3.png" alt=""></p><p>※OfficeNN バージョン番号</p><p>Office16 : Microsoft 365 Apps (Office 365 ProPlus) / Office 2019 / Office 2016</p><p>Office15 : Office 2013</p><p>Office14 : Office 2010</p><p>-ご参考</p><p>タイトル : クイック実行形式 (C2R) と Windows インストーラー形式 (MSI) を見分ける方法<br>URL : <a href="https://officesupportjp.github.io/blog/%E3%82%AF%E3%82%A4%E3%83%83%E3%82%AF%E5%AE%9F%E8%A1%8C%E5%BD%A2%E5%BC%8F%20(C2R)%20%E3%81%A8%20Windows%20%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%A9%E3%83%BC%E5%BD%A2%E5%BC%8F%20(MSI)%20%E3%82%92%E8%A6%8B%E5%88%86%E3%81%91%E3%82%8B%E6%96%B9%E6%B3%95/">https://officesupportjp.github.io/blog/クイック実行形式 (C2R) と Windows インストーラー形式 (MSI) を見分ける方法/</a></p><p>&lt;設定変更方法 (C2R版 Office の場合)&gt;</p><p>-———————–</p><p>・エクスプローラー上から、MSACCESS.EXE を右クリックし、「プロパティ」を選択します。</p><p>・MSACCESS.EXE のプロパティ画面で「互換性」タブを選択します。</p><p>・「互換モードでこのプログラムを実行する」のチェックを ON にしてターゲットとして Windows 8 が選択されていることを確認します。</p><p>・「OK」ボタンをクリックします。</p><p>※元の設定に戻す場合は「互換モードでこのプログラムを実行する」のチェックを OFF にします</p><p>-———————–<br><br /></p><p>&lt;設定変更方法 (MSI版 Office の場合)&gt;</p><p>-———————–</p><p>・エクスプローラー上から、MSACCESS.EXE を右クリックし、「互換性のトラブルシューティング」を選択します。</p><p>・「推奨設定を使用する」を選択する。</p><p>・Windows 互換モード : Windows 8 となっていることを確認し「プログラムのテスト」ボタンをクリックします。</p><p>・Access アプリケーションが起動したら×ボタンで閉じて「次へ」ボタンをクリックします。</p><p>・「はい、このプログラムのこの設定を保存します」を選択します。</p><p>・「閉じる」ボタンでトラブルシューティングツールを閉じます。</p><p>※元の設定に戻す場合は以下のレジストリ配下の MSACCESS への設定を削除します。</p><p>HKCU\Software\Microsoft\Windows NT\CurrentVersion\AppCompactFlags\Layers</p><p>-———————–</p><p>なお、Access をはじめ Office アプリケーションは互換性を変更した検証は実施しておらず、</p><p>互換性を変更して動作させた場合に、予期しない動作が発生することがございます。</p><p><strong>3-2. Access</strong> <strong>ファイル観点 - Access のフォームで半角カタカナを全角カタカナに変更する</strong></p><p>Windows 10 の OS 1909 等、以前の問題が発生しない OS バージョンでフォーム等の半角カタカナを全角カタカナに統一します。</p><p>VBA コードに半角カナでフォームを指定している場合等、半角カタカナのフォームを参照している処理は全角カナに修正する必要があります。</p><p><span style="color:#ff0000"><strong>3-3. OS</strong> <strong>観点 – Windows OS の NLS バージョンを 6.3 から 6.2 に変更する</span></strong></p><p>問題の発生しない NLS バージョン 6.2 (以前の OS で利用されていたバージョン) を利用することで本問題は発生しません。レジストリを変更して対処する必要があります。</p><p>&lt;レジストリ NLS\Version の値の変更手順&gt;</p><p>- 以前の NLS バージョンに戻す場合 (Access のエラーを回避する)</p><p>キー : [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\Sorting\Versions]</p><p>名前 : 既定</p><p>値 : 0006020F</p><p>コマンド) REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Nls\Sorting\Versions /ve /d 0006020F /f</p><p>※管理者として起動したコマンドプロンプトで実行ください。</p><p>- バージョン 2004 / 20H2 の既定値 (Access のエラーが発生) に戻す場合</p><p>コマンド) REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Nls\Sorting\Versions /ve /d 00060305 /f</p><p>注意点</p><p>本レジストリの変更で NLS バージョンを 6.2 に変更した OS についても弊社にてサポートいたします。</p><span style="color:#ff0000">しかしながら、Windows のライセンス認証において本設定を行うと正常にライセンス認証が行われない場合があることを確認しております。この場合、本設定変更による回避方法はご利用いただけませんので、ライセンス認証を実行する際には上記の変更を元に戻してから実行してください。</span><p>なお、アプリケーションの実装やビジネスロジックによっては、ソートの整合が崩れたり、データが不正となる可能性がありますので、何か問題が発生してお問い合わせいただく場合には、NLS バージョンを 6.2 に変更して運用していることを随時担当エンジニアにお知らせくださいますようお願いいたします。</p><p>また、NLS バージョン 6.3 では合字データ (㋿ や ㍻) のソート順を変更していますので、合字を利用する場合にこのソート順が</p><p>変わります (Windows 10 バージョン 1909 と同じになる) ことも合わせてご了承ください。</p><p>バージョン 6.2 昇順 : ㋿ ㍻ ㍾ ㍼</p><p>バージョン 6.3 昇順 : ㍾ ㍼ ㍻ ㋿</p><p>ユーザーや管理者による対処不要で、更新プログラム適用等で対処ができず申し訳ありませんが、</p><p>問題によって NLS バージョンの値を変更するか、MSACCESS.EXE の互換モードを下げるという</p><p>対処が必要となりますことご了承くださいますようお願いいたします。  </p><p><strong>補足</strong></p><p>一度エラーが発生した Access ファイルは不整合の内容を保持しているため、上記対応方法を実施後もエラーが発生する可能性がございます。その場合、バックアップファイルから戻すといった修正が必要になります。</p><p>今後の方針や追加の回避方法等が分かり次第本資料を更新します。</p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div style=&quot;color:#ff0000&quot;&gt;
※2020/10/28 OS 観点での回避方法 (3-3) を追加しました。

&lt;p&gt;※2021/06/03 OS 21H1 も本現象の発生対象バージョンであることを追加しました。&lt;/p&gt;
&lt;p&gt;※2021/10/18 OS
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>バージョン 2005 - 2006 で Office プロセスの終了が遅延する</title>
    <link href="https://officesupportjp.github.io/blog/%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%202005%20-%202006%20%E3%81%A7%20Office%20%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%AE%E7%B5%82%E4%BA%86%E3%81%8C%E9%81%85%E5%BB%B6%E3%81%99%E3%82%8B/"/>
    <id>https://officesupportjp.github.io/blog/%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%202005%20-%202006%20%E3%81%A7%20Office%20%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%AE%E7%B5%82%E4%BA%86%E3%81%8C%E9%81%85%E5%BB%B6%E3%81%99%E3%82%8B/</id>
    <published>2020-08-16T15:00:00.000Z</published>
    <updated>2022-02-17T01:32:05.057Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームの中村です。</p><p>今回の記事では、Microsoft 365 / Office 2016 / Office 2019 の以下のバージョンで、Office アプリケーションの終了指示を出した後、バックグラウンドでしばらくプロセスが残存する動作について記載します。  </p><p><strong>現象</strong></p><p>通常通り Office アプリケーションの画面操作を行って×ボタンで終了したり、プログラムからの Office 操作で Quit メソッドによりアプリケーションを終了すると、Office アプリケーションの画面は消えるものの、タスク マネージャー等で確認すると、バックグラウンド プロセスとして 20 秒程度プロセスが残存した後、自動的に終了します。  </p><p><strong>発生バージョン</strong></p><p>バージョン 2005 (ビルド 12827.20470) 以降、バージョン 2006 (すべてのビルド) まで</p><p>Microsoft 365 では、現在のチャネル / 月次エンタープライズ チャネル向けにこのバージョンが提供されています。<br>Office 2016 / 2019 は、市販パッケージ製品 (FPP) および PC プリインストール製品 (PIPC) にこのバージョンが提供されています。</p><p><strong>原因</strong></p><p>Office アプリケーションは、製品の改善のためにアプリケーションの利用状況などを診断データ (テレメトリ データ) としてマイクロソフトに送信しています。</p><p>従量課金ネットワークにおいてこの診断データの送信が短時間に繰り返され、CPU 使用率が高騰する問題が確認されました。バージョン 2005 (ビルド 12827.20470) で、この問題への対応として診断データの送信に待機時間を設けたところ、通常のネットワークにおいても診断データの送信に待機時間が生じるようになったために発生します。</p><p><strong>対応状況</strong></p><p>バージョン 2007 で通常ネットワークでの動作を修正し、従来通り、アプリケーションの終了操作後すぐにプロセスが終了するよう対応しました。</p><p>ただし、以下の場合にはバージョン 2007 以降も引き続き本動作によるバックグラウンドでのプロセス終了遅延が生じます。</p><p>・  従量課金ネットワークの場合<br>　　※ 従量課金ネットワークは OS の [設定] 画面より確認できます。<br>　　Windows 10 での従量制課金接続<br>　　<a href="https://support.microsoft.com/ja-jp/help/4028458" target="_blank" rel="noopener">https://support.microsoft.com/ja-jp/help/4028458</a>..</p><p>・ ネットワークに接続されていない場合 Microsoft 365 / Office 2016 / Office 2019 は、診断データの送信先を含む、以下で公開している接続先にインターネット接続が可能な構成で利用いただくことを想定しています。</p><p>Office 365 URL および IP アドレス範囲<br><a href="https://docs.microsoft.com/ja-jp/office365/enterprise/urls-and-ip-address-ranges" target="_blank" rel="noopener">https://docs.microsoft.com/ja-jp/office365/enterprise/urls-and-ip-address-ranges</a></p><p>本現象に関して、約 20 秒程度プロセスが残存すること以外に Office の動作への影響は確認されていません。<br>他の影響として想定されるものとしては、Office プロセスの終了監視を行うような製品を利用している場合に、終了の検知が遅れることが考えられます。</p><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;こんにちは、Office サポート チームの中村です。&lt;/p&gt;
&lt;p&gt;今回の記事では、Microsoft 365 / Office 2016 / Office 2019 の以下のバージョンで、Office アプリケーションの終了指示を出した後、バックグラウンドでしばらくプロ
      
    
    </summary>
    
    
    
  </entry>
  
</feed>
