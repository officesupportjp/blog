---
title: Excel シート タブの外観変更後、オートメーションのパフォーマンスが低下する
date: '2025-01-31'
id: cm372f6jk000058se8jgwhvee
tags:
  - オートメーション
  - VBA マクロ
---

<span style="color:#ff0000">**2025/01/31 Update**</span>  
<span style="color:#339966">本現象を修正する更新について追記しました。</span>  


こんにちは、Office サポート チームの中村です。

今回の記事では、Excel が新しい外観に変わった後、Excel オートメーションの処理パフォーマンスが大きく低下する場合がある現象について記載します。
<br>

**<h3>1. 前提となる動作変更</h3>**
Office デスクトップ アプリの新しいバージョンでは、Windows 11 の外観と一貫性のある外観への変更が進められています。この変更後、ウィンドウの配色が変化したり、ウィンドウ枠の角が丸みを帯びる、といった外観の変化があります。

参考) Office の新しい外観  
[https://support.microsoft.com/ja-jp/office/a6cdf19a-b2bd-4be1-9515-d74a37aa59bf](https://support.microsoft.com/ja-jp/office/a6cdf19a-b2bd-4be1-9515-d74a37aa59bf)

この Office デスクトップ アプリの全体的な外観変更に加え、Excel ではさらにシート タブも一貫性のある外観への変更を進めています。

<シート タブ変更前>  
![](Visual_Before.png)  

<シート タブ変更後>  
![](Visual_After.png)  

このシート タブの外観変更が行われた後、次に説明する Excel オートメーションのパフォーマンス低下の問題が生じることを確認しています。
<br>

**<h3>2. 現象</h3>**
先述のシート タブ外観変更後、多くのシートを持つブックにおいて、オートメーションで各シートに対する様々な操作を行うと、パフォーマンスが低下する場合があります。  
どの程度影響を受けるかは、オートメーション処理内容に依存しますが、特に、.NET プログラムや PowerShell などの外部プログラムからの Excel オートメーションでは、大きくパフォーマンスが低下する傾向にあります。  
また、シート数が増えるにつれて、処理時間の増加量がより大きく増えます。  
<br>

**<h3>3. 原因</h3>**
新しいシート タブの外観を描画するため、描画処理を大きく変更しました。この新しい描画処理で、特にシート数が多いとき、以前の処理より時間を要することが原因です。  
<br>

**<h3>4. 現象発生バージョン</h3>**
ご利用の製品とチャネル、OS によって、以下のバージョン以降で Excel のシート タブが新しい外観に変更されます。このバージョン以降でシート タブが新しい外観に変わると、現象が発生します。

**Microsoft 365 Apps**  
<最新チャネル>  
Windows 11: バージョン 2308 (ビルド 16731.20170)  
Windows 10: バージョン 2404 (ビルド 17531.20120)  

<月次エンタープライズ チャネル>  
Windows 11: バージョン 2310 (ビルド 16924.20180)  
Windows 10: バージョン 2408 (ビルド 17928.20216)  

**製品版 Office 2024**  
Windows 11 / Windows 10 ともに製品出荷バージョン以降全て

**製品版 Office 2021**  
Windows 11 / Windows 10 ともにバージョン 2308 (ビルド 16731.20170)  

上記以外の製品やチャネルでは、本記事作成時点でシート タブは新しい外観に変わっていないため、本問題の影響を受けません。  
※ 上記の <製品版 Office> は、コンシューマー向け製品を指します。ボリューム ライセンス版 Office LTSC 2024 / Office LTSC 2021 は影響を受けません。  
<br>

**<h3>5. 対処方法</h3>**

以下のバージョンで本現象を修正しました。本バージョン以降に更新することで、本記事でご案内するシナリオのパフォーマンスが改善します。

**Microsoft 365 Apps**  
<最新チャネル>  
バージョン 2501 (ビルド 18429.20132)  

※ 月次エンタープライズ チャネル向けには、2025 年 3 月に修正を含むバージョン 2501 を公開見込みです。

**製品版 Office 2024/2021**  
バージョン 2501 (ビルド 18429.20132)

<br>

**<h3>6. 暫定回避策</h3>**
※ 本現象について未修正のバージョン 2412 以前向けのご案内です。  

新しい外観を適用しないよう、Office の設定で変更することはできません。  
現状の動作における暫定回避策として、以下の方法でパフォーマンス向上を図ることができることを確認しています。

- シート名に日本語 (DBCS 文字) を使用しない
- 外部プログラムからのオートメーションを、VBA での処理に変更する (外部プログラムからは、Application.Run で VBA を呼び出すことができます)
<br>

上記の対応が難しい場合、他の暫定回避策としては、シート タブが新しい外観に変わる前のバージョンに戻すことが検討できます。(製品初期出荷時点から新しい外観となっている Office 2024 を除く)  
ただし、現象がまだ発生しないバージョンは、チャネルによっては最新バージョンから大きくバージョンを戻す必要があり、サポートされないバージョンとなります。  
古いバージョンには、最新のセキュリティ更新が含まれないため、バージョンを戻す対処を検討する場合は、十分にこの点を考慮いただきますようお願いします。恐れ入りますが、本問題の回避のため、サポートされないバージョンを利用することによって生じた問題について、マイクロソフトでは責任を負うことはできません。

クイック実行形式の Office を以前のバージョンに戻す基本的な手順は、以下の公開情報をご参照ください。

以前のバージョンの Office に戻す方法  
[https://support.microsoft.com/ja-jp/topic/2bd5c457-a917-d57e-35a1-f709e3dda841](https://support.microsoft.com/ja-jp/topic/2bd5c457-a917-d57e-35a1-f709e3dda841)  
※ Apply To が Office 2019 までとなっていますが、Office 2021 も同じ手順でバージョンを戻すことができます。

手順 3 で指定するビルド番号 (16.0.xxxxx.yyyyy) は、ご利用の製品及びチャネル向けに過去にリリースされたビルドを以下の公開情報で確認し、先述の現象発生バージョンより前のビルドを使用します。

Microsoft 365 Apps の更新履歴 (日付別の一覧)  
[https://learn.microsoft.com/ja-jp/officeupdates/update-history-microsoft365-apps-by-date](https://learn.microsoft.com/ja-jp/officeupdates/update-history-microsoft365-apps-by-date)

Office LTSC 2024 および Office 2024 の更新履歴  
[https://learn.microsoft.com/ja-jp/officeupdates/update-history-office-2024](https://learn.microsoft.com/ja-jp/officeupdates/update-history-office-2024)  

Office LTSC 2021 および Office 2021 の更新履歴  
[https://learn.microsoft.com/ja-jp/officeupdates/update-history-office-2021](https://learn.microsoft.com/ja-jp/officeupdates/update-history-office-2021)  


注意:  
エンタープライズ環境などでは、管理者が Office の更新バージョンを管理している場合があります。Office デスクトップ アプリの更新管理には様々な方法があるため、上記の基本手順ではバージョンを変更できない場合があります。このような場合は、ユーザー様のクライアント環境管理者にお問い合わせください。

<br>

今回の投稿は以上です。

**本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。**