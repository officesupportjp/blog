---
title: Windows 10 バージョン 2004 (20H1) 上で 半角カナのフォームを含んだ Access ファイルでエラーが発生する
date: 2020-08-24
---

こんにちは、Office サポート チームの佐村です。

今回の記事では、Windows 10 バージョン 2004 上で半角カナ + カナに濁音 / 半濁音を含んでいる Access ファイルを開くとエラーが発生する状況について説明します。

(Access のバージョンに依存性はなく Windows 10 バージョン 2004 上での Access アプリケーションで発生します。)

**1.** **現象**

Windows 10 バージョン 2004 上で Access ファイルを開いた時、VBA を実行しようとしたとき、VBA プロジェクトを開こうとしたとき等に以下のようなエラーが発生する可能性があります。

・フォーム名 ‘半角カナを含んだフォーム名’ が正しくないか、存在しないフォームを参照しています。

![](image1.png)

・データベースに含まれている VBA プロジェクトを読み取れないため、データベースを開くことができません。

![](image2.png)

「データベースに含まれている VBA プロジェクトを～」のエラーダイアログで「OK」ボタンをクリックするとファイルに保存されている VBA プロジェクトが全て削除され、Access ファイルは操作の都度保存されるため VBA プロジェクトが削除された状態でファイルが自動保存されてしまい、コードが消失して復元ができなくなる可能性があります。

この動作が生じる条件は以下になります。

   

**問題発生条件**

・Windows 10 OS バージョン 2004 である。

・Access ファイル内のフォーム名に半角カタカナを利用して濁音、半濁音のいずれかが含まれている。

この条件を満たす場合、フォームに紐づく VBA プロジェクトが存在している場合や、半角カナのサブフォームを指定する際に全角で指定していると上記であげたエラーが発生します。

**2.** **原因の説明**

Access アプリケーションでは、フォーム名に関して OS で用意している機能を利用し、半角と全角とを区別せずに比較しています。

そのため、以前の OS では “ガ” と “ガ” のような全角 / 半角は同じ文字列として判定されていましたが、Windows 10 バージョン 2004 では OS の自然言語処理を担う NLS (National Language Support) バージョンが更新され異なる文字列として判定されてしまいます。

これによって内部管理上同じとみなされることが期待されるフォームが異なるものとして認識されるためにエラーが発生します。

**3.** **暫定対応方法**

**3-1. Access** **アプリケーション観点 - Access の EXE (MSACCESS.EXE) について、"Windows 8" の互換設定を行う**

エクスプローラーで MSACCESS.EXE までを展開し、MSACCESS.EXE のプロパティから互換モードで動作するように変更します。

![](image3.png)

※OfficeNN バージョン番号

Office16 : Microsoft 365 Apps (Office 365 ProPlus) / Office 2019 / Office 2016

Office15 : Office 2013

Office14 : Office 2010

\-ご参考

タイトル : クイック実行形式 (C2R) と Windows インストーラー形式 (MSI) を見分ける方法

URL : [https://social.msdn.microsoft.com/Forums/ja-JP/57e5d81e-ef69-4c1f-9ef0-932d03d0e7ce/1246312452124831246323455348922441824335-c2r-12392-windows](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fsocial.msdn.microsoft.com%2FForums%2Fja-JP%2F57e5d81e-ef69-4c1f-9ef0-932d03d0e7ce%2F1246312452124831246323455348922441824335-c2r-12392-windows&data=02%7C01%7Cmasamura%40microsoft.com%7C3ad5c5de6c1348d728f508d847f6a5de%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637338471963470942&sdata=td%2FgO%2BMeA2HHyTyR%2FW%2FbrJHzTmnVb2Anp2JvIW9mQ6Y%3D&reserved=0)

<設定変更方法 (C2R版 Office の場合)>

\------------------------

・エクスプローラー上から、MSACCESS.EXE を右クリックし、「プロパティ」を選択します。

・MSACCESS.EXE のプロパティ画面で「互換性」タブを選択します。

・「互換モードでこのプログラムを実行する」のチェックを ON にしてターゲットとして Windows 8 が選択されていることを確認します。

・「OK」ボタンをクリックします。

※元の設定に戻す場合は「互換モードでこのプログラムを実行する」のチェックを OFF にします

\------------------------

<設定変更方法 (MSI版 Office の場合)>

\------------------------

・エクスプローラー上から、MSACCESS.EXE を右クリックし、「互換性のトラブルシューティング」を選択します。

・「推奨設定を使用する」を選択する。

・Windows 互換モード : Windows 8 となっていることを確認し「プログラムのテスト」ボタンをクリックします。

・Access アプリケーションが起動したら×ボタンで閉じて「次へ」ボタンをクリックします。

・「はい、このプログラムのこの設定を保存します」を選択します。

・「閉じる」ボタンでトラブルシューティングツールを閉じます。

※元の設定に戻す場合は以下のレジストリ配下の MSACCESS への設定を削除します。

HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompactFlags\\Layers

\------------------------

なお、Access をはじめ Office アプリケーションは互換性を変更した検証は実施しておらず、

互換性を変更して動作させた場合に、予期しない動作が発生することがございます。

**3-2. Access** **ファイル観点 - Access のフォームで半角カタカナを全角カタカナに変更する**

Windows 10 の OS 1909 等、以前の問題が発生しない OS バージョンでフォーム等の半角カタカナを全角カタカナに統一します。

VBA コードに半角カナでフォームを指定している場合等、半角カタカナのフォームを参照している処理は全角カナに修正する必要があります。

**補足**

現在、Office および Windows 10 OS 観点でこの問題について対応を協議しています。

今後の方針や追加の回避方法等が分かり次第本資料を更新します。

**本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。**