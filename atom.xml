<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan Office Client Support Blog</title>
  
  <subtitle>日本マイクロソフト Office Client サポート チームのブログです</subtitle>
  <link href="https://officesupportjp.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://officesupportjp.github.io/blog/"/>
  <updated>2025-02-05T02:39:42.850Z</updated>
  <id>https://officesupportjp.github.io/blog/</id>
  
  <author>
    <name>Office Support Japan</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Excel シート タブの外観変更後、オートメーションのパフォーマンスが低下する</title>
    <link href="https://officesupportjp.github.io/blog/cm372f6jk000058se8jgwhvee/"/>
    <id>https://officesupportjp.github.io/blog/cm372f6jk000058se8jgwhvee/</id>
    <published>2025-01-31T00:00:00.000Z</published>
    <updated>2025-02-05T02:39:42.850Z</updated>
    
    <content type="html"><![CDATA[<p><span style="color:#ff0000"><strong>2025&#x2F;01&#x2F;31 Update</strong></span><br><span style="color:#339966">本現象を修正する更新について追記しました。</span>  </p><p>こんにちは、Office サポート チームの中村です。</p><p>今回の記事では、Excel が新しい外観に変わった後、Excel オートメーションの処理パフォーマンスが大きく低下する場合がある現象について記載します。<br><br></p><p><strong><h3>1. 前提となる動作変更</h3></strong><br>Office デスクトップ アプリの新しいバージョンでは、Windows 11 の外観と一貫性のある外観への変更が進められています。この変更後、ウィンドウの配色が変化したり、ウィンドウ枠の角が丸みを帯びる、といった外観の変化があります。</p><p>参考) Office の新しい外観<br><a href="https://support.microsoft.com/ja-jp/office/a6cdf19a-b2bd-4be1-9515-d74a37aa59bf">https://support.microsoft.com/ja-jp/office/a6cdf19a-b2bd-4be1-9515-d74a37aa59bf</a></p><p>この Office デスクトップ アプリの全体的な外観変更に加え、Excel ではさらにシート タブも一貫性のある外観への変更を進めています。</p><p>&lt;シート タブ変更前&gt;<br><img src="/blog/cm372f6jk000058se8jgwhvee/Visual_Before.png">  </p><p>&lt;シート タブ変更後&gt;<br><img src="/blog/cm372f6jk000058se8jgwhvee/Visual_After.png">  </p><p>このシート タブの外観変更が行われた後、次に説明する Excel オートメーションのパフォーマンス低下の問題が生じることを確認しています。<br><br></p><p><strong><h3>2. 現象</h3></strong><br>先述のシート タブ外観変更後、多くのシートを持つブックにおいて、オートメーションで各シートに対する様々な操作を行うと、パフォーマンスが低下する場合があります。<br>どの程度影響を受けるかは、オートメーション処理内容に依存しますが、特に、.NET プログラムや PowerShell などの外部プログラムからの Excel オートメーションでは、大きくパフォーマンスが低下する傾向にあります。<br>また、シート数が増えるにつれて、処理時間の増加量がより大きく増えます。<br><br></p><p><strong><h3>3. 原因</h3></strong><br>新しいシート タブの外観を描画するため、描画処理を大きく変更しました。この新しい描画処理で、特にシート数が多いとき、以前の処理より時間を要することが原因です。<br><br></p><p><strong><h3>4. 現象発生バージョン</h3></strong><br>ご利用の製品とチャネル、OS によって、以下のバージョン以降で Excel のシート タブが新しい外観に変更されます。このバージョン以降でシート タブが新しい外観に変わると、現象が発生します。</p><p><strong>Microsoft 365 Apps</strong><br>&lt;最新チャネル&gt;<br>Windows 11: バージョン 2308 (ビルド 16731.20170)<br>Windows 10: バージョン 2404 (ビルド 17531.20120)  </p><p>&lt;月次エンタープライズ チャネル&gt;<br>Windows 11: バージョン 2310 (ビルド 16924.20180)<br>Windows 10: バージョン 2408 (ビルド 17928.20216)  </p><p><strong>製品版 Office 2024</strong><br>Windows 11 &#x2F; Windows 10 ともに製品出荷バージョン以降全て</p><p><strong>製品版 Office 2021</strong><br>Windows 11 &#x2F; Windows 10 ともにバージョン 2308 (ビルド 16731.20170)  </p><p>上記以外の製品やチャネルでは、本記事作成時点でシート タブは新しい外観に変わっていないため、本問題の影響を受けません。<br>※ 上記の &lt;製品版 Office&gt; は、コンシューマー向け製品を指します。ボリューム ライセンス版 Office LTSC 2024 &#x2F; Office LTSC 2021 は影響を受けません。<br><br></p><p><strong><h3>5. 対処方法</h3></strong></p><p>以下のバージョンで本現象を修正しました。本バージョン以降に更新することで、本記事でご案内するシナリオのパフォーマンスが改善します。</p><p><strong>Microsoft 365 Apps</strong><br>&lt;最新チャネル&gt;<br>バージョン 2501 (ビルド 18429.20132)  </p><p>※ 月次エンタープライズ チャネル向けには、2025 年 3 月に修正を含むバージョン 2501 を公開見込みです。</p><p><strong>製品版 Office 2024&#x2F;2021</strong><br>バージョン 2501 (ビルド 18429.20132)</p><br><p><strong><h3>6. 暫定回避策</h3></strong><br>※ 本現象について未修正のバージョン 2412 以前向けのご案内です。  </p><p>新しい外観を適用しないよう、Office の設定で変更することはできません。<br>現状の動作における暫定回避策として、以下の方法でパフォーマンス向上を図ることができることを確認しています。</p><ul><li>シート名に日本語 (DBCS 文字) を使用しない</li><li>外部プログラムからのオートメーションを、VBA での処理に変更する (外部プログラムからは、Application.Run で VBA を呼び出すことができます)<br></li></ul><p>上記の対応が難しい場合、他の暫定回避策としては、シート タブが新しい外観に変わる前のバージョンに戻すことが検討できます。(製品初期出荷時点から新しい外観となっている Office 2024 を除く)<br>ただし、現象がまだ発生しないバージョンは、チャネルによっては最新バージョンから大きくバージョンを戻す必要があり、サポートされないバージョンとなります。<br>古いバージョンには、最新のセキュリティ更新が含まれないため、バージョンを戻す対処を検討する場合は、十分にこの点を考慮いただきますようお願いします。恐れ入りますが、本問題の回避のため、サポートされないバージョンを利用することによって生じた問題について、マイクロソフトでは責任を負うことはできません。</p><p>クイック実行形式の Office を以前のバージョンに戻す基本的な手順は、以下の公開情報をご参照ください。</p><p>以前のバージョンの Office に戻す方法<br><a href="https://support.microsoft.com/ja-jp/topic/2bd5c457-a917-d57e-35a1-f709e3dda841">https://support.microsoft.com/ja-jp/topic/2bd5c457-a917-d57e-35a1-f709e3dda841</a><br>※ Apply To が Office 2019 までとなっていますが、Office 2021 も同じ手順でバージョンを戻すことができます。</p><p>手順 3 で指定するビルド番号 (16.0.xxxxx.yyyyy) は、ご利用の製品及びチャネル向けに過去にリリースされたビルドを以下の公開情報で確認し、先述の現象発生バージョンより前のビルドを使用します。</p><p>Microsoft 365 Apps の更新履歴 (日付別の一覧)<br><a href="https://learn.microsoft.com/ja-jp/officeupdates/update-history-microsoft365-apps-by-date">https://learn.microsoft.com/ja-jp/officeupdates/update-history-microsoft365-apps-by-date</a></p><p>Office LTSC 2024 および Office 2024 の更新履歴<br><a href="https://learn.microsoft.com/ja-jp/officeupdates/update-history-office-2024">https://learn.microsoft.com/ja-jp/officeupdates/update-history-office-2024</a>  </p><p>Office LTSC 2021 および Office 2021 の更新履歴<br><a href="https://learn.microsoft.com/ja-jp/officeupdates/update-history-office-2021">https://learn.microsoft.com/ja-jp/officeupdates/update-history-office-2021</a>  </p><p>注意:<br>エンタープライズ環境などでは、管理者が Office の更新バージョンを管理している場合があります。Office デスクトップ アプリの更新管理には様々な方法があるため、上記の基本手順ではバージョンを変更できない場合があります。このような場合は、ユーザー様のクライアント環境管理者にお問い合わせください。</p><br><p>今回の投稿は以上です。</p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;span style=&quot;color:#ff0000&quot;&gt;&lt;strong&gt;2025&amp;#x2F;01&amp;#x2F;31 Update&lt;/strong&gt;&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;color:#339966&quot;&gt;本現象を修正する更新について追記しました。&lt;/spa</summary>
      
    
    
    
    
    <category term="オートメーション" scheme="https://officesupportjp.github.io/blog/tags/%E3%82%AA%E3%83%BC%E3%83%88%E3%83%A1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3/"/>
    
    <category term="VBA マクロ" scheme="https://officesupportjp.github.io/blog/tags/VBA-%E3%83%9E%E3%82%AF%E3%83%AD/"/>
    
  </entry>
  
  <entry>
    <title>ラベル ポリシー「ユーザーがメールとドキュメントにラベルを適用することを必須にする」が有効の場合 Excel アドイン (.xlam) 保存時にラベル適用が求められ保存できない</title>
    <link href="https://officesupportjp.github.io/blog/cm53l15yg0000j46y7a4s6u9f/"/>
    <id>https://officesupportjp.github.io/blog/cm53l15yg0000j46y7a4s6u9f/</id>
    <published>2024-12-24T15:00:00.000Z</published>
    <updated>2025-01-29T08:39:08.058Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームです。<br>今回の投稿では、Microsoft Information Protection ラベル ポリシー [ユーザーがメールとドキュメントにラベルを適用することを必須にする] が有効の場合、Excel アドイン (*.xlam) 編集後保存時にラベル適用を求められ保存ができない現象について説明します。</p><h2 id="現象"><a href="#現象" class="headerlink" title="現象"></a>現象</h2><p>Microsoft Information Protection が構成されており、ラベル ポリシーの [ユーザーがメールとドキュメントにラベルを適用することを必須にする] が有効の場合、ラベル付けされていないドキュメントを開くと、”必須ラベル付け” によってユーザー操作によるラベルの付与を強制するプロンプトが表示されます。<br>そのため、通常のユーザー利用シナリオにおいて、ラベルの付与が行われていないドキュメントを保存しようとした、または、ラベルが適用されていないドキュメントを操作した場合などにおいて、プロンプトが繰り返し表示されることが想定されます。</p><p>また、ラベル付けの処理が組み込まれていないマクロや RPA の処理が実行された場合、ラベルが適用されていないドキュメントを操作した場合も “必須ラベル付け” のプロンプトが表示される可能性があります。<br>これにより Microsoft Information Protection ラベル ポリシーに依存し、ファイル形式によっては Microsoft 365 Apps にて保存ができないケースが確認されています。</p><br><h2 id="再現条件"><a href="#再現条件" class="headerlink" title="再現条件"></a>再現条件</h2><p>以下の構成を全て満たす場合、”必須ラベル付け” のプロンプトが表示され Microsoft 365 Apps にてファイルを保存することができません。</p><ul><li>Microsoft Information Protection ラベル ポリシー [ユーザーがメールとドキュメントにラベルを適用することを必須にする] が有効に設定されている</li><li>Microsoft Information Protectionラベル ポリシー [既存のドキュメントに既定のラベルを適用する] が設定されていない</li><li>Microsoft 365 Apps で Excel アドイン形式 (<em>.xlam) のファイルを開く、かつ、Excel アドイン形式 (</em>.xlam) にラベルが未設定である</li></ul><br><h2 id="再現手順の例"><a href="#再現手順の例" class="headerlink" title="再現手順の例"></a>再現手順の例</h2><ol><li>Excel アプリを起動し、[ファイル]-[開く] から、ラベルが付与されていない Excel アドイン形式 (<em>.xlam) のファイルを開きます。<br>※ Excel アドイン形式 (</em>.xlam) のファイルは、ファイルを開いても、ワークシートが表示されないことにご留意ください。</li><li>Alt + F12 キーを押下し、Visual Basic Editor を起動します。</li><li>Visual Basic Editor で、任意の編集を加えます。例えば、ThisWorkbookに下記コードを追加します。</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Private Sub Workbook_Open()</span><br><span class="line">    Debug.Print &quot;Test&quot;</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure><ol start="4"><li>Visual Basic Editor 画面で保存ボタンをクリックします。</li></ol><br><h4 id="結果"><a href="#結果" class="headerlink" title="結果"></a>結果</h4><p>ラベルの適用を求めるプロンプトが表示されます。<br>[ラベルの選択] ボタンをクリックしても、ラベル選択のダイアログが表示されないため、このユーザー インターフェースからラベルを設定することはできません。<br>このため、Visual Basic Editor 画面で行った変更内容は保存することができません。</p><p><img src="/blog/cm53l15yg0000j46y7a4s6u9f/image0.png"></p><br><h2 id="回避策"><a href="#回避策" class="headerlink" title="回避策"></a>回避策</h2><p>以下いずれかの方法による対応をご検討いただきますようお願いいたします。</p><p>(a). Microsoft Information Protectionラベル ポリシー [既存のドキュメントに既定のラベルを適用する] で暗号化を含まないラベルを設定する</p><p>あるいは</p><p>(b). VBA マクロにて、暗号化を含まないラベルを設定する</p><br><h4 id="b-の設定手順例"><a href="#b-の設定手順例" class="headerlink" title="(b). の設定手順例"></a>(b). の設定手順例</h4><p>本手順は一度実行していただければ結構です。設定したラベルを削除しない限り、毎回実行する必要はございません。</p><ol><li>Excel アプリを起動し、ラベルが付与されていない Excel アドイン形式 (<em>.xlam) のファイルを開きます。<br>※ Excel アドイン形式 (</em>.xlam) のファイルは、ファイルを開いても、ワークシートは表示されないことにご留意ください。</li><li>Alt + F12 キーを押下し、Visual Basic Editor を起動します。</li><li>Visual Basic Editor で、以下のコードを追加したら、F5 キーを押下してマクロ実行します。<br>※ “&lt;暗号化設定のないラベルの GUID&gt;” は、お客様の環境で作成済みの暗号化設定のないラベルの GUID を指定してください。<br>※ 暗号化設定を含むラベルは設定しないでください。暗号化設定を含むラベルを設定すると、Excel アドイン形式 (*.xlam) として使用できません。</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Sub Sample()</span><br><span class="line">Dim mysensitivityLabel As Office.SensitivityLabel</span><br><span class="line">Dim myLabelInfo As Office.LabelInfo</span><br><span class="line"></span><br><span class="line">    Set mysensitivityLabel = ThisWorkbook.SensitivityLabel  </span><br><span class="line">    Set myLabelInfo = ThisWorkbook.SensitivityLabel.CreateLabelInfo()</span><br><span class="line"></span><br><span class="line">        With myLabelInfo</span><br><span class="line">            .AssignmentMethod = MsoAssignmentMethod.PRIVILEGED</span><br><span class="line">            .LabelId = &quot;&lt;暗号化設定のないラベルの GUID&gt;&quot;</span><br><span class="line">        End With</span><br><span class="line"></span><br><span class="line">    mysensitivityLabel.SetLabel myLabelInfo, myLabelInfo</span><br><span class="line">End Sub</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="4"><li>Excel アドイン形式 (*.xlam) に暗号化設定のないラベルが設定できたら、Visual Basic Editor 画面で保存ボタンをクリックして保存を行います。</li><li>保存が完了したら、3. で追加したマクロ自体は削除して構いません。削除後は再度、Visual Basic Editor 画面で保存を行います。</li></ol><br><h2 id="今後の対応予定"><a href="#今後の対応予定" class="headerlink" title="今後の対応予定"></a>今後の対応予定</h2><p>本動作について、現在開発部門にて今後の改善可否等を含め調査中となります。<br>新たな情報が確認された場合は、この記事に追記する形で公開していく予定です。</p><br><h2 id="ご参考情報"><a href="#ご参考情報" class="headerlink" title="ご参考情報"></a>ご参考情報</h2><p>ラベル ポリシーにおいて “必須ラベル付け” を有効にする場合、併せて “既定のラベル” によってプロンプトの表示が抑制されることを公開情報によりご案内しております。<br>“既定のラベル” は、”必須ラベル付け” よりも常に優先されるため、最低限、すべてのドキュメントに既定のラベルが付与されます。<br>その結果、”必須ラベル付け” によって表示されるプロンプトを抑制することが可能です。</p><p>Title: 秘密度ラベルの詳細<br>URL: <a href="https://learn.microsoft.com/ja-jp/purview/sensitivity-labels?view=o365-worldwide#what-label-policies-can-do">https://learn.microsoft.com/ja-jp/purview/sensitivity-labels?view=o365-worldwide#what-label-policies-can-do</a></p><blockquote><p>項目 [ラベル ポリシーでできること] &gt; [ドキュメントとメール、文書のみ、コンテナー、および Power BI コンテンツに ラベルを適用することをユーザーに要求します。] をご参照ください \</p><blockquote><p>このオプションを使用して、ラベル付けの適用範囲を広げることを検討してください。 ただし、ユーザーのトレーニングを実施しない場合、この設定は不正確なラベル付けにつながる可能性があります。 さらに、対応する既定のラベルも設定しない限り、必須のラベル付けにより頻繁にダイアログが表示され、ユーザーを苛立たせる可能性があります。</p></blockquote></blockquote><p>Title: Office アプリで秘密度ラベルを管理する<br>URL: <a href="https://learn.microsoft.com/ja-jp/purview/sensitivity-labels-office-apps?view=o365-worldwide#require-users-to-apply-a-label-to-their-email-and-documents">https://learn.microsoft.com/ja-jp/purview/sensitivity-labels-office-apps?view=o365-worldwide#require-users-to-apply-a-label-to-their-email-and-documents</a></p><blockquote><p>項目 [ユーザーがメールとドキュメントにラベルを適用することを必須にする] をご参照ください \</p><blockquote><p>既定のラベルは、必須のラベル付けよりも常に優先されます。</p></blockquote></blockquote><p>今回の投稿は以上です。<br>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Office サポート チームです。&lt;br&gt;今回の投稿では、Microsoft Information Protection ラベル ポリシー [ユーザーがメールとドキュメントにラベルを適用することを必須にする] が有効の場合、Excel アドイン (*.xla</summary>
      
    
    
    
    
    <category term="Excel" scheme="https://officesupportjp.github.io/blog/tags/Excel/"/>
    
    <category term="Office 開発全般" scheme="https://officesupportjp.github.io/blog/tags/Office-%E9%96%8B%E7%99%BA%E5%85%A8%E8%88%AC/"/>
    
    <category term="アドイン" scheme="https://officesupportjp.github.io/blog/tags/%E3%82%A2%E3%83%89%E3%82%A4%E3%83%B3/"/>
    
    <category term="MIP ラベル" scheme="https://officesupportjp.github.io/blog/tags/MIP-%E3%83%A9%E3%83%99%E3%83%AB/"/>
    
  </entry>
  
  <entry>
    <title>Word で表のレイアウトが変わる</title>
    <link href="https://officesupportjp.github.io/blog/cm4m8fp9y0009346y3p6tg4s6/"/>
    <id>https://officesupportjp.github.io/blog/cm4m8fp9y0009346y3p6tg4s6/</id>
    <published>2024-12-12T15:00:00.000Z</published>
    <updated>2024-12-23T02:24:21.776Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームです。<br>今回の記事では、Word で表のレイアウトが変わる現象について説明します。</p><h3 id="1-現象"><a href="#1-現象" class="headerlink" title="1. 現象"></a>1. 現象</h3><p>Microsoft 365 Apps、及び、製品版のOffice 2021&#x2F;2024 を以下のバージョンへ更新した後に、更新前のバージョンで作成した Word 文書内の表のレイアウトが変わる現象が発生する場合があります。</p><p>・バージョン 2409 (ビルド 18025.XXXXX) 以降</p><p>現象発生前の表のイメージ：<br><img src="/blog/cm4m8fp9y0009346y3p6tg4s6/image01.png"></p><p>現象発生後の表のイメージ：<br><img src="/blog/cm4m8fp9y0009346y3p6tg4s6/image02.png"></p><p><strong>対象製品:</strong><br>Microsoft 365 Apps<br>Office 2021 製品版<br>Office 2024 製品版<br>※ Office 2021 ボリュームライセンス版、及び、Office 2024 ボリュームライセンス版では発生しません。</p><h3 id="2-今後の対応予定"><a href="#2-今後の対応予定" class="headerlink" title="2. 今後の対応予定"></a>2. 今後の対応予定</h3><p>本動作について、現在開発部門にて詳細な原因・今後の改善可否等を含め調査中となります。<br>新たな情報が確認された場合は、この記事に追記する形で公開していく予定です。</p><p>今回の投稿は以上です。</p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Office サポート チームです。&lt;br&gt;今回の記事では、Word で表のレイアウトが変わる現象について説明します。&lt;/p&gt;
&lt;h3 id=&quot;1-現象&quot;&gt;&lt;a href=&quot;#1-現象&quot; class=&quot;headerlink&quot; title=&quot;1. 現象&quot;&gt;&lt;/a&gt;</summary>
      
    
    
    
    
    <category term="Word" scheme="https://officesupportjp.github.io/blog/tags/Word/"/>
    
  </entry>
  
  <entry>
    <title>Office のインストール・更新・環境情報の採取について</title>
    <link href="https://officesupportjp.github.io/blog/cm3e5mpvi0000cgkj2sfvb55j/"/>
    <id>https://officesupportjp.github.io/blog/cm3e5mpvi0000cgkj2sfvb55j/</id>
    <published>2024-11-28T00:00:00.000Z</published>
    <updated>2025-02-05T04:19:57.700Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。<br>本記事では Office のインストール・更新・環境情報の採取について解説します。</p><h2 id="環境情報ログ"><a href="#環境情報ログ" class="headerlink" title="環境情報ログ"></a>環境情報ログ</h2><ol><li><p><a href="MSOfficeinfo_v3.1.zip">MSOfficeinfo.zip</a> をダウンロードします。</p></li><li><p>MSOfficeinfo.zip のプロパティを開き、以下で “許可する”にチェックをつけます。<br><img src="/blog/cm3e5mpvi0000cgkj2sfvb55j/image1.png"></p></li><li><p>MSOfficeinfo.zip を解凍し、MSOfficeinfo.txt の拡張子を .cmd に変更します。</p></li><li><p>MSOfficeinfo.cmd をダブルクリックで実行します。結果は、C:\MS_DATA 配下に出力されます。<br>※ 管理者を持つ別のユーザーで実行すると正しく取得できませんので、ログオンユーザーでダブルクリックで取得ください。</p></li><li><p>取得した以下の情報を弊社にお寄せください<br>・C:\MS_DATA に出力された MOI から始まる zip ファイル</p></li></ol><br><h2 id="インストール、更新ログ"><a href="#インストール、更新ログ" class="headerlink" title="インストール、更新ログ"></a>インストール、更新ログ</h2><ol start="0"><li><p>事前に環境情報ログを採取してください</p></li><li><p><a href="https://www.microsoft.com/en-us/download/details.aspx?id=103236">Microsoft 365 Apps Deployment Log Collector</a> から <strong>officedeploymentlogcollector.exe</strong> をダウンロードします。</p></li><li><p><strong>officedeploymentlogcollector.exe</strong> をダブルクリックし、任意のフォルダに展開します。</p></li><li><p>展開したフォルダに配置された <strong>OfficeC2RLogCollector.exe</strong> を実行します。(端末の管理者権限が必要となります)</p></li><li><p>C:\Users\&lt;ユーザー名&gt;\AppData\Local\Temp\C2RLogs 配下に出力された c2rlogs_ から始まる zip ファイルを取得ください</p></li><li><p>取得した以下の情報を弊社にお寄せください<br>・環境情報ログ(C:\MS_DATA に出力された MOI から始まる zip ファイル)<br>・c2rlogs_ から始まる zip ファイル<br>・インストール・更新の事象の場合、事象発生日時<br>・インストールの事象の場合、利用した Configuration.xml ファイル<br>・エラーが生じる事象の場合、スクリーンショット</p></li></ol><br><h2 id="ライセンス認証ログ"><a href="#ライセンス認証ログ" class="headerlink" title="ライセンス認証ログ"></a>ライセンス認証ログ</h2><ol start="0"><li><p>事前に環境情報ログを採取してください</p></li><li><p><a href="https://www.microsoft.com/en-us/download/details.aspx?id=55948">Office Licensing Diagnostic Tool</a> から <strong>OfficeLicenseDiagnostic.zip</strong> をダウンロードし展開してください。</p></li><li><p><strong>licenseInfo.cmd</strong> をダブルクリックで実行してください。<br>※ 途中、数回 Enter キーの入力が求められます。また、結果は %temp% に licensingInfo から始まる名前で出力されます。<br>※ 管理者を持つ別のユーザーで実行すると正しく取得できませんので、ログオンユーザーでダブルクリックで取得ください。</p></li><li><p>取得した以下の情報を弊社にお寄せください<br>・環境情報ログ(C:\MS_DATA に出力された MOI から始まる zip ファイル)<br>・licensingInfo から始まる zip ファイル</p></li></ol><br><p><span style="color:#ff0000"><strong>2024&#x2F;11&#x2F;28  Update</strong></span><br><span style="color:#339966">一部記載を変更しました</span></p><p><span style="color:#ff0000"><strong>2024&#x2F;1&#x2F;29  Update</strong></span><br><span style="color:#339966">スクリプトを更新しました</span></p><p><span style="color:#ff0000"><strong>2024&#x2F;2&#x2F;5  Update</strong></span><br><span style="color:#339966">採取方法を簡素化しました</span></p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Office サポートの西川 (直) です。&lt;br&gt;本記事では Office のインストール・更新・環境情報の採取について解説します。&lt;/p&gt;
&lt;h2 id=&quot;環境情報ログ&quot;&gt;&lt;a href=&quot;#環境情報ログ&quot; class=&quot;headerlink&quot; title=</summary>
      
    
    
    
    
    <category term="インストール" scheme="https://officesupportjp.github.io/blog/tags/%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/"/>
    
    <category term="更新" scheme="https://officesupportjp.github.io/blog/tags/%E6%9B%B4%E6%96%B0/"/>
    
  </entry>
  
  <entry>
    <title>Word で「打」で始まるテキスト ファイルを開くとコンバーターを要求される</title>
    <link href="https://officesupportjp.github.io/blog/cm15ufuis0000f0seec0i7yev/"/>
    <id>https://officesupportjp.github.io/blog/cm15ufuis0000f0seec0i7yev/</id>
    <published>2024-09-17T00:00:00.000Z</published>
    <updated>2024-11-12T05:59:12.936Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームの中村です。<br>今回の記事では、Word でテキスト ファイルを開くとき、一部の内容においてコンバーターが要求される動作について説明します。<br><br></p><h4 id="1-現象"><a href="#1-現象" class="headerlink" title="1. 現象"></a><strong>1. 現象</strong></h4><p>以下の条件を満たすテキスト ファイルを Windows デスクトップ アプリの Word で開くと、「このファイルは新しいバージョンの Microsoft Word で作成されているため、このファイルを開くにはコンバーターが必要です。」というメッセージが表示されます。<br><br></p><p><img src="/blog/cm15ufuis0000f0seec0i7yev/msg.png"></p><p>&lt;ファイルの条件&gt;</p><ul><li>ファイル内容の先頭が Shift-JIS の「打」 (0x91C5) で始まること  </li><li>2 文字目以降に文字が続くこと (制御コードを含め、何らかのデータがあること)</li></ul><br><h4 id="2-原因"><a href="#2-原因" class="headerlink" title="2. 原因"></a><strong>2. 原因</strong></h4><p>多くのファイル形式では、先頭数バイトでそのファイル形式を表します。このため Word でファイルを開くとき、ファイルのバイナリ データの先頭数バイトを元にファイル形式を判断しています。<br>しかし、テキスト ファイルではこのようなデータ部を持たないため、ユーザーがファイルに入力したテキスト情報を、ファイルの先頭バイトから格納します。<br>「打」を Shift-JIS でエンコードした場合の 0x91C5 で始まり、3 バイト目以降にデータが続くと、Word はテキスト ファイルとは別のファイル形式と認識します。この Word で認識されたファイル形式は、現在サポートされる Word デスクトップ アプリで開くことができない形式のため、Word はコンバーターが必要と判断し、先述のメッセージを表示します。  </p><p>「打」で始まるテキスト ファイルにおけるこの動作は、Windows デスクトップ アプリの Word における制限事項です。<br><br></p><h4 id="3-対応方法"><a href="#3-対応方法" class="headerlink" title="3. 対応方法"></a><strong>3. 対応方法</strong></h4><h5 id="3-1-ユーザーの手動操作でファイルを開く場合"><a href="#3-1-ユーザーの手動操作でファイルを開く場合" class="headerlink" title="3-1. ユーザーの手動操作でファイルを開く場合"></a><strong>3-1. ユーザーの手動操作でファイルを開く場合</strong></h5><p>「このファイルは新しいバージョンの Microsoft Word で作成されているため、このファイルを開くにはコンバーターが必要です。」のメッセージで [いいえ] を選択し、次に表示される以下のメッセージで [OK] を選択すると、テキスト ファイルとして開くことができます。</p><p><img src="/blog/cm15ufuis0000f0seec0i7yev/msg2.png"><br><br></p><h5 id="3-2-プログラムからの操作でファイルを開く場合"><a href="#3-2-プログラムからの操作でファイルを開く場合" class="headerlink" title="3-2. プログラムからの操作でファイルを開く場合"></a><strong>3-2. プログラムからの操作でファイルを開く場合</strong></h5><p>VBA などのプログラムでテキスト ファイルを開く場合は、Documents.Open メソッドの Format パラメーターに wdOpenFormatText を指定して明示的にテキスト ファイルとして開きます。この場合、コンバーターを要求するメッセージの表示を回避し、初めからテキスト ファイルとして開きます。</p><p>Documents.Open メソッド (Word)<br><a href="https://learn.microsoft.com/ja-jp/office/vba/api/Word.Documents.Open">https://learn.microsoft.com/ja-jp/office/vba/api/Word.Documents.Open</a></p><p>&lt;公開情報より抜粋&gt;<br><em>Format オプション バリアント型 (Variant)<br>文書を開くために使用するファイル コンバーターを指定します。 WdOpenFormat 定数のいずれかを使用できます。 既定値は wdOpenFormatAuto です。 外部のファイル形式を指定するには、 FileConverter オブジェクトに OpenFormat プロパティを適用して、この引数で使用する値を決定します。</em></p><p>WdOpenFormat 列挙 (Word)<br><a href="https://learn.microsoft.com/ja-jp/office/vba/api/Word.WdOpenFormat">https://learn.microsoft.com/ja-jp/office/vba/api/Word.WdOpenFormat</a></p><p>&lt;公開情報より抜粋&gt;<br><em>wdOpenFormatText4エンコードされていないテキスト形式</em><br><br></p><h5 id="3-3-ファイルの保存時に対処する場合"><a href="#3-3-ファイルの保存時に対処する場合" class="headerlink" title="3-3. ファイルの保存時に対処する場合"></a><strong>3-3. ファイルの保存時に対処する場合</strong></h5><p>テキスト ファイルの文字コードを変更して問題なければ、Shift-JIS ではなく UTF-8 など他の文字コードで保存することで回避できます。このときに、開かれたファイルが期待する文字コードで認識されない場合は、ファイルを開くときの以下の画面や、プログラムから開く場合は Documents.Open の Encoding パラメーターで文字コードを変更できます (例えば、UTF-8 の場合は msoEncodingUTF8 を指定します)。</p><p><img src="/blog/cm15ufuis0000f0seec0i7yev/CharcodeSelect.png"></p><p>Documents.Open メソッド (Word)<br><a href="https://learn.microsoft.com/ja-jp/office/vba/api/Word.Documents.Open">https://learn.microsoft.com/ja-jp/office/vba/api/Word.Documents.Open</a></p><p>&lt;公開情報より抜粋&gt;<br><em>Encoding オプション バリアント型 (Variant)<br>保存された文書を表示するときに Microsoft Word で使用する、文書のエンコード (コード ページまたは文字セット) を指定します。 使用できる定数は、有効な MsoEncoding クラスの定数です。 有効な MsoEncoding クラスの定数の一覧については、Visual Basic Editor のオブジェクト ブラウザーを参照してください。 既定値はシステム コード ページです。</em></p><p>MsoEncoding 列挙 (Office)<br><a href="https://learn.microsoft.com/ja-jp/office/vba/api/Office.MsoEncoding">https://learn.microsoft.com/ja-jp/office/vba/api/Office.MsoEncoding</a></p><br><p>今回の投稿は以上です。  </p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Office サポート チームの中村です。&lt;br&gt;今回の記事では、Word でテキスト ファイルを開くとき、一部の内容においてコンバーターが要求される動作について説明します。&lt;br&gt;&lt;br&gt;&lt;/p&gt;
&lt;h4 id=&quot;1-現象&quot;&gt;&lt;a href=&quot;#1-現象&quot; c</summary>
      
    
    
    
    
    <category term="Word" scheme="https://officesupportjp.github.io/blog/tags/Word/"/>
    
  </entry>
  
  <entry>
    <title>Officeの更新プログラムの種類について</title>
    <link href="https://officesupportjp.github.io/blog/cm410uxqk006080kj691v6owv/"/>
    <id>https://officesupportjp.github.io/blog/cm410uxqk006080kj691v6owv/</id>
    <published>2024-09-02T00:00:00.000Z</published>
    <updated>2024-09-02T06:35:04.261Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。<br>本記事では Office の更新プログラムの種類について解説します。</p><br><h2 id="Office-の更新プログラムの違いについて"><a href="#Office-の更新プログラムの違いについて" class="headerlink" title="Office の更新プログラムの違いについて"></a>Office の更新プログラムの違いについて</h2><p>新機能が追加される機能更新が存在するのは Microsoft 365 Apps クライアントのみです。</p><table><thead><tr><th align="center">バージョン</th><th align="center">機能更新</th><th align="center">セキュリティ更新</th><th align="center">セキュリティ以外の更新(修正)</th></tr></thead><tbody><tr><td align="center">Microsoft 365 Apps クライアント</td><td align="center">○</td><td align="center">○</td><td align="center">○</td></tr><tr><td align="center">Office 2019&#x2F;2021 LTSC</td><td align="center">-</td><td align="center">○</td><td align="center">○</td></tr><tr><td align="center">パッケージ版 Office 2016&#x2F;2019&#x2F;2021</td><td align="center">-</td><td align="center">○</td><td align="center">○</td></tr><tr><td align="center">Office 2016</td><td align="center">-</td><td align="center">○</td><td align="center">○</td></tr></tbody></table><br><h2 id="Microsoft-365-Apps-クライアント"><a href="#Microsoft-365-Apps-クライアント" class="headerlink" title="Microsoft 365 Apps クライアント"></a>Microsoft 365 Apps クライアント</h2><p>更新は<a href="https://learn.microsoft.com/ja-jp/microsoft-365-apps/updates/overview-update-channels">チャネル</a>に沿ってバージョン、ビルドを上げることで行われます。また、過去の変更は累積となります。<br>このため、Excel のみ等、特定の製品のみ更新することは出来ません。また、累積のため、バージョン 2302 から 2308 を飛ばして 2402 に直接更新することも可能であり、2308 の変更も含まれます。</p><p><img src="/blog/cm410uxqk006080kj691v6owv/image01.png" alt="https://learn.microsoft.com/ja-jp/officeupdates/update-history-microsoft365-apps-by-date"></p><p>機能更新、セキュリティ更新、セキュリティ以外の更新(修正) の 3 種類がありますが、表のように、チャネルに沿ってバージョンアップを伴う更新とビルドのみの更新の 2 つに分けて公開されています。</p><p>同日に複数の更新プログラムが公開されている理由は、過去のバージョンから、機能更新を行わず、セキュリティ更新、セキュリティ以外の更新(修正)のみの更新をサポートするためです。</p><p><strong>1) 機能更新</strong><br><strong>バージョンが上がる更新</strong>が機能更新です。これには機能更新、セキュリティ更新、セキュリティ以外の更新(修正)が含まれます。<br>例えば、最新チャネルの 6&#x2F;26 において、バージョンが 2405 から 2406 に上がっておりますので、これは機能更新となります。</p><p><img src="/blog/cm410uxqk006080kj691v6owv/image02.png"></p><p><strong>2) セキュリティ更新</strong><br><strong>ビルドのみ上がる更新</strong>がセキュリティ更新です。これにはセキュリティ更新、セキュリティ以外の更新(修正)が含まれます。<br>例えば、最新チャネルの 6&#x2F;19 では、バージョンは 2405 のまま、ビルドのみ上がっておりますので、これはセキュリティ更新、セキュリティ以外の更新(修正)となります。</p><p><img src="/blog/cm410uxqk006080kj691v6owv/image03.png"></p><br><p><strong>MECM上の表記について</strong><br>機能更新は “機能更新プログラム”、セキュリティ更新は “品質更新プログラム” または “拡張品質更新プログラム” と表示されます。</p><p>“拡張品質更新プログラム”は、最新バージョンではないセキュリティ更新、および、セキュリティ以外の更新を指します。</p><p><img src="/blog/cm410uxqk006080kj691v6owv/image04.png"></p><p>例えば、上記の例では、バージョン 2402 は “品質更新プログラム” であり、2308 と 2302 は “拡張品質更新プログラム” となります。</p><br><h2 id="Office-2019-x2F-2021-LTSC"><a href="#Office-2019-x2F-2021-LTSC" class="headerlink" title="Office 2019&#x2F;2021 LTSC"></a>Office 2019&#x2F;2021 LTSC</h2><p>ボリュームライセンス版の Office 2019&#x2F;2021 LTSC では、セキュリティ更新、セキュリティ以外の更新(修正)のみが公開されています。<br>これらの Office はそれぞれ、Microsoft 365 Apps のバージョン 1808、2108 を元に製造されており、基本的な考え方は同一となります。</p><p><img src="/blog/cm410uxqk006080kj691v6owv/image06.png" alt="https://learn.microsoft.com/ja-jp/officeupdates/update-history-office-2019"><br><img src="/blog/cm410uxqk006080kj691v6owv/image05.png" alt="https://learn.microsoft.com/ja-jp/officeupdates/update-history-office-2021"></p><br><h2 id="パッケージ版-Office-2016-x2F-2019-x2F-2021"><a href="#パッケージ版-Office-2016-x2F-2019-x2F-2021" class="headerlink" title="パッケージ版 Office 2016&#x2F;2019&#x2F;2021"></a>パッケージ版 Office 2016&#x2F;2019&#x2F;2021</h2><p>これらの Office は Microsoft 365 Apps を元に製造されており、基本的な考え方は同一となりますが、<br>バージョンが上がったとしても機能更新は含まれず、セキュリティ更新、セキュリティ以外の更新(修正)のみが公開されています。</p><p><img src="/blog/cm410uxqk006080kj691v6owv/image07.png" alt="https://learn.microsoft.com/ja-jp/officeupdates/update-history-office-2019"><br><img src="/blog/cm410uxqk006080kj691v6owv/image08.png" alt="https://learn.microsoft.com/ja-jp/officeupdates/update-history-office-2021"></p><br><h2 id="Office-2016"><a href="#Office-2016" class="headerlink" title="Office 2016"></a>Office 2016</h2><p>ボリュームライセンス版の Office 2016 では、セキュリティ更新、セキュリティ以外の更新(修正)のみが公開されています。<br>こちらの Office は、<a href="https://officesupportjp.github.io/blog/cl0m8t2dj00393gvs3r7oar2m/">クイック実行形式 (C2R) ではなく Windows インストーラー形式 (MSI)</a> であり、モジュール単位で更新プログラムが公開されています。</p><p><img src="/blog/cm410uxqk006080kj691v6owv/image09.png" alt="https://learn.microsoft.com/ja-jp/officeupdates/msp-files-office-2016"></p><p><strong>MECM上の表記について</strong><br>C2R形式の Office の更新プログラムは、Microsoft Update Catalog 上の “分類” は “更新” で統一されておりますが、<br>MSI形式では “セキュリティ更新” は “セキュリティ問題の修正プログラム”、”セキュリティ以外の更新(修正)” は “重要な更新” と表記されます。<br><img src="/blog/cm410uxqk006080kj691v6owv/image10.png"></p><br><p><strong>- 関連情報</strong><br><a href="https://officesupportjp.github.io/blog/cl0m8t2dj00393gvs3r7oar2m/">クイック実行形式 (C2R) と Windows インストーラー形式 (MSI) を見分ける方法</a></p><br><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Office サポートの西川 (直) です。&lt;br&gt;本記事では Office の更新プログラムの種類について解説します。&lt;/p&gt;
&lt;br&gt;

&lt;h2 id=&quot;Office-の更新プログラムの違いについて&quot;&gt;&lt;a href=&quot;#Office-の更新プログラムの違い</summary>
      
    
    
    
    
    <category term="更新" scheme="https://officesupportjp.github.io/blog/tags/%E6%9B%B4%E6%96%B0/"/>
    
  </entry>
  
  <entry>
    <title>Outlook や Word でテキスト ボックスのサイズ変更や移動が正しく行われない現象について</title>
    <link href="https://officesupportjp.github.io/blog/clracr3qn0000sc6yestg9pc9/"/>
    <id>https://officesupportjp.github.io/blog/clracr3qn0000sc6yestg9pc9/</id>
    <published>2024-01-12T00:00:00.000Z</published>
    <updated>2024-03-03T23:51:41.876Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームです。<br>この記事では、Outlook や Word でテキスト ボックスのサイズ変更や移動が正しく行われない現象について説明します。  </p><h1 id="現象"><a href="#現象" class="headerlink" title="現象"></a>現象</h1><p>Microsoft 365 Apps に含まれる Outlook や Word で、テキスト ボックスのサイズ変更や位置の移動がマウス操作とおりに行われずに、意図しない場所に移動してしまう場合があります。<br>メールの本文や Word 文書内に複数行にわたって文面や改行が入っていて、垂直スクロール バーが表示される状態で上下移動が可能な構成になっていると発生しやすい傾向があります。  </p><h3 id="Outlook"><a href="#Outlook" class="headerlink" title="Outlook"></a>Outlook</h3><p>リッチ テキスト形式、または、HTML 形式のメール アイテムにテキスト ボックスを挿入して、<br>サイズ変更や位置の移動のためにドラッグすると、<br>サイズや位置を示すガイドラインの点線が実際とは異なる位置に描画され、ドラッグ後に上方 (斜め上など) に移動される</p><h3 id="Word"><a href="#Word" class="headerlink" title="Word"></a>Word</h3><p>Web レイアウト表示でテキスト ボックスを挿入して、<br>位置の移動のためにドラッグすると、位置を示すガイドラインの点線が実際とは異なる位置に描画され、ドラッグ後に上方 (斜め上など) に移動される</p><p><img src="/blog/clracr3qn0000sc6yestg9pc9/image1.png"></p><h1 id="対処方法"><a href="#対処方法" class="headerlink" title="対処方法"></a>対処方法</h1><p>事象が発生した場合の有効な対処方法はありません。<br>意図しない位置に移動されたオブジェクトを 「元に戻す」 操作で戻してやり直すことや、希望する位置に移動されるようドラッグし直します。<br>オプション設定の変更や更新適用などで解消することはできません。</p><p>今回の投稿は以上です。<br>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Office サポート チームです。&lt;br&gt;この記事では、Outlook や Word でテキスト ボックスのサイズ変更や移動が正しく行われない現象について説明します。  &lt;/p&gt;
&lt;h1 id=&quot;現象&quot;&gt;&lt;a href=&quot;#現象&quot; class=&quot;headerl</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>VBA マクロの Office バージョンアップ時の互換性</title>
    <link href="https://officesupportjp.github.io/blog/clr8yxe6w00043gsebywv7n74/"/>
    <id>https://officesupportjp.github.io/blog/clr8yxe6w00043gsebywv7n74/</id>
    <published>2024-01-11T00:00:00.000Z</published>
    <updated>2024-03-03T23:51:41.876Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームの中村です。</p><p>Office 2019 や Office LTSC 2021 といった Office 永続ライセンスの新しいバージョンへの変更や、Microsoft 365 Apps のバージョン更新にあたって、これまで動作していた VBA マクロが引き続き同じように動作するのかを懸念するご質問を頂くことがあります。<br>今回の記事では、このような Office バージョンアップ時の VBA マクロの互換性の考え方について記載します。</p><p>初めに結論を記載すると、元々利用していたバージョンが Office 2016 以降であれば、基本的な互換性は保持されており、ほとんどの場合は問題ありません。ただし、VBA マクロの処理の流れに依存して、Office の細かな動作変化が影響することは稀にあります。<br>このような動作しなくなるシナリオを網羅して弊社から案内することはできません。<br>最終的に確実な互換性を担保したい場合は、検証を通して確認していただく必要があります。</p><p>以下、VBA マクロの動作に関わる要素ごとに詳しく解説します。</p><p><strong><h3>1. VBA ランタイム</h3></strong><br>VBA はプログラム言語の 1 つであり、この VBA 言語を解釈して実行する VBA ランタイム自体にバージョンを持ちます。<br>VBA ランタイムは Office アプリケーションに同梱されていますが、現在サポートされる Office 2016 以降、Office 2019 &#x2F; Office 2021 &#x2F; Microsoft 365 Apps のいずれもバージョン 7.1 で統一されており、VBA ランタイムのバージョン更新はありません。<br>また仮に VBA 7.1 より古いバージョンで作成した VBA コードを含む Office ファイルであっても、VBA コードを実行環境で再コンパイルして実行できます。  </p><p>以上のことから、VBA ランタイムの観点で互換性を気にする必要はありません。<br><br></p><p><strong><h3>2. Office オブジェクト ライブラリ</h3></strong><br>VBA マクロの処理内容の中心は、Office アプリケーションに関する処理を行うことです。これには通常、Office オブジェクト ライブラリ内のオブジェクト &#x2F; メソッド &#x2F; プロパティなどを使用します。<br>例えば、「Microsoft Excel 16.0 Object Library」ライブラリでは、Workbooks.Open メソッドなどの Excel アプリケーションとのやり取りを行うためのオブジェクトを提供しています。VBA マクロからは、[参照設定] でこれらのライブラリを参照したり、レイト バインディングと呼ばれる手法で実行時にライブラリを参照して利用します。</p><p><strong><h4>2-1. ライブラリ バージョン</h4></strong><br>これらの Office アプリケーションとやり取りするためのオブジェクトを提供するライブラリは、Office に同梱されています。Office 2016 以降、Office 2019 &#x2F; Office 2021 &#x2F; Microsoft 365 Apps のいずれにおいても、バージョン「16.0」から変更はありません。このため、ライブラリ自体のバージョンが変わり、参照できなくなるといった問題は発生しません。</p><p>また、Office 2013 以前は「15.0」など、Office バージョンごとに異なるバージョンでした。この場合も、古いバージョンから新しいバージョンへの互換性は考慮されています。例えば Office 2013 で作成した VBA コードを、Microsoft 365 Apps 環境で実行する場合、自動的に新しいバージョンの同じライブラリを参照して動作します。<br>ただし、反対に新しいバージョンで作成した VBA コードを古いバージョンで実行する場合は、利用アプリケーションとライブラリの組み合わせによっては参照できません。</p><p><strong><h4>2-2. ライブラリ内のオブジェクト モデルの廃止 &#x2F; 変更</h4></strong><br>ライブラリ内で提供するオブジェクト モデルについては、Office 2016 より前のバージョンからの更新の場合、いくつかの互換性に影響が生じる廃止・変更があります。これらは、以下の公開情報でご案内しています。  </p><p>Office の互換性に関する問題<br><a href="https://learn.microsoft.com/ja-jp/office/client-developer/shared/compatibility-issues-in-office">https://learn.microsoft.com/ja-jp/office/client-developer/shared/compatibility-issues-in-office</a>  </p><p>一方、Office 2016 以降は、既存のオブジェクト モデルに対し、メソッドなどが削除されたり、メソッド呼び出し時の必須パラメーターが追加されるといった、これまでのオブジェクト モデルの用法に影響を与えるような破壊的変更はありません。<br><br></p><p><strong><h3>3. Office アプリケーションの動作変化</h3></strong><br>ここまでの 1. &#x2F; 2. の観点からは、Office 2016 以降のバージョンから、より新しいバージョンへの更新において、通常 VBA マクロの動作に影響はありません。<br>ただ重要な点として、VBA マクロは、Office アプリケーション等に対する処理要求を行っているということです。このため、VBA マクロからの処理においても、Office アプリケーションの動作変化の影響を受けます。  </p><p>例えば VBA マクロで Workbooks.Open を実行すると、Excel アプリケーションに対し「ファイルを開く」という要求を行い、実際にファイルを開く処理を行うのは VBA コード自身ではなく、Excel アプリケーション側です。そして、「ファイルを開く」という動作の中には、実際のファイル内容の読み取りの他、様々な内部処理が存在します。例えば、ファイルのフォーマットチェック、セキュリティ設定によるファイル内要素のブロック要否のチェック、最近使ったファイルへの情報追加・・・など、多岐に渡る内部処理をまとめて Workbooks.Open により実行される「ファイルを開く」動作となります。</p><p>ここまでに述べた通り、新しいバージョンの Office でも、Workbooks.Open メソッド自体はこれまでと同じ用法で実行することはできます。ただ、例えば Workbooks.Open から実行するフォーマットチェック項目が強化される、といった Excel 側の動作変化はあり得ます。<br>先述の例の場合、新しいチェック項目に反するフォーマットのファイルを VBA マクロから開くと、以前のバージョンでは開けるが、新しいバージョンでは開けない、といった事象が発生する可能性があります。</p><p>このような Office アプリケーションの動作変化は、バージョン更新に伴って無数に存在し、かつ内部の細かな実装であるため、すべての変更点を網羅して一覧化することはできません。リリース ノートで主要な変更の概要は確認できますが、記載のない細かな変更もあり、また、リリース ノートの端的な記載から影響有無を判断することは難しいことがほとんどです。<br>また一方、ユーザーが作成する VBA マクロの処理内容も千差万別であり、どの Office 動作変化が VBA マクロの処理に影響するかを弊社で事前に推測し、「VBA に影響が出る変更リスト」のような形でまとめることも困難です。  </p><p>したがって、VBA マクロが新しい Office バージョンで確実に動作するかは、実際に新しい環境での動作検証を通してご確認ください。  </p><p>なお、このように記載しましたが、もちろん、広く一般的に想定される状況で、既存 VBA マクロの動作に影響するような変更は基本的には行いません。以下の公開情報でも触れている通り、ほとんどの VBA マクロはこれまでと同じように動作するため、過度に心配する必要はありません。</p><p>Microsoft 365 Appsをデプロイするための環境と要件を評価する<br>手順 4 - アプリケーション互換性の評価<br><a href="https://learn.microsoft.com/ja-jp/deployoffice/assess-microsoft-365-apps">https://learn.microsoft.com/ja-jp/deployoffice/assess-microsoft-365-apps</a></p><p>社内環境の Office バージョンアップなどに際しては、VBA マクロを含むファイルは非常に多く存在することが一般的かと思います。そして、このようなファイルすべてを事前検証することは現実的ではないことが多いと考えられます。<br>例えば、業務上重要なファイルのみ事前検証を行い、その他のファイルは新バージョンの利用開始後に問題が確認された時点で、弊社サポートへのお問い合わせなどを通して調査するなど、皆様のご事情に合わせて、互換性に関する対応方針をご検討いただければ幸いです。<br><br></p><p><strong><h3>付録 1: Office 動作変化の具体例</h3></strong><br>&lt;3. Office アプリケーションの動作変化&gt; について、Office の動作変化の具体例を紹介します。</p><p><strong>OneDrive 同期フォルダーの Workbook.Path</strong><br>エクスプローラーで OneDrive や SharePoint ライブラリの同期フォルダからファイルを開く場合、以前の Office バージョンでは、ThisWorkbook.Path などで開いたファイルのパスを取得すると、同期フォルダのローカル パスが返されました。<br>Microsoft 365 の最新チャネル バージョン 1903 および半期チャネル バージョン 2008 以降、および Office LTSC 2021 では、このとき、クラウド ストレージ側の URL パスが返るようになりました。</p><p>この変化により、ローカル パスが返ることを期待して後続処理 (例: ”￥” 文字でのパス分割など) を記載していると影響が生じます。</p><p><strong>Excel 表示形式の和暦元年対応</strong><br> Office 2019 までは、Excel のセルの表示形式において、和暦の元年表記に未対応だったため、「令和1年5月1日」のように表示されていました。<br> Microsoft 365 のバージョン 1909 以降や Office LTSC 2021 では、元年表記に対応するとともに、既定で元年表記が有効となっています。</p><p> <img src="/blog/clr8yxe6w00043gsebywv7n74/Gannen.png"></p><p>この変化により、新しいバージョンでは、セルに「令和1年5月1日」のような和暦文字列を設定すると「令和元年5月1日」と表示内容が変わります。<br><br></p><p><strong><h3>付録 2: bit 変更の影響</h3></strong><br>Office のバージョンアップと合わせて、32 bit から 64 bit に変更することも多いかと思います。bit 変更に伴う VBA マクロへの影響として主に注意する点は、以下の 2 点です。</p><ul><li>Office 以外のライブラリを利用している場合、64 bit ライブラリを実行環境にインストール済みか</li><li>Declare ステートメントを利用している場合、PtrSafe の付与と、パラメーターの Long 型を適切に LongPtr 型に変更しているか (パラメーターの値を扱う変数のデータ型も合わせて変更が必要)</li></ul><p>詳しくは、以下の公開情報をご参照ください。  </p><p>64 ビット版または 32 ビット版の Office を選択する<br><a href="https://support.office.com/ja-jp/article/2dee7807-8f95-4d0c-b5fe-6c6f49b8d261">https://support.office.com/ja-jp/article/2dee7807-8f95-4d0c-b5fe-6c6f49b8d261</a></p><p>64 ビット Visual Basic for Applications の概要<br><a href="https://learn.microsoft.com/ja-jp/office/vba/language/concepts/getting-started/64-bit-visual-basic-for-applications-overview">https://learn.microsoft.com/ja-jp/office/vba/language/concepts/getting-started/64-bit-visual-basic-for-applications-overview</a></p><br><p>今回の投稿は以上です。</p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Office サポート チームの中村です。&lt;/p&gt;
&lt;p&gt;Office 2019 や Office LTSC 2021 といった Office 永続ライセンスの新しいバージョンへの変更や、Microsoft 365 Apps のバージョン更新にあたって、これまで</summary>
      
    
    
    
    
    <category term="VBA マクロ" scheme="https://officesupportjp.github.io/blog/tags/VBA-%E3%83%9E%E3%82%AF%E3%83%AD/"/>
    
  </entry>
  
  <entry>
    <title>iOS 端末で Excel ファイルに描画を行うとアプリが強制終了する場合がある</title>
    <link href="https://officesupportjp.github.io/blog/clr65j0hm00091s6ycv6zcha4/"/>
    <id>https://officesupportjp.github.io/blog/clr65j0hm00091s6ycv6zcha4/</id>
    <published>2024-01-09T00:00:00.000Z</published>
    <updated>2024-03-03T23:51:41.876Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Office サポートチームです。<br>この記事では、iOS 端末で Excel ファイルに対して描画をする際に、<br>アプリが強制終了する動作について記載します。    </p><h1 id="事象の概要"><a href="#事象の概要" class="headerlink" title="事象の概要"></a>事象の概要</h1><p>以下公開情報の通り、Office では　[描画] 機能を使用することで、Excel ファイルに対して手書き入力を行うことが可能です。  </p><p>Title: Office で図形やテキストを手描き入力する<br>URL: <a href="https://support.microsoft.com/ja-jp/office/6d76c674-7f4b-414d-b67f-b3ffef6ccf53#OfficeVersion=iOS">https://support.microsoft.com/ja-jp/office/6d76c674-7f4b-414d-b67f-b3ffef6ccf53#OfficeVersion=iOS</a></p><p>本描画機能に関連して、iOS 端末の Excel アプリや Microsoft 365 アプリにて、<br>一度 Excel ファイルを開いて閉じるまでの間に、<br>Excel ファイルに対して長時間の描画などによって多く描画オブジェクトを作成する場合に、<br>アプリが強制終了する動作が確認されております。<br>※アプリ内部でのメモリ使用状況等によって事象が再現するとみられ、具体的な目安等についてはご案内が困難となります。  </p><h1 id="今後の対応予定"><a href="#今後の対応予定" class="headerlink" title="今後の対応予定"></a>今後の対応予定</h1><p>本動作について、現在開発部門にて詳細な原因・今後の改善可否等を含め調査中となります。<br>新たな情報が確認された場合は、この記事に追記する形で公開していく予定です。  </p><p>今回の投稿は以上です。<br>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは。Office サポートチームです。&lt;br&gt;この記事では、iOS 端末で Excel ファイルに対して描画をする際に、&lt;br&gt;アプリが強制終了する動作について記載します。    &lt;/p&gt;
&lt;h1 id=&quot;事象の概要&quot;&gt;&lt;a href=&quot;#事象の概要&quot; class=</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Office で利用するプロキシ設定について</title>
    <link href="https://officesupportjp.github.io/blog/clr09r8tu00002wkjcubph9b8/"/>
    <id>https://officesupportjp.github.io/blog/clr09r8tu00002wkjcubph9b8/</id>
    <published>2024-01-04T15:00:00.000Z</published>
    <updated>2024-01-05T07:13:54.277Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直)です。  </p><p>本記事では、Office で利用するプロキシ設定について説明します。</p><h2 id="説明"><a href="#説明" class="headerlink" title="説明"></a>説明</h2><p>Office には、オンライン画像の挿入やオンラインテンプレートの取得などインターネット通信を利用する機能がございます。<br>このプロキシ設定はログオンユーザーの OS のプロキシ設定 (WinINET) が利用されます。WinHTTP のプロキシ設定は利用されません。</p><p>ただし、Office 2019 以降や Microsoft 365 クライアントで存在する自動更新の処理等の一部の機能については、以下の順でそれぞれのプロキシ設定を参照することがございます。</p><ol><li>WinHTTP (存在しない場合、スキップされます。また、構成していても、処理によっては参照しない場合がございます)</li><li>SYSTEM ユーザーの OS のプロキシ設定 (WinINET)</li><li>ログオンユーザーの OS のプロキシ設定 (WinINET) (ただし、ユーザーがログオンしている場合に限ります)</li></ol><p>最終的には 3 が利用されるため、1 や 2 を構成せずとも 3 を構成しておくことで通信は出来るものとなります。<br>なお、この動作を無効化したり順番を変更することは出来ません。また、処理内容によっては 1 と 2 を使用しない場合もございます。</p><h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><p><strong>Office が利用するエンドポイントを教えてください</strong><br><a href="https://learn.microsoft.com/ja-jp/microsoft-365/enterprise/urls-and-ip-address-ranges?view=o365-worldwide">Office 365 の URL と IP アドレスの範囲</a>をご確認ください。</p><p><strong>Office でネットワーク接続がない旨のメッセージが表示されます</strong><br><a href="https://officesupportjp.github.io/blog/cl0m75al4001gmcvse36w64dv/">Office のサインインでネットワーク接続がない旨のメッセージが表示される事象について</a>をご確認ください。</p><p><strong>必要なサービスが無効になっていますと表示されます</strong><br><a href="https://officesupportjp.github.io/blog/clmk7jget0001hckj66na16pi/">必要なサービスが無効になっていますと表示される現象について</a>をご確認ください。</p><p><strong>GPO プロキシ設定を配布していますが、2 の SYSTEM ユーザーのプロキシ設定は変更されますか</strong><br>GPO は OS ログオン時に設定されますため、2 の SYSTEM ユーザーのプロキシ設定は変更されません。<br>2 の SYSTEM ユーザーのプロキシ設定を変更するには、<a href="https://docs.microsoft.com/ja-jp/windows/win32/bits/bitsadmin-tool">BitsAdmin コマンド</a>を利用する方法があります。</p><p>プロキシサーバー “192.168.1.1:8080” を指定する場合の例)<br>bitsadmin &#x2F;util &#x2F;setieproxy localsystem MANUAL_PROXY 192.168.1.1:8080 “”</p><p>バイパスリストを含め指定する場合の例)<br>bitsadmin &#x2F;util &#x2F;setieproxy localsystem MANUAL_PROXY 192.168.1.1:8080 “*.microsoft.com”</p><p>pac ファイル <a href="http://server/proxy.pac">http://server/proxy.pac</a> を指定する場合の例)<br>bitsadmin &#x2F;util &#x2F;setieproxy localsystem AUTOSCRIPT <a href="http://server/proxy.pac">http://server/proxy.pac</a></p><p>設定をリセットする方法)<br>bitsadmin &#x2F;util &#x2F;setieproxy localsystem NO_PROXY</p><p>設定を確認する方法)<br>bitsadmin &#x2F;util &#x2F;getieproxy localsystem</p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Office サポートの西川 (直)です。  &lt;/p&gt;
&lt;p&gt;本記事では、Office で利用するプロキシ設定について説明します。&lt;/p&gt;
&lt;h2 id=&quot;説明&quot;&gt;&lt;a href=&quot;#説明&quot; class=&quot;headerlink&quot; title=&quot;説明&quot;&gt;&lt;/a&gt;説</summary>
      
    
    
    
    
    <category term="サインイン、認証" scheme="https://officesupportjp.github.io/blog/tags/%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%80%81%E8%AA%8D%E8%A8%BC/"/>
    
  </entry>
  
  <entry>
    <title>MECM で M365Apps の更新プログラムが必要と判定されない</title>
    <link href="https://officesupportjp.github.io/blog/clqm07fq300005kkj5ww5bp4a/"/>
    <id>https://officesupportjp.github.io/blog/clqm07fq300005kkj5ww5bp4a/</id>
    <published>2023-12-26T00:00:00.000Z</published>
    <updated>2024-11-28T07:57:07.715Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直)です。  </p><p>MECM (Microsoft Endpoint Configuration Manager) で M365Apps (Microsoft 365 Apps for enterprise) の更新プログラムが必要と判定されない現象について説明します。</p><br><h2 id="現象"><a href="#現象" class="headerlink" title="現象"></a>現象</h2><p>MECM で M365Apps の更新プログラムが必要と判定されず、更新が適用できない</p><br><h2 id="対処方法"><a href="#対処方法" class="headerlink" title="対処方法"></a>対処方法</h2><p>以下の 3 つの条件を全て満たしているかをご確認ください。</p><p><strong>1) Office の更新に使用する COM IF のレジストリキーが存在する</strong><br><code>HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\&#123;B7F1785F-D69B-46F1-92FC-D2DE9C994F13&#125;</code></p><p>本レジストリは、<a href="https://learn.microsoft.com/ja-jp/deployoffice/updates/manage-microsoft-365-apps-updates-configuration-manager#enable-microsoft-365-apps-clients-to-receive-updates-from-configuration-manager">MECM から更新プログラムを受信できるようにする設定</a>が反映された後、OS を再起動することで作成されます。</p><br><p><strong>2) VersionToReport より新しいビルドを展開しようとしている、または、UpdateChannelChanged が True である</strong><br><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\ClickToRun\Configuration\VersionToReport</code><br>ここには、16.0.12345.12345 のような 16.0 部分は固定のビルド番号が入ります。</p><p><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\ClickToRun\Configuration\UpdateChannelChanged</code><br>初期値は False であり、後述のように UpdateChannel が優先度により変更された際に True となります。その後、更新試行を行った後に False に戻ります。</p><p>通常、チャネルの変更直後を除いて UpdateChannelChanged は False のため、VersionToReport の優劣にしたがい更新が行われます。</p><br><p><strong>3) UpdateChannel の URL に展開しているチャネルの識別子が含まれる</strong><br><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\ClickToRun\Configuration\UpdateChannel</code></p><p><em><strong>チャネルの識別子</strong></em><br><code>最新チャネル : 492350f6-3a01-4f97-b9c0-c7c6ddf67d60</code><br><code>月次エンタープライズチャネル : 55336b82-a18d-4dd6-b5f6-9e5095c314a6</code><br><code>半期エンタープライズチャネル (プレビュー : b8f9b850-328d-4355-9145-c59439a0c4cf</code><br><code>半期エンタープライズチャネル : 7ffbc6bf-bc32-4f92-8982-f9dd17fd3114</code></p><p>UpdateChannel は UpdateChannelChanged が False である場合、以下の優先度を上から順に評価します。</p><p>優先度1) <a href="https://learn.microsoft.com/ja-jp/deployoffice/updates/configure-update-settings-microsoft-365-apps">GPO の “更新プログラムのパス”</a><br><code>HKEY_LOCAL_MACHINE\software\policies\microsoft\office\16.0\common\OfficeUpdate\updatepath</code></p><p>優先度2) <a href="https://learn.microsoft.com/ja-jp/deployoffice/updates/configure-update-settings-microsoft-365-apps">GPO の “チャネルの更新”</a><br><code>HKEY_LOCAL_MACHINE\software\policies\microsoft\office\16.0\common\OfficeUpdate\updatebranch</code></p><p>優先度3) <a href="https://learn.microsoft.com/ja-jp/deployoffice/office-deployment-tool-configuration-options#updates-element">Office 展開ツールの Updates 要素の UpdatePath 属性</a><br><code>HKEY_LOCAL_MACHINE\Software\Microsoft\Office\ClickToRun\Configuration\UpdateUrl</code></p><p>優先度4) <a href="https://learn.microsoft.com/ja-jp/deployoffice/manage-software-download-settings-office-365">Microsoft 365 管理センターで Microsoft 365 のインストール オプションを管理する</a> の取得頻度<br><code>HKEY_LOCAL_MACHINE\Software\Microsoft\Office\ClickToRun\Configuration\UnmanagedUpdateUrl</code></p><p>優先度5) <a href="https://learn.microsoft.com/ja-jp/deployoffice/office-deployment-tool-configuration-options#updates-element">Office 展開ツールの Updates 要素の Channel 属性</a><br><code>HKEY_LOCAL_MACHINE\Software\Microsoft\Office\ClickToRun\Configuration\CDNBaseURL</code></p><p>現在の UpdateChannel と値が異なる場合、評価された値に上書きされ、UpdateChannelChanged が True となります。</p><br><h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><p><strong>UpdateChannel が変更されるタイミングを教えてください</strong><br>タスクスケジューラーに登録されている Office Automatic Updates 2.0 が実行する OfficeC2RClient.exe の中で、前回の構成試行より 24 時間以上経過している場合に構成処理を行います。<br>このため、タスクスケジューラーを手動実行いただいても即座に実行することは出来ません。また、この時間を変更することは出来ません。</p><p><strong>優先度1 や 3 が入っている端末に MECM から更新プログラムを展開できますか？</strong><br>優先度1 は “未構成” に変更してください。優先度 3 の場合、UpdateUrl レジストリを削除していただくか、優先度 2 の GPO の “チャネルの更新” を代わりにご利用ください<br>なお、”チャネルの更新” を設定すると、MECM もしくはインターネット上の Office CDN から更新プログラムを取得するようになります。MECM で管理しない端末に設定する際はご留意ください。</p><p><strong>UpdateChannelChanged が既に True になっているため、優先度にしたがって設定を変更しても端末に反映されません</strong><br>UpdateChannelChanged を一度だけ False に書き換えてください。</p><p><strong>優先度4の UnmanagedUpdateUrl のチャネルを変更したいのですが、Microsoft 365 管理センターで半期エンタープライズチャネルを選択できません</strong><br>UnmanagedUpdateUrl レジストリを削除していただくか、優先度 2 の GPO の “チャネルの更新” を代わりにご利用ください<br>なお、”チャネルの更新” を設定すると、MECM もしくはインターネット上の Office CDN から更新プログラムを取得するようになります。MECM で管理しない端末に設定する際はご留意ください。</p><p><strong>MECM から更新しているのに、優先度4 の UnmanagedUpdateUrl レジストリが設定されているのはなぜですか？</strong><br><a href="https://learn.microsoft.com/ja-jp/deployoffice/updates/manage-microsoft-365-apps-updates-configuration-manager#enable-microsoft-365-apps-clients-to-receive-updates-from-configuration-manager">方法3</a> の Office 展開ツールでのインストール時に OfficeMgmtCOM を True で設定していない場合、端末に MECM から更新する設定が反映される前に M365Apps の自動更新が動作した可能性があります。</p><p><strong>MECM から更新したいのに、Office CDN から更新されてしまいます</strong><br><a href="https://learn.microsoft.com/ja-jp/microsoft-365-apps/admin-center/cloud-update">クラウド更新</a> が有効になっている可能性がございます。<br><code>HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\cloud\office\16.0\Common\officeupdate\IgnoreGPO</code> が 1 の場合、全ての更新設定よりクラウド更新が優先されます。</p><p><a href="https://learn.microsoft.com/ja-jp/microsoft-365-apps/admin-center/cloud-update">クラウド更新</a> が不要な場合、<a href="https://config.office.com/">Microsoft 365 Apps 管理センター</a> において、クラウド更新に進みます。<br>もし、クラウド更新が有効となっていない場合、有効化しないでください。<br>クラウド更新が有効な場合、各チャネルの設定 - クラウド更新のレビュー において、”クラウド更新を通じて管理を非アクティブ化できます” をクリックしてください。フォームの入力画面が表示されますので、記載を進めて送信してください。</p><p>そして、即座に反映させるため、GPO 等にて、<code>HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\cloud\office\16.0\Common\officeupdate\IgnoreGPO</code> を DWORD の 0 に指定して配布してください。</p><p><strong>COM IF のレジストリキーが作成されません</strong><br>何らかの影響により、端末で COM 登録が行えていない可能性があります。</p><p>対象の端末で、PowerShell を管理者権限で起動し、以下の 2 行を実行いただき、エラーが出るかをご確認ください。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$comCatalog = New-Object -ComObject COMAdmin.COMAdminCatalog</span><br><span class="line">$appColl = $comCatalog.GetCollection(&quot;Applications&quot;)</span><br></pre></td></tr></table></figure><p><strong>エラーが出る場合</strong><br>OS 観点で調査が必要であると考えられます。</p><p><strong>エラーが出ない場合</strong><br>以下の手順をご実施ください。</p><ol><li><p>以下の REG_DWORD レジストリに 0 を設定します。<br><code>HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\office\16.0\Common\officeupdate\OfficeMgmtCOM</code></p></li><li><p>スタートメニューの検索にて、「サービス」と検索し、サービスを起動します</p></li><li><p>“Microsoft Office クイック実行サービス” を右クリックし、”再起動” を実施します。</p></li><li><p>以下の REG_DWORD レジストリに 1 を設定します。<br><code>HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\office\16.0\Common\officeupdate\OfficeMgmtCOM</code></p></li><li><p>“Microsoft Office クイック実行サービス” を右クリックし、”再起動” を実施します。</p></li><li><p>COM IF のレジストリキーが作成されるかをご確認ください。</p></li></ol><br><h2 id="参考資料"><a href="#参考資料" class="headerlink" title="参考資料"></a>参考資料</h2><p><a href="https://techcommunity.microsoft.com/t5/microsoft-365-blog/how-to-manage-office-365-proplus-channels-for-it-pros/ba-p/795813">How to manage Office 365 ProPlus Channels for IT Pros</a></p><p><span style="color:#ff0000"><strong>2023&#x2F;12&#x2F;27  Update</strong></span><br><span style="color:#339966">一部記載を変更しました</span></p><p><span style="color:#ff0000"><strong>2024&#x2F;3&#x2F;4  Update</strong></span><br><span style="color:#339966">一部記載を修正しました</span></p><p><span style="color:#ff0000"><strong>2024&#x2F;11&#x2F;28  Update</strong></span><br><span style="color:#339966">クラウド更新について追記しました</span></p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Office サポートの西川 (直)です。  &lt;/p&gt;
&lt;p&gt;MECM (Microsoft Endpoint Configuration Manager) で M365Apps (Microsoft 365 Apps for enterprise) の更新プロ</summary>
      
    
    
    
    
    <category term="更新" scheme="https://officesupportjp.github.io/blog/tags/%E6%9B%B4%E6%96%B0/"/>
    
  </entry>
  
  <entry>
    <title>Excel で図形やテキストの表示・印刷でずれやサイズ変化が生じる理由と対処</title>
    <link href="https://officesupportjp.github.io/blog/clp858vmy0000wosea1uya8uj/"/>
    <id>https://officesupportjp.github.io/blog/clp858vmy0000wosea1uya8uj/</id>
    <published>2023-11-21T00:00:00.000Z</published>
    <updated>2023-12-26T06:53:45.352Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームの中村です。</p><p>Excel ファイルにおいて、異なる端末で同じブックを開いたときの表示や印刷結果における、以下のような差異についてお問い合わせを頂くことがあります。</p><p><strong>現象の例</strong>  </p><ul><li>図形やセルの縦横比が変化する</li><li>図形やセル内のテキストが見切れる、または文字列折り返し位置がずれる</li><li>図形同士、または図形とセルの位置関係がずれる</li><li>改ページ位置が変化する (1 枚に収めていた範囲が 2 枚になる、など)<br></li></ul><p>これらの動作は、多くの場合、Excel の表示・印刷レイアウトを計算する仕組みに依存する制限事項によるものです。本記事では、この Excel のレイアウト計算概要と回避・軽減策について説明します。<br><br></p><p><strong><h2>Excel のレイアウト計算</h2></strong><br>Excel では、列の幅 &#x2F; 行の高さ &#x2F; 図形のサイズや表示位置 &#x2F; 改ページ位置といったレイアウト情報を、ブックに保存されたサイズ・表示位置などの情報を基に、ディスプレイ ドライバーやプリンター ドライバーからの応答を合わせて計算します。つまり、この計算結果はディスプレイ設定やプリンター設定の影響を受け、その計算の過程で丸め誤差が生じます。<br>この結果、ディスプレイやプリンター関連の設定や、そもそも利用しているディスプレイ、プリンターが異なることにより、マシン間で表示差異が生じることがあります。  </p><p>Excel は、表計算を主目的とするアプリケーション ソフトである性格上、大量の行列の表示やスクロールのパフォーマンス向上を優先し、レイアウトに関わる計算をある程度簡略化しています。このため、上記のような誤差を設計上許容しており、異なる環境におけるレイアウトの厳密な一致は保証されません。  </p><p>参考) 列の幅の計算に関しては、以下の公開情報で詳しく説明しています。<br>Excel で列の幅を決定する方法の説明<br><a href="https://learn.microsoft.com/ja-JP/office/troubleshoot/excel/determine-column-widths">https://learn.microsoft.com/ja-JP/office/troubleshoot/excel/determine-column-widths</a><br><br></p><p><strong><h2>回避方法</h2></strong><br>大きく分けて、対応の方向性は以下のいずれかとなります。</p><p>a. ブック作成時の工夫で影響を軽減する<br>b. 表示を合わせたいマシン間のディスプレイ・印刷設定を合わせる</p><p>以下にそれぞれの方向で、主に効果が期待できる設定を記載します。<br>ただし、a. の方向の対応は、ファイルの構成によってはほぼ差異が気にならなくなりますが、現象や環境によっては効果がありません。<br>一方、b. については Excel 表示のためだけにディスプレイ表示倍率を変えると、ユーザーが画面を見づらくなったり、また、同じディスプレイやプリンターを使用できず、完全に一致させることは難しい状況が多いと考えられます。(一部の設定のみでも効果がある場合もあります。)<br>状況に応じて、どの回避方法が適しているかをご検討ください。<br><br></p><p><strong><u><h3>a. ブック作成時の工夫で影響を軽減する</h3></u></strong> </p><p><strong><h3>a-1. 図形をグループ化して位置関係を保持する</h3></strong><br>例えば、ある図形内部にきれいに納まるように別の図形を配置したものが、別の環境ではみ出している、といった図形同士のずれの場合は、それらの図形をグループ化すると位置関係を概ね保持できます。  </p><p>図形、図、その他のオブジェクトをグループ化またはグループ解除する<br><a href="https://support.microsoft.com/ja-jp/topic/a7374c35-20fe-4e0a-9637-7de7d844724b">https://support.microsoft.com/ja-jp/topic/a7374c35-20fe-4e0a-9637-7de7d844724b</a><br><br></p><p><strong><h3>a-2. サイズに余裕を持たせて文字列の見切れを防ぐ </h3></strong><br>図形やセル内の文字列が見切れてしまう場合、多少の誤差が生じても問題ないよう、ある程度余裕を持ったサイズに設定します。<br>また、改ページのずれに対しても同様に、1 ページにおさめる範囲に余裕を持っておくと、改ページ位置がずれたときにページを跨ぐことを防げます。<br><br></p><p><strong><h3>a-3. セルやテキストに合わせた図形の調整を変更して差異を軽減する </h3></strong><br>図形のプロパティにある以下の項目は、セルのサイズが変化したときに、図形の位置やサイズを調整するかどうかを変更する設定です。<br>図形自身のみでも、本記事で説明する計算結果の丸め誤差は生じるため、セルに合わせた移動やサイズ変更をしないようにしても完全に回避はできません。ただ、状況によっては、セルに合わせた調整を行わないことで軽減できたり、また反対に、セルに合わせて調整することで位置関係が保持され、より望ましい表示となる場合があります。<br>また、テキストに合わせた図形サイズ調整の設定も、図形のサイズに影響するため同様に効果がある場合があります。  </p><p><img src="/blog/clp858vmy0000wosea1uya8uj/ShapeProperty.png"><br><br></p><p><strong><h3>a-4. 図形の行列跨ぎの有無で差異を軽減する </h3></strong><br>複数の行や列に跨るように図形を配置すると、行・列の計算誤差の影響をより大きく受け、図形の位置ずれやサイズの差異が大きくなる場合があります。このような場合、行や列を跨がないよう図形を配置することで差異を軽減できます。また反対に、図形自身の計算結果による差異が、行や列を跨ることで生じる差異と相殺され、かえって表示が改善する場合もあります。<br>特に帳票のような用途で整形したシートなどでは、行や列を追加してここに納まるよう (またはあえてこれを跨ぐよう) 図形を配置し、これに合わせて全体のフォーマットを調整すると、期待する表示に近づく場合があります。<br><br></p><p><strong><h3>a-5. 改ページの自動調整を利用してページ数の変化を防ぐ </h3></strong><br>改ページ位置がずれる現象への対処として、印刷範囲を指定ページ数に納まるよう自動調整する機能を用いて印刷設定を行うと、どの環境でも同じページ数で印刷できます。</p><p>1 ページに収める<br><a href="https://support.microsoft.com/ja-jp/office/f3015be3-e007-4762-90a7-19ebc8052511">https://support.microsoft.com/ja-jp/office/f3015be3-e007-4762-90a7-19ebc8052511</a><br><br></p><p><strong><h3>a-6. テンプレートをクライアントごとに調整して都度対応を避ける </h3></strong><br>例えば帳票作成アプリケーションなどには、予めレイアウトを用意した Excel テンプレートに値を設定してファイルを作成するものがあります。このようなアプリの出力ファイルで現象が生じる場合は、初めに各クライアントでその環境で適切な表示となるよう、テンプレート上でセルのサイズや図形の位置などをカスタマイズして利用すると、帳票作成の都度、レイアウトを調整する手間を省くことができます。<br>(なお、先述の通り Excel は表計算ソフトとして設計されているため、帳票のようなレイアウトを重視するドキュメントには、本来 Word 文書の利用をお勧めします。)<br><br><br><br></p><p><strong><u><h3>b. マシン間のディスプレイ・印刷設定を合わせる</h3></u></strong><br>Excel の表示計算に関わる各種設定を以下に記載します。ファイルを作成した環境 (期待する表示レイアウトの環境) と、サイズ差異などが生じているマシン間で、これらの設定値を合わせてください。<br>全ての設定を合わせられない場合も、一部の設定の統一で回避する場合もあります。また、設定値の組み合わせ次第で、誤差が相殺され影響が少ない場合もあります。状況に応じて様々な組み合わせをお試しください。<br><br></p><p><strong><h3>b-1. Excel のディスプレイ設定</h3></strong><br>Excel の [オプション] - [全般] - [複数ディスプレイを使用する場合] の [表示を優先した最適化] &#x2F; [互換性に対応した最適化] の選択を変更します。設定の変更後、反映のため Excel を再起動してください。<br><br></p><p><strong><h3>b-2. Windows のディスプレイ設定 - テキスト表示倍率設定</h3></strong><br>&lt;Windows 10&gt;<br>Windows の [設定] - [システム] - [ディスプレイ] - [拡大縮小とレイアウト] セクションの [テキスト、アプリ、その他の項目のサイズを変更する] で表示倍率 (%) を変更します。 </p><p>&lt;Windows 11&gt;<br>Windows の [設定] - [システム] - [ディスプレイ] - [拡大縮小とレイアウト] セクションの [拡大&#x2F;縮小] で表示倍率 (%) を変更します。  </p><p>※ 本設定を含め、以降の Windows 設定の変更後は、設定の確実な反映のため、ユーザーの再サインイン、または OS 再起動を行うことをお勧めします。<br><br></p><p><strong><h3>b-3. Windows のディスプレイ設定 - アクセシビリティ設定</h3></strong><br>&lt;Windows 10&gt;<br>Windows の [設定] - [簡単操作] - [ディスプレイ] - [文字を大きくする] のスライダーで表示倍率 (%) を変更します。   </p><p>&lt;Windows 11&gt;<br>Windows の [設定] - [アクセシビリティ] - [テキストのサイズ] のスライダーで表示倍率 (%) を変更します。<br><br></p><p><strong><h3>b-4. Windows のディスプレイ設定 - カスタムスケーリング設定</h3></strong><br>&lt;Windows 10&gt;<br>Windows の [設定] - [システム] - [ディスプレイ] - [表示スケールの詳細設定] をクリックして遷移する画面の [カスタム スケーリング] の値 (%) を変更します。  </p><p>&lt;Windows 11&gt;<br>Windows の [設定] - [システム] - [ディスプレイ] - [拡大&#x2F;縮小] - [カスタム スケーリング] の値 (%) を変更します。<br><br></p><p><strong><h3>b-5. Windows のディスプレイ設定 - 自動スケーリング設定</h3></strong><br>&lt;Windows 10 のみ&gt;<br>Windows の [設定] - [システム] - [ディスプレイ] - [表示スケールの詳細設定] をクリックして遷移する画面の [アプリが鮮明に表示されるように Windows により修正を試す] を変更します。<br><br></p><p><strong><h3>b-6. Windows のディスプレイ設定 - 解像度設定</h3></strong><br>&lt;Windows 10 &#x2F; Windows 11&gt;<br>Windows の [設定] - [システム] - [ディスプレイ] - [ディスプレイの解像度] を変更します。<br><br></p><p><strong><h3>b-7. プリンター設定</h3></strong><br>異なるプリンターを利用している場合、既定のプリンターを合わせます。  </p><p>&lt;Windows 10&gt;<br>Windows の [設定] - [デバイス] - [プリンターとスキャナー] の [Windows で通常使うプリンターを管理する] をオフにした上で、既定に設定するプリンターを選択して [管理] をクリックし、[既定として設定する] をクリックします。  </p><p>&lt;Windows 11&gt;<br>Windows の [設定] - [Bluetooth とデバイス] - [プリンターとスキャナー] の [Windows で通常使うプリンターを管理する] をオフにした上で、既定に設定するプリンターを選択し、[既定として設定する] をクリックします。  </p><p>また、同一のプリンターを利用している場合、プリンターの [印刷設定] などのプリンター固有の設定画面で DPI 等の設定を合わせます。<br><br></p><p>今回の投稿は以上です。</p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong>  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Office サポート チームの中村です。&lt;/p&gt;
&lt;p&gt;Excel ファイルにおいて、異なる端末で同じブックを開いたときの表示や印刷結果における、以下のような差異についてお問い合わせを頂くことがあります。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;現象の例&lt;/strong</summary>
      
    
    
    
    
    <category term="印刷" scheme="https://officesupportjp.github.io/blog/tags/%E5%8D%B0%E5%88%B7/"/>
    
    <category term="Excel" scheme="https://officesupportjp.github.io/blog/tags/Excel/"/>
    
    <category term="描画" scheme="https://officesupportjp.github.io/blog/tags/%E6%8F%8F%E7%94%BB/"/>
    
  </entry>
  
  <entry>
    <title>信頼済みドキュメントに関するコンテンツ ブロックメッセージの説明 (MC302216)</title>
    <link href="https://officesupportjp.github.io/blog/clj709nu4004pqou8fyhg7wta/"/>
    <id>https://officesupportjp.github.io/blog/clj709nu4004pqou8fyhg7wta/</id>
    <published>2023-10-09T00:00:00.000Z</published>
    <updated>2023-12-26T06:53:45.354Z</updated>
    
    <content type="html"><![CDATA[<p><span style="color:#ff0000"><strong>2023&#x2F;10&#x2F;09 Update</strong></span><br><span style="color:#339966">有害サイトと分類されていたため移動しました。</span><br><br><br>こんにちは、Office サポート チームの中村です。  </p><p>現在、Microsoft 365 Apps で Office ファイルを開くと、以下のメッセージが表示されることがあります。<br><img src="/blog/clj709nu4004pqou8fyhg7wta/TrustDocBlockMsg.png">  </p><p>このメッセージは、Microsoft 365 Apps の仕様変更 (MC302216) によって表示されるようになりました。今回の記事では、この仕様変更の概要と、メッセージが表示される理由の特定方法や対処方法を記載します。<br><br></p><p><strong>目次</strong><br><a href="#1-%E4%BF%A1%E9%A0%BC%E6%B8%88%E3%81%BF%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E3%81%A8%E3%81%AF">1. 信頼済みドキュメントとは</a><br><a href="#2-%E4%BB%95%E6%A7%98%E5%A4%89%E6%9B%B4%E3%81%AE%E6%A6%82%E8%A6%81">2. 仕様変更の概要</a><br><a href="#3-%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E8%A1%A8%E7%A4%BA%E7%90%86%E7%94%B1%E3%81%AE%E7%89%B9%E5%AE%9A%E6%96%B9%E6%B3%95">3. メッセージ表示理由の特定方法</a><br><a href="#4-%E5%AF%BE%E5%87%A6%E6%96%B9%E6%B3%95">4. 対処方法</a><br><a href="#4-1-%E4%BF%A1%E9%A0%BC%E6%B8%88%E3%81%BF%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E3%82%92%E3%82%AF%E3%83%AA%E3%82%A2%E3%83%BB%E7%84%A1%E5%8A%B9%E5%8C%96%E3%81%99%E3%82%8B">4-1. 信頼済みドキュメントをクリア・無効化する</a><br><a href="#4-2-%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%81%AE%E3%81%BF%E3%82%92%E9%9D%9E%E8%A1%A8%E7%A4%BA%E3%81%AB%E3%81%99%E3%82%8B">4-2. メッセージのみを非表示にする</a><br><a href="#4-3-%E4%BF%A1%E9%A0%BC%E3%81%A7%E3%81%8D%E3%82%8B%E5%A0%B4%E6%89%80%E3%81%AB%E4%BF%9D%E5%AD%98%E3%81%99%E3%82%8B">4-3. 信頼できる場所に保存する</a><br><a href="#4-4-%E3%82%B3%E3%83%B3%E3%83%86%E3%83%B3%E3%83%84%E3%82%92%E7%84%A1%E5%8A%B9%E3%81%AB%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E8%A8%AD%E5%AE%9A%E3%82%92%E7%B7%A9%E5%92%8C%E3%81%99%E3%82%8B">4-4. コンテンツを無効にしている設定を緩和する</a>  </p><br><h2 id="1-信頼済みドキュメントとは"><a href="#1-信頼済みドキュメントとは" class="headerlink" title="1. 信頼済みドキュメントとは"></a>1. 信頼済みドキュメントとは</h2><p>Office には「信頼」という考え方があります。Office の既定の設定では、ファイルに含まれるマクロ、ActiveX、外部データ接続などの「アクティブ コンテンツ」は、ファイルを開いた時点では一旦無効化された状態とし、以下のような警告バーを表示してユーザーに手動でコンテンツを有効化するよう求めます。ファイルを信頼すると、このような警告なしにアクティブ コンテンツを自動的に有効にできます。<br><img src="/blog/clj709nu4004pqou8fyhg7wta/ContentWarn.png"></p><p>ファイルを信頼する方法の 1 つに「信頼済みドキュメント」があります。以下の場合にそのファイルが信頼済みドキュメントとして登録されます。</p><ul><li>ローカルにあるファイルのアクティブ コンテンツを有効化する</li><li>ネットワーク共有上のファイルのアクティブ コンテンツを有効化し、信頼済みドキュメントへの登録確認メッセージで [はい] を選択する (オプションのトラスト センターでネットワーク上のドキュメントを信頼することを許可している場合のみ)  <img src="/blog/clj709nu4004pqou8fyhg7wta/NWTrustDoc.png"></li></ul><p>参考) 信頼済みドキュメント<br><a href="https://support.microsoft.com/ja-jp/office/cf872bd8-47ec-4c02-baa5-1fdba1a11b53">https://support.microsoft.com/ja-jp/office/cf872bd8-47ec-4c02-baa5-1fdba1a11b53</a></p><br><h2 id="2-仕様変更の概要"><a href="#2-仕様変更の概要" class="headerlink" title="2. 仕様変更の概要"></a>2. 仕様変更の概要</h2><p>Microsoft 365 Apps で、信頼済みドキュメントの扱いを変更しました。影響を受ける流れをイメージしやすくするため、まずは具体的な例を挙げます。</p><p>&lt;例: マクロを含むファイルと、VBA マクロのセキュリティ設定の場合&gt;</p><p><u>これまでの動作</u></p><ol><li>[トラスト センター] - [トラスト センターの設定] - [マクロの設定] を [警告して、VBA マクロを無効にする] に設定します。(マクロをユーザーが任意に有効にできる設定です)</li><li>ユーザーがローカルにあるマクロを含むファイルを開くと、警告バーが表示されます。<br><img src="/blog/clj709nu4004pqou8fyhg7wta/ContentWarn.png"></li><li>警告バーの [コンテンツの有効化] をクリックすると、マクロは有効になり、このファイルは信頼済みドキュメントに登録されます。</li><li>ユーザーがファイルを開き直すと、信頼済みドキュメントのため、警告バーの表示なしにマクロは自動的に有効になります。</li><li>[トラスト センター] - [トラスト センターの設定] - [マクロの設定] を [警告せずに VBA マクロを無効にする] に変更します。(ユーザー操作によるマクロ有効化ができず、マクロをブロックする設定です)</li><li>Excel をいったん終了して、先ほどの信頼済みドキュメントに登録されたファイルを開きます。</li><li>警告バーの表示なしにマクロは自動的に有効になります。</li></ol><p>ポイント:<br>5. でマクロをブロックするように変更した後も、その前に信頼済みドキュメントに登録されたファイルのマクロは 7. で自動的にマクロが有効になります。</p><p><u>変更後の動作</u><br>1 ～ 6 までは、&lt;これまでの動作&gt; と同じです。5. でマクロをブロックするよう設定を変更した後に、信頼済みドキュメントに登録済みのファイルを開くと、以下の通り動作が変わります。  </p><ol start="7"><li><ol start="5"><li>で変更したトラスト センターの設定に従って、<strong>マクロは無効化</strong>されます。そして、以下の警告バーを表示します。<br><img src="/blog/clj709nu4004pqou8fyhg7wta/TrustDocBlockMsg.png"><br></li></ol></li></ol><p>この例の通り、これまでは信頼済みドキュメントに登録すると、その後トラスト センターでアクティブ コンテンツ (上記の例ではマクロ) を無効化しても、自動的に有効になっていました。また、管理者がポリシーでアクティブ コンテンツを無効にした場合も同様でした。  </p><p>今後は、過去に 1 度信頼済みドキュメントに登録していても、トラスト センターやポリシーの設定に従ってアクティブ コンテンツを無効化します。そして、このような状況では、ユーザーに動作の変更を通知するため、新しい警告バーを表示するようになりました。これが、冒頭で記載した警告バーです。  </p><p><strong><u>まとめ</u></strong><br>今回の仕様変更により、Office の動作が以下のように変化します。</p><ul><li>信頼済みドキュメントでも、トラスト センターやポリシーで無効化しているアクティブ コンテンツは無効になります。</li><li>信頼済みドキュメントを開いたときに無効化したアクティブ コンテンツがある場合、警告バーが表示されます。</li></ul><p>注)<br>この影響を受けるのは、Office 運用開始後にアクティブ コンテンツをブロックするよう<u><strong>設定 (トラスト センターやポリシー) を厳しく変更した場合</strong></u>です。はじめからアクティブ コンテンツがブロックされている場合は、これを有効にしてファイルを信頼済みドキュメントに登録することができないため、影響はありません。<br>※ ポリシーの変更が、仕様変更の後である必要はありません。「信頼済みドキュメント登録 -&gt; ポリシーでブロック -&gt; この仕様変更」の流れでも影響を受けます。<br><br></p><p><strong><u>仕様変更の背景</u></strong><br>近年、組織での Office のセキュリティ ポリシーはより厳しく管理される傾向にあります。よりセキュリティを厳しく制限したい管理者にとって、ポリシーを変更しても信頼済みドキュメントによって、本来は無効化を想定しているコンテンツを引き続き利用できることは好ましくありません。このような管理者の要望に応えるため、Microsoft 365 Apps で今回の動作変更を行いました。</p><br>この変更の詳細は、以下の公開情報でご案内しています。  <p>Office ドキュメントでアクティブなコンテンツを管理する<br><a href="https://learn.microsoft.com/ja-jp/microsoft-365/security/active-content-in-trusted-docs">https://learn.microsoft.com/ja-jp/microsoft-365/security/active-content-in-trusted-docs</a></p><p>また、変更を行った Microsoft 365 Apps のバージョンは以下の通りです。</p><ul><li>最新チャネル: バージョン 2111 (ビルド 14701.20226)  </li><li>月次エンタープライズ チャネル: バージョン 2203 (ビルド 15028.20248)  </li><li>半期エンタープライズ チャネル (プレビュー): バージョン 2208 (ビルド 15601.20148)  </li><li>半期エンタープライズ チャネル: バージョン 2208 (ビルド 15601.20456)  <br><br></li></ul><h2 id="3-メッセージ表示理由の特定方法"><a href="#3-メッセージ表示理由の特定方法" class="headerlink" title="3. メッセージ表示理由の特定方法"></a>3. メッセージ表示理由の特定方法</h2><p>[ファイル] タブ - [情報] に表示する [セキュリティ情報] の以下の赤枠の部分に、そのファイルでブロックされているアクティブ コンテンツが表示されます。<br><img src="/blog/clj709nu4004pqou8fyhg7wta/SecInfo.png"></p><p>このメッセージの [トラスト センターの設定] 部分をクリックすると、そのコンテンツを無効にしているトラスト センターの設定ページが開き、無効化されていることの確認や、設定の変更ができます。</p><p>一方、以下の場合はポリシーによってコンテンツが無効になっています。</p><ul><li>トラスト センターの設定項目がグレーアウトしていて変更できない</li><li>トラスト センターの設定ではコンテンツは無効になっていない</li><li>セキュリティ情報の無効化されているコンテンツの横に [トラスト センターの設定] リンクが表示されない</li></ul><p>この場合は、管理者が該当する可能性があるポリシーを確認します。ポリシーでのみ設定できるアクティブ コンテンツ関連の設定もあるため、以下の資料で、表の [カテゴリ] や [アプリ] が、現在無効になっているコンテンツの種類や、利用しているアプリと合致する各ポリシーの設定状況を確認してください。</p><p>Office ドキュメントでアクティブなコンテンツを管理する<br><a href="https://learn.microsoft.com/ja-jp/microsoft-365/security/active-content-in-trusted-docs?view=o365-worldwide#hkey_current_user-settings">https://learn.microsoft.com/ja-jp/microsoft-365/security/active-content-in-trusted-docs?view=o365-worldwide#hkey_current_user-settings</a><br>該当箇所: “HKEY_CURRENT_USER設定” &#x2F; “HKEY_LOCAL_MACHINE設定”</p><p>※ Microsoft 365 Apps で有効なポリシーを設定する方法には、以下の複数の方法があります。</p><ul><li>Microsoft 365 クラウド ポリシー</li><li>Active Directory やローカル マシンのグループ ポリシー</li><li>Intune Office アプリのポリシー</li></ul><p>なお、影響しているポリシーを特定しても、一般的には組織で決定したセキュリティ設定を緩和することは難しいと思います。特に特定の必要がなければ、影響するポリシーを確認する必要はありません。<br><br></p><h2 id="4-対処方法"><a href="#4-対処方法" class="headerlink" title="4. 対処方法"></a>4. 対処方法</h2><ul><li>実際にアクティブ コンテンツは無効でもよく、警告メッセージのみを表示したくない場合は、4-1. または 4-2. の方法が検討できます。  </li><li>アクティブ コンテンツを利用したい場合や、4-1. &#x2F; 4-2. の他への影響が好ましくない場合は、4-3. または 4-4. での対処を検討してください。</li><li>通常は、アクティブ コンテンツを利用する必要があるため、&lt;4-3. 信頼できる場所に保存する&gt; 方法での対処をお勧めします。</li></ul><br><h3 id="4-1-信頼済みドキュメントをクリア・無効化する"><a href="#4-1-信頼済みドキュメントをクリア・無効化する" class="headerlink" title="4-1. 信頼済みドキュメントをクリア・無効化する"></a>4-1. 信頼済みドキュメントをクリア・無効化する</h3><p>※ 警告メッセージのみを非表示にする方法です (アクティブ コンテンツはブロック)  </p><p>ファイルを信頼済みドキュメントと扱わないようにします。以下 2 種類の方法があります。</p><p><u>a) 信頼済みドキュメントを [クリア] する (トラスト センター)</u><br>そのアプリで登録済みの信頼済みドキュメントを全てクリアします。ただしこのとき、全てのファイルの信頼をクリアします。ブロックしていないコンテンツの信頼もクリアするため注意してください。<br>例:<br>ActiveX をブロックする設定を行っている場合、マクロのみを含むドキュメントは、信頼済みドキュメントに登録していれば自動的に有効になり、警告メッセージも表示しません。しかし、信頼済みドキュメントをクリアすると、このようなファイルも初回は一旦マクロは無効で開き、ユーザーが手動で [コンテンツの有効化] から有効にする必要があります。<br>ブロックされるコンテンツを含まないファイルは、1 度手動でコンテンツを有効化すると、信頼済みドキュメントに再登録できます。  </p><p><u>b) 信頼済みドキュメントを [無効] にする  (トラスト センター &#x2F; ポリシー)</u><br>信頼済みドキュメント機能自体を無効にします。すでに登録されている信頼済みドキュメントは信頼されなくなり、また新たに登録することもできません。a) と同様、ブロックされていないアクティブ コンテンツのみ含むファイルでも、手動で [コンテンツの有効化] が必要になります。<br>また、新たに信頼済みドキュメントに登録できないため、毎回手動での有効化が必要です。</p><p>トラスト センターでの設定は以下の画面キャプチャの赤枠のメニューから行います。<br><img src="/blog/clj709nu4004pqou8fyhg7wta/DisableTrustDocOption.png"></p><p>ポリシーの場合は、b) のみ以下赤枠の項目で設定できます。(画面キャプチャは Excel の例ですが、同項目が各アプリに存在します)<br><img src="/blog/clj709nu4004pqou8fyhg7wta/DisableTrustDocPolicy.png"></p><br><h3 id="4-2-メッセージのみを非表示にする"><a href="#4-2-メッセージのみを非表示にする" class="headerlink" title="4-2. メッセージのみを非表示にする"></a>4-2. メッセージのみを非表示にする</h3><p>※ 警告メッセージのみを非表示にする方法です (アクティブ コンテンツはブロック)  </p><p>信頼済みドキュメントに登録済みでも警告バーを表示したくない場合は、以下のオプションで [ブロックされた内容に関する情報を表示しない] に設定すると、アクティブ コンテンツのブロック メッセージを非表示にできます。<br><img src="/blog/clj709nu4004pqou8fyhg7wta/MsgBarOption.png"></p><p>この場合も、先述の [ファイル] タブ - [情報] のセキュリティ情報からブロック状態は確認できます。<br>ただし、<u><strong>信頼済みドキュメントに関する警告バー以外の、アクティブ コンテンツの無効化メッセージ バーもすべて非表示になる</strong></u>ため注意が必要です。(例: インターネット入手マクロのブロックを示す赤いバー)<br><br></p><h3 id="4-3-信頼できる場所に保存する"><a href="#4-3-信頼できる場所に保存する" class="headerlink" title="4-3. 信頼できる場所に保存する"></a>4-3. 信頼できる場所に保存する</h3><p>Excel オプションの [トラスト センター] - [トラスト センターの設定] - [信頼できる場所] にファイル格納フォルダーを追加すると、そのフォルダー内のファイルは信頼されます。この設定により信頼されたファイルは、トラスト センターやポリシーでアクティブ コンテンツを無効化していても、自動的にアクティブ コンテンツが有効になります。<br><img src="/blog/clj709nu4004pqou8fyhg7wta/TrustPlace.png"></p><p><u>信頼できる場所についての公開情報</u><br>Microsoft Office で信頼できる場所を追加、削除、または変更する<br><a href="https://support.microsoft.com/ja-jp/office/7ee1cdc2-483e-4cbb-bcb3-4e7c67147fb4">https://support.microsoft.com/ja-jp/office/7ee1cdc2-483e-4cbb-bcb3-4e7c67147fb4</a><br>Office ファイルの信頼できる場所<br><a href="https://learn.microsoft.com/ja-jp/deployoffice/security/trusted-locations">https://learn.microsoft.com/ja-jp/deployoffice/security/trusted-locations</a><br><br></p><h3 id="4-4-コンテンツを無効にしている設定を緩和する"><a href="#4-4-コンテンツを無効にしている設定を緩和する" class="headerlink" title="4-4. コンテンツを無効にしている設定を緩和する"></a>4-4. コンテンツを無効にしている設定を緩和する</h3><p>アクティブ コンテンツをブロックしているトラスト センターやポリシーの設定を緩和しても問題ない場合は、その設定を削除したり、コンテンツを無効にしない緩やかな設定に変更すると、信頼済みドキュメントとして扱われ、コンテンツは自動的に有効になります。<br>緩和が必要な設定の確認方法は、「<a href="#3-%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E8%A1%A8%E7%A4%BA%E7%90%86%E7%94%B1%E3%81%AE%E7%89%B9%E5%AE%9A%E6%96%B9%E6%B3%95">3. メッセージ表示理由の特定方法</a>」を参照してください。  </p><p>ただし、特定のファイルだけではなく全てのファイルでセキュリティ設定を緩和することになるため、十分に検討の上で緩和してください。</p><br>今回の投稿は以上です。<br><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;span style=&quot;color:#ff0000&quot;&gt;&lt;strong&gt;2023&amp;#x2F;10&amp;#x2F;09 Update&lt;/strong&gt;&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;color:#339966&quot;&gt;有害サイトと分類されていたため移動しました。&lt;/sp</summary>
      
    
    
    
    
    <category term="VBA マクロ" scheme="https://officesupportjp.github.io/blog/tags/VBA-%E3%83%9E%E3%82%AF%E3%83%AD/"/>
    
    <category term="セキュリティ" scheme="https://officesupportjp.github.io/blog/tags/%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3/"/>
    
  </entry>
  
  <entry>
    <title>必要なサービスが無効になっていますと表示される現象について</title>
    <link href="https://officesupportjp.github.io/blog/clmk7jget0001hckj66na16pi/"/>
    <id>https://officesupportjp.github.io/blog/clmk7jget0001hckj66na16pi/</id>
    <published>2023-09-15T00:00:00.000Z</published>
    <updated>2023-09-15T06:20:18.725Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。 </p><p>今回の投稿では、Microsoft 365 Apps、Office LTSC 2021、Office 2019 のご利用時に「必要なサービスが無効になっています」と表示される現象についてご説明いたします。</p><h2 id="現象"><a href="#現象" class="headerlink" title="現象"></a>現象</h2><p>Office をご利用されている際に、以下のようなメッセージが表示されるとお問い合わせいただくことがございます。</p><p><img src="/blog/clmk7jget0001hckj66na16pi/image0.png"></p><br><p>これらの表示は機能によって若干異なる場合がございます。<br>また、オンライン通信を伴う機能がグレーアウトされていたり、表示されていない場合もございます。</p><br><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><p>Microsoft 365 Apps、Office LTSC 2021、Office 2019 (*) では、接続エクスペリエンスという機能が導入されており、オンライン接続の機能を用途ごとに有効・無効と切り替えるすることが出来るようになりました。<br>この機能が無効にされているとオンライン機能が利用できないため、上記のような現象が生じます。</p><p>Title : Microsoft 365 Apps for enterprise のプライバシー コントロールの概要<br>URL : <a href="https://learn.microsoft.com/ja-jp/deployoffice/privacy/overview-privacy-controls">https://learn.microsoft.com/ja-jp/deployoffice/privacy/overview-privacy-controls</a><br>(Office 2019 では Office での追加オプションである接続エクスペリエンスの使用を許可する のみが利用可能です)</p><br><h2 id="対処方法"><a href="#対処方法" class="headerlink" title="対処方法"></a>対処方法</h2><p>以下を上からご確認ください。</p><h2 id="1-プライバシー設定の見直し"><a href="#1-プライバシー設定の見直し" class="headerlink" title="1. プライバシー設定の見直し"></a>1. プライバシー設定の見直し</h2><ol><li>Excel 等を起動し、ファイル - オプション をクリックします</li><li>トラストセンター - トラストセンターの設定 をクリックします</li><li>プライバシーオプション - プライバシー設定 をクリックします</li><li>オプションの接続エクスペリエンスをオンにする にチェックをつけてください</li><li>事象が解消するかご確認ください。</li></ol><br><h2 id="2-接続エクスペリエンス機能の見直し"><a href="#2-接続エクスペリエンス機能の見直し" class="headerlink" title="2.  接続エクスペリエンス機能の見直し"></a>2.  接続エクスペリエンス機能の見直し</h2><p>Office 管理用グループポリシーでご実施されている接続エクスペリエンス機能の無効化を見直します。</p><ul><li><strong>ポリシーの確認</strong></li></ul><p>以下の資料より、今回ご利用されたい機能が以下のどのポリシーで制御されているかをご確認ください。</p><p>Title : Officeでの接続環境<br>URL : <a href="https://learn.microsoft.com/ja-jp/deployoffice/privacy/connected-experiences">https://learn.microsoft.com/ja-jp/deployoffice/privacy/connected-experiences</a></p><p>例えば、PowerPoint デザイナー の場合、[コンテンツを分析する Office の接続エクスペリエンスの使用を許可する] を有効にします。</p><p>3D マップ の場合、[コンテンツを分析する Office の接続エクスペリエンスの使用を許可する] に加えて、[Office の追加オプションである接続エクスペリエンスの使用を許可する]を有効にします。</p><p>アイコンの挿入 の場合、[オンラインのコンテンツをダウンロードする Office の接続エクスペリエンスの使用を許可する] を有効にします。</p><p>共有 や、その他記載がない機能の場合、[Office の接続エクスペリエンスの使用を許可する​] を有効にします。</p><br><ul><li><strong>ポリシーの変更</strong></li></ul><p>Office 管理用グループポリシーで該当するポリシーの制御を変更してください。</p><p>[ユーザーの構成]‐[ポリシー]-[管理用テンプレート]-[Microsoft Office 2016]-[プライバシー]-[セキュリティ センター]</p><p>・コンテンツを分析する Office の接続エクスペリエンスの使用を許可する<br>・オンラインのコンテンツをダウンロードする Office の接続エクスペリエンスの使用を許可する<br>・Office の追加オプションである接続エクスペリエンスの使用を許可する<br>・Office の接続エクスペリエンスの使用を許可する​</p><p>もしくは、以下の資料より対応するレジストリをご確認いただき、設定を変更することで事象が解消するかをご確認ください。</p><p>Title : ポリシー設定を使用して Microsoft 365 Apps for enterprise のプライバシー コントロールを管理する<br>URL : <a href="https://learn.microsoft.com/ja-jp/deployoffice/privacy/manage-privacy-controls">https://learn.microsoft.com/ja-jp/deployoffice/privacy/manage-privacy-controls</a></p><br><h2 id="3-Information-Rights-Management-関連のユーザーインターフェイスをオンにする"><a href="#3-Information-Rights-Management-関連のユーザーインターフェイスをオンにする" class="headerlink" title="3. Information Rights Management 関連のユーザーインターフェイスをオンにする"></a>3. Information Rights Management 関連のユーザーインターフェイスをオンにする</h2><p>今回ご利用される機能が Azure Information Protection 関連かつ、以下の設定が有効となっている場合には、未構成、または、無効に変更することで事象が解消するかご確認ください。</p><p>[ユーザーの構成]‐[ポリシー]-[管理用テンプレート]-[Microsoft Office 2016]-[アクセス制限の管理]</p><p>・Information Rights Management 関連のユーザーインターフェイスをオフにする : 未構成 または 無効</p><br><p>今回の投稿は以上です。</p><p>※ 本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Office サポートの西川 (直) です。 &lt;/p&gt;
&lt;p&gt;今回の投稿では、Microsoft 365 Apps、Office LTSC 2021、Office 2019 のご利用時に「必要なサービスが無効になっています」と表示される現象についてご説明いたしま</summary>
      
    
    
    
    
    <category term="サインイン、認証" scheme="https://officesupportjp.github.io/blog/tags/%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%80%81%E8%AA%8D%E8%A8%BC/"/>
    
  </entry>
  
  <entry>
    <title>Android にてアプリ保護ポリシーを適用していても OneNote アプリの組織データを Microsoft 365 アプリの個人領域へ共有できる動作について</title>
    <link href="https://officesupportjp.github.io/blog/clenw3diw000xf46y72q12jrq/"/>
    <id>https://officesupportjp.github.io/blog/clenw3diw000xf46y72q12jrq/</id>
    <published>2023-02-28T00:00:00.000Z</published>
    <updated>2023-12-26T06:53:45.352Z</updated>
    
    <content type="html"><![CDATA[<p><span style="color:#ff0000"><strong>2023&#x2F;10&#x2F;30 Update</strong></span><br>本現象の対応が行われ、最新バージョンにては発生しない現象であることを記載しました。</p><p>こんにちは。Office サポートチームです。<br>この記事では、Android 端末で利用する OneNote アプリにて、<br>アプリ保護ポリシーを設定していても、組織データを個人データとして、<br>Microsoft 365 アプリに共有することができる動作について記載します。  </p><h1 id="事象の概要"><a href="#事象の概要" class="headerlink" title="事象の概要"></a>事象の概要</h1><p>BYOD で利用されるモバイル端末から企業データへアクセスする場合などを含め、<br>組織データを保護するための仕組みとして、Intune のアプリ保護ポリシーがあります。  </p><p>Android 端末においても例えば、Outlook や OneDrive, OneNote, Microsoft 365 アプリなど、<br>個人アカウントと組織アカウントの両方で利用可能なアプリに対して、<br>Intune のアプリ保護ポリシーにて、<br>[他のアプリに組織データを送信] を [ポリシーマネージドアプリ] と設定することで、<br>組織データを個人アカウントでサインイン済みの他のアプリに共有した際、<br>個人アカウントで扱うことを制限することが可能です。  </p><p>参考<br>Title: アプリ保護ポリシーの概要<br>URL: <a href="https://learn.microsoft.com/ja-jp/mem/intune/apps/app-protection-policy">https://learn.microsoft.com/ja-jp/mem/intune/apps/app-protection-policy</a>  </p><p>ただし、例外的な動作として、Android 端末において、<br>OneNote アプリの組織データを、Microsoft 365 アプリの個人領域へ共有可能であるという動作が確認されております。<br>具体的な手順は以下となります。  </p><ol><li>Microsoft 365 アプリに、個人アカウント、組織アカウントの両方でサインインし、Microsoft 365 アプリで個人アカウントが選択されている状態とする。</li><li>OneNote アプリで組織データとして扱われる OneDrive for Business 上のノートブックなどのページを開き、[…]-[ページの共有]-[プレーンテキスト]-[メモを作成 (Microsfoto 365)] をタップする。</li><li>Microsoft 365 アプリにサインインしている個人アカウントのメモとして保存される。</li></ol><h1 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h1><p><span style="color:#ff0000"><strong>2023&#x2F;10&#x2F;30 Update</strong></span><br>本現象の対応が行われ、最新バージョンにては、<br>OneNote の組織データのノートブックのページは、Microsoft 365 アプリの個人アカウントのメモとして保存されない動作となりました。</p><p><del>本動作について、現在開発部門で調査中となります。</del><br><del>新たな情報が確認された場合は、この記事に追記する形で公開していく予定です。</del>  </p><p>今回の投稿は以上です。<br>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;span style=&quot;color:#ff0000&quot;&gt;&lt;strong&gt;2023&amp;#x2F;10&amp;#x2F;30 Update&lt;/strong&gt;&lt;/span&gt;&lt;br&gt;本現象の対応が行われ、最新バージョンにては発生しない現象であることを記載しました。&lt;/p&gt;
&lt;p&gt;こんにちは</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>信頼済みドキュメントに関するコンテンツ ブロックメッセージの説明 (MC302216)(旧)</title>
    <link href="https://officesupportjp.github.io/blog/clefkdotu0001ukse0slv0l1u/"/>
    <id>https://officesupportjp.github.io/blog/clefkdotu0001ukse0slv0l1u/</id>
    <published>2023-02-24T00:00:00.000Z</published>
    <updated>2023-12-26T06:53:45.353Z</updated>
    
    <content type="html"><![CDATA[<p><span style="color:#ff0000"><strong>2023&#x2F;10&#x2F;09 Update</strong></span><br><span style="color:#339966">有害サイトと分類されていたため移動しました。</span><br><br><br>本ページは <a href="https://officesupportjp.github.io/blog/clj709nu4004pqou8fyhg7wta/">信頼済みドキュメントに関するコンテンツ ブロックメッセージの説明 (MC302216)</a> に移動しました。</p><p><strong>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;span style=&quot;color:#ff0000&quot;&gt;&lt;strong&gt;2023&amp;#x2F;10&amp;#x2F;09 Update&lt;/strong&gt;&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;color:#339966&quot;&gt;有害サイトと分類されていたため移動しました。&lt;/sp</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>VL 版の Office 2016 でオンラインストレージからファイルを開く際に稀にサインイン画面が表示される現象について</title>
    <link href="https://officesupportjp.github.io/blog/cldybofry00010gkj32idbkw7/"/>
    <id>https://officesupportjp.github.io/blog/cldybofry00010gkj32idbkw7/</id>
    <published>2023-02-10T00:00:00.000Z</published>
    <updated>2023-02-10T09:42:33.888Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの西川 (直) です。 </p><p>今回の投稿では、VL (ボリュームライセンス) 版の Office 2016 でオンラインストレージからファイルを開く際に稀にサインイン画面が表示される現象についてご説明いたします。</p><p><a href="https://officesupportjp.github.io/blog/cl0m8t2dj00393gvs3r7oar2m/index.html">VL 版の Office 2016 とは？</a></p><br><h2 id="現象"><a href="#現象" class="headerlink" title="現象"></a>現象</h2><p>VL 版の Office 2016 において、Teams やブラウザを介して SharePoint 等のオンラインストレージよりファイルを開く際、稀に以下のようなサインイン画面が表示されます。</p><p>・例</p><p><img src="/blog/cldybofry00010gkj32idbkw7/image1.png"></p><br><h2 id="対処方法"><a href="#対処方法" class="headerlink" title="対処方法"></a>対処方法</h2><p>本事象は Office 2016 で生じる可能性がございます。</p><p>本ダイアログが表示された場合、Office を再起動して事象が解消するかをご確認いただくとともに、改善されない場合には再度サインインをしていただきますようお願いいたします。<br>また、Microsoft 365 Apps ではオンラインストレージとのやり取りの機能が向上しておりますので、Microsoft 365 Apps をご利用いただき事象が改善するかをご確認いただけますと幸いです。</p><br><h2 id="留意点"><a href="#留意点" class="headerlink" title="留意点"></a>留意点</h2><p>本事象は以下のような場合には該当いたしません。</p><ul><li>Office を再起動してもファイルが開けない</li><li>Office のファイルの保存に失敗する</li><li>Office のサインインが出来ない</li></ul><p>このような場合には、以下の情報をご参考にいただけますと幸いです。</p><p><a href="https://officesupportjp.github.io/blog/cl0m69xu000124cvsclmc5vis/">MSI 版の Office 2016 で SPO、OneDrive、WebDavサーバーから Office ファイルが開かない、保存できない現象について</a></p><p><a href="https://officesupportjp.github.io/blog/cl0m82yjj002mvovs9cil5fgy/index.html">SharePoint Server など WebDAV が有効なサーバーから Office ファイルが開かない、保存できない現象について</a></p><p><a href="https://officesupportjp.github.io/blog/cl0m6umvg001gi4vsgppfcmk0/">Office のサインインのトラブルシュートについて</a></p><br><p>今回の投稿は以上です。</p><p>※ 本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Office サポートの西川 (直) です。 &lt;/p&gt;
&lt;p&gt;今回の投稿では、VL (ボリュームライセンス) 版の Office 2016 でオンラインストレージからファイルを開く際に稀にサインイン画面が表示される現象についてご説明いたします。&lt;/p&gt;
&lt;p&gt;&lt;</summary>
      
    
    
    
    
    <category term="サインイン、認証" scheme="https://officesupportjp.github.io/blog/tags/%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%80%81%E8%AA%8D%E8%A8%BC/"/>
    
  </entry>
  
  <entry>
    <title>Excel 2016 で 3D マップを利用するとエラーが発生する (状態コード 4)</title>
    <link href="https://officesupportjp.github.io/blog/cldu0kdx900004k6yd6dvgatz/"/>
    <id>https://officesupportjp.github.io/blog/cldu0kdx900004k6yd6dvgatz/</id>
    <published>2023-02-06T15:00:00.000Z</published>
    <updated>2023-02-22T09:35:46.769Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポートの佐村です。<br>今回の投稿では、Excel 2016 において、[挿入] タブの 3D マップを利用時にエラーとなる現象についてご案内いたします。  </p><h1 id="現象"><a href="#現象" class="headerlink" title="現象"></a>現象</h1><p>Excel 2016 の 3D マップ機能を利用しようとすると以下のエラーが発生します。  </p><p>3D Maps<br>3D Maps が Microsoft Bing 地図サービスに接続しているときにエラーが発生しました。　　<br>機能が制限される場合があります (状態コード: 4)。　</p><p><img src="/blog/cldu0kdx900004k6yd6dvgatz/img1.png"></p><p>その後、DirectX の初期化に関するエラーが表示され、3D マップ機能が起動しません。<br>※過去の利用履歴により上記エラー後に 3D マップ機能が起動することもあります。  </p><p><img src="/blog/cldu0kdx900004k6yd6dvgatz/img2.png"></p><h1 id="対処方法"><a href="#対処方法" class="headerlink" title="対処方法"></a>対処方法</h1><p>3D マップで利用する .Net framework で TLS 1.2 を利用して接続できるように<br>以下のレジストリを構成 (新規作成) します。<br>レジストリの設定には端末の管理者権限が必要となります。 </p><p>&lt;OS と Office が同じ bit&gt;<br>キー : HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\v4.0.30319<br>名前 : SchUseStrongCrypto<br>種類 : REG_DWORD<br>値 : 1  </p><p>&lt;64bit OS 上に 32bit の Office&gt;<br>キー : HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\.NETFramework\v4.0.30319<br>名前 : SchUseStrongCrypto<br>種類 : REG_DWORD<br>値 : 1  </p><h3 id="ご参考"><a href="#ご参考" class="headerlink" title="ご参考"></a>ご参考</h3><p>クライアントの SSL&#x2F;TLS プロトコルと暗号スイートのAD FSを管理する<br><a href="https://learn.microsoft.com/ja-jp/windows-server/identity/ad-fs/operations/manage-ssl-protocols-in-ad-fs#enabling-strong-authentication-for-net-applications">https://learn.microsoft.com/ja-jp/windows-server/identity/ad-fs/operations/manage-ssl-protocols-in-ad-fs#enabling-strong-authentication-for-net-applications</a>  </p><h1 id="エラーの原因"><a href="#エラーの原因" class="headerlink" title="エラーの原因"></a>エラーの原因</h1><p>「状態コード: 4」のエラーは、TLS での接続に失敗していることが原因として考えられます。<br>2022年の下旬 (10月頃) に、コンテンツ配信サービス (3D マップ) 側でセキュリティ要件を変更したことにより、TLS 1.2 の接続が必要となりました。<br>これまでは TLS 1.0&#x2F;1.1 での接続も動作していましたが、TLS 1.2 での接続を必要とし、TLS 1.0&#x2F; 1.1 での接続をエラーとするよう変更がありました。 </p><p>Office 2019 や Microsoft 365 Apps では更新プログラムにより TLS 1.2 に<br>対応するように修正されましたが、Office 2016 は延長サポートフェーズであるため<br>更新による修正がリリースされていません。<br>そのため、レジストリを設定して TLS の接続方法を変更する必要があります。  </p><h1 id="レジストリの構成による影響について"><a href="#レジストリの構成による影響について" class="headerlink" title="レジストリの構成による影響について"></a>レジストリの構成による影響について</h1><p>レジストリ SchUseStrongCrypto&#x3D;1 とすると、.NET Framework 4.5.2 のバージョンで既定で利用されるプロトコルが TLS 1.2 &#x2F; 1.1 &#x2F; 1.0 となります。<br>※高いバージョンから優先的に使用されるため、基本的には TLS 1.2 を利用します。  </p><p>このレジストリが未指定または 0 となっている場合は、.NET Framework 4.5.2 では既定で利用されるプロトコルは SSL 3.0 &#x2F; TLS 1.0 となります。<br>また、.NET Framework のプログラム上で明示的にプロトコルバージョンを指定している場合上記のレジストリの値や有無に関わらず、プログラムで指定したバージョンのプロトコルを利用します。  </p><p>以上のことから、影響としてはプログラム上で明示的にプロトコルバージョンを指定して「いない」、かつ.NET Framework 4.5.2 をターゲットにビルドされているアプリを利用する場合に通信のプロトコルが変更されます。  </p><p>上記条件で通信先のサービスで TLS 1.2 をサポートしていない場合 (レガシサービスの場合) はエラーとなる可能性はございますが、セキュリティ観点から TLS 1.2 への対応を進めていただくことを推奨しております。  </p><h3 id="ご参考-1"><a href="#ご参考-1" class="headerlink" title="ご参考"></a>ご参考</h3><p>.NET Framework で TLS 1.1 および TLS 1.2 を有効化する方法 - まとめ –<br>※#6 をご参照ください。<br><a href="https://jpdsi.github.io/blog/internet-explorer-microsoft-edge/dotnet-framework-tls12">https://jpdsi.github.io/blog/internet-explorer-microsoft-edge/dotnet-framework-tls12</a> </p><p>今回の投稿は以上です。<br>※ 本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。 </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Office サポートの佐村です。&lt;br&gt;今回の投稿では、Excel 2016 において、[挿入] タブの 3D マップを利用時にエラーとなる現象についてご案内いたします。  &lt;/p&gt;
&lt;h1 id=&quot;現象&quot;&gt;&lt;a href=&quot;#現象&quot; class=&quot;heade</summary>
      
    
    
    
    
    <category term="Excel" scheme="https://officesupportjp.github.io/blog/tags/Excel/"/>
    
  </entry>
  
  <entry>
    <title>「必要なサービスが無効になっています」と表示される現象について(旧)</title>
    <link href="https://officesupportjp.github.io/blog/cld8jp0gd00422skj5eabeqvb/"/>
    <id>https://officesupportjp.github.io/blog/cld8jp0gd00422skj5eabeqvb/</id>
    <published>2023-01-23T00:00:00.000Z</published>
    <updated>2023-09-15T06:20:33.641Z</updated>
    
    <content type="html"><![CDATA[<p>本ページは <a href="https://officesupportjp.github.io/blog/clmk7jget0001hckj66na16pi/">「必要なサービスが無効になっています」と表示される現象について</a> に移動しました。</p><p><span style="color:#ff0000"><strong>2023&#x2F;9&#x2F;15  Update</strong></span><br><span style="color:#339966">有害サイトと分類されていたため移動しました</span></p><p>※ 本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;本ページは &lt;a href=&quot;https://officesupportjp.github.io/blog/clmk7jget0001hckj66na16pi/&quot;&gt;「必要なサービスが無効になっています」と表示される現象について&lt;/a&gt; に移動しました。&lt;/p&gt;
&lt;p&gt;&lt;sp</summary>
      
    
    
    
    
    <category term="サインイン、認証" scheme="https://officesupportjp.github.io/blog/tags/%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%80%81%E8%AA%8D%E8%A8%BC/"/>
    
  </entry>
  
  <entry>
    <title>Word 文書内の図の位置がずれて印刷される現象について</title>
    <link href="https://officesupportjp.github.io/blog/clc72h24j0001v0jo35060br5/"/>
    <id>https://officesupportjp.github.io/blog/clc72h24j0001v0jo35060br5/</id>
    <published>2022-12-28T00:00:00.000Z</published>
    <updated>2023-01-11T07:22:29.308Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Office サポート チームです。<br>この記事では、図を含んだ Word 文書を印刷した際に、図の位置が編集中の表示箇所とは異なる位置で印刷される現象について説明します。</p><h2 id="現象"><a href="#現象" class="headerlink" title="現象"></a>現象</h2><p>図や図形等のオブジェクトが挿入されている Word 文書を印刷した際、編集中や印刷プレビューで確認できる図やオブジェクトの配置場所とは異なる場所に図やオブジェクトが印刷されてしまう場合があります。<br>Word 文書の構成内容に依存して発生する場合があり、また、毎回必ず位置がずれるわけではなく、正常な位置で印刷される場合もあります。</p><p>Microsoft 365 Apps の Word の他、Word 2019 や Word 2021、過去のバージョンの Word でも発生する場合があります。</p><h2 id="回避方法"><a href="#回避方法" class="headerlink" title="回避方法"></a>回避方法</h2><p>上記の現象について、Word のバックグラウンド印刷の設定を変更することで回避できる場合があります。<br>手順を以下に説明します。</p><ol><li>Word を起動します。</li><li>[ファイル] メニューより [オプション] を選択します。</li><li>「Word のオプション」 ダイアログで [詳細設定] を選択します。</li><li>[印刷] の項目内にある [バックグラウンドで印刷する] のチェックをオフにします。</li><li>[OK] を押して 「Word のオプション」 ダイアログを閉じます。</li><li>Word を終了します。</li></ol><p>この設定を行った後で Word 文書を開きなおし、印刷を行います。</p><h2 id="Word-のバックグラウンド印刷について"><a href="#Word-のバックグラウンド印刷について" class="headerlink" title="Word のバックグラウンド印刷について"></a>Word のバックグラウンド印刷について</h2><p>[バックグラウンドで印刷する] の設定は、既定ではチェックがオンになっています。<br>チェックのオン、オフそれぞれの場合の動作は以下となります。</p><p>チェックがオンの場合 :<br>印刷を実行中に Word の操作が可能となります。<br>Word のウィンドウの下部に表示されるステータス バーに印刷状況が表示されます。</p><p>チェックがオフの場合 :<br>印刷処理が完了するまで Word の操作を行えません。<br>印刷中には印刷中であることを示すメッセージが表示されます。</p><p>今回の投稿は以上です。<br>本情報の内容 (添付文書、リンク先などを含む) は、作成日時点でのものであり、予告なく変更される場合があります。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Office サポート チームです。&lt;br&gt;この記事では、図を含んだ Word 文書を印刷した際に、図の位置が編集中の表示箇所とは異なる位置で印刷される現象について説明します。&lt;/p&gt;
&lt;h2 id=&quot;現象&quot;&gt;&lt;a href=&quot;#現象&quot; class=&quot;heade</summary>
      
    
    
    
    
    <category term="印刷" scheme="https://officesupportjp.github.io/blog/tags/%E5%8D%B0%E5%88%B7/"/>
    
  </entry>
  
</feed>
